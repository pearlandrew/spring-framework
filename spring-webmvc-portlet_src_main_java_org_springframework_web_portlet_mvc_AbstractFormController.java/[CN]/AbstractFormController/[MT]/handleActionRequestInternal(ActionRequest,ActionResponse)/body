{
  if (isFormSubmission(request)) {
    try {
      Object command=getCommand(request);
      if (logger.isDebugEnabled()) {
        logger.debug("Processing valid submit (redirectAction = " + isRedirectAction() + ")");
      }
      if (!isRedirectAction()) {
        setFormSubmit(response);
      }
      PortletRequestDataBinder binder=bindAndValidate(request,command);
      BindException errors=new BindException(binder.getBindingResult());
      processFormSubmission(request,response,command,errors);
      setRenderCommandAndErrors(request,command,errors);
      return;
    }
 catch (    PortletSessionRequiredException ex) {
      if (logger.isDebugEnabled()) {
        logger.debug("Invalid submit detected: " + ex.getMessage());
      }
      setFormSubmit(response);
      setInvalidSubmit(response);
      handleInvalidSubmit(request,response);
      return;
    }
  }
 else {
    logger.debug("Not a form submit - passing parameters to render phase");
    passRenderParameters(request,response);
    return;
  }
}
