{
  if (relatedType == null && type.isArray()) {
    relatedType=Array.newInstance(relatedType,0).getClass();
  }
  if (!type.getType().equals(relatedType)) {
    return type.upcast(relatedType);
  }
  return null;
}
