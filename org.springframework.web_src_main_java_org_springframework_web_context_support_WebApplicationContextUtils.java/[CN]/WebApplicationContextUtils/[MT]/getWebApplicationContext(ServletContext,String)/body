{
  Assert.notNull(sc,"ServletContext must not be null");
  Object attr=sc.getAttribute(attrName);
  if (attr == null) {
    return null;
  }
  if (attr instanceof RuntimeException) {
    throw (RuntimeException)attr;
  }
  if (attr instanceof Error) {
    throw (Error)attr;
  }
  if (attr instanceof Exception) {
    IllegalStateException ex=new IllegalStateException();
    ex.initCause((Exception)attr);
    throw ex;
  }
  if (!(attr instanceof WebApplicationContext)) {
    throw new IllegalStateException("Context attribute is not of type WebApplicationContext: " + attr);
  }
  return (WebApplicationContext)attr;
}
