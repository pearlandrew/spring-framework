{
  @SuppressWarnings("serial") DispatcherServlet servlet=new DispatcherServlet(){
    @Override protected WebApplicationContext createWebApplicationContext(    WebApplicationContext parent){
      GenericWebApplicationContext wac=new GenericWebApplicationContext();
      wac.registerBeanDefinition("controller",new RootBeanDefinition(RequestBodyArgMismatchController.class));
      Jaxb2Marshaller marshaller=new Jaxb2Marshaller();
      marshaller.setClassesToBeBound(A.class,B.class);
      try {
        marshaller.afterPropertiesSet();
      }
 catch (      Exception ex) {
        throw new BeanCreationException(ex.getMessage(),ex);
      }
      MarshallingHttpMessageConverter messageConverter=new MarshallingHttpMessageConverter(marshaller);
      RootBeanDefinition adapterDef=new RootBeanDefinition(AnnotationMethodHandlerAdapter.class);
      adapterDef.getPropertyValues().add("messageConverters",messageConverter);
      wac.registerBeanDefinition("handlerAdapter",adapterDef);
      wac.refresh();
      return wac;
    }
  }
;
  servlet.init(new MockServletConfig());
  MockHttpServletRequest request=new MockHttpServletRequest("PUT","/something");
  String requestBody="<b/>";
  request.setContent(requestBody.getBytes("UTF-8"));
  request.addHeader("Content-Type","application/xml; charset=utf-8");
  MockHttpServletResponse response=new MockHttpServletResponse();
  servlet.service(request,response);
  assertEquals(400,response.getStatus());
}
