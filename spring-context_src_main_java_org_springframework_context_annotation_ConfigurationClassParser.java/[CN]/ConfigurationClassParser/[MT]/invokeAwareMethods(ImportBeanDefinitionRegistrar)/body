{
  if (registrar instanceof Aware) {
    if (registrar instanceof ResourceLoaderAware) {
      ((ResourceLoaderAware)registrar).setResourceLoader(resourceLoader);
    }
    if (registrar instanceof BeanClassLoaderAware) {
      ClassLoader classLoader=registry instanceof ConfigurableBeanFactory ? ((ConfigurableBeanFactory)registry).getBeanClassLoader() : resourceLoader.getClassLoader();
      ((BeanClassLoaderAware)registrar).setBeanClassLoader(classLoader);
    }
    if (registrar instanceof BeanFactoryAware && registry instanceof BeanFactory) {
      ((BeanFactoryAware)registrar).setBeanFactory((BeanFactory)registry);
    }
  }
}
