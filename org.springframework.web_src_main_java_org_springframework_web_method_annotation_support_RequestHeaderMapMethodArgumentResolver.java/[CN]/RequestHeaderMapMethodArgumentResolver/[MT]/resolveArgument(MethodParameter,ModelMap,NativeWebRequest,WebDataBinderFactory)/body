{
  Class<?> paramType=parameter.getParameterType();
  if (MultiValueMap.class.isAssignableFrom(paramType)) {
    MultiValueMap<String,String> result;
    if (HttpHeaders.class.isAssignableFrom(paramType)) {
      result=new HttpHeaders();
    }
 else {
      result=new LinkedMultiValueMap<String,String>();
    }
    for (Iterator<String> iterator=webRequest.getHeaderNames(); iterator.hasNext(); ) {
      String headerName=iterator.next();
      for (      String headerValue : webRequest.getHeaderValues(headerName)) {
        result.add(headerName,headerValue);
      }
    }
    return result;
  }
 else {
    Map<String,String> result=new LinkedHashMap<String,String>();
    for (Iterator<String> iterator=webRequest.getHeaderNames(); iterator.hasNext(); ) {
      String headerName=iterator.next();
      String headerValue=webRequest.getHeader(headerName);
      result.put(headerName,headerValue);
    }
    return result;
  }
}
