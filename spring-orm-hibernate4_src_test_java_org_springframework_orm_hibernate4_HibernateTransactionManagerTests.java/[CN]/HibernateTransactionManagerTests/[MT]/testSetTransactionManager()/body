{
  DataSource ds=mock(DataSource.class);
  TransactionManager tm=mock(TransactionManager.class);
  LocalSessionFactoryBuilder lsfb=new LocalSessionFactoryBuilder(ds);
  lsfb.setJtaTransactionManager(tm);
  Object jtaPlatform=lsfb.getProperties().get(AvailableSettings.JTA_PLATFORM);
  assertNotNull(jtaPlatform);
  assertSame(tm,jtaPlatform.getClass().getMethod("retrieveTransactionManager").invoke(jtaPlatform));
  assertTrue(lsfb.getProperties().get(AvailableSettings.TRANSACTION_STRATEGY) instanceof CMTTransactionFactory);
}
