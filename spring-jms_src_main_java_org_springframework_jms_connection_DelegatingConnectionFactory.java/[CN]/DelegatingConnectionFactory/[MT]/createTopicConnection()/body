{
  ConnectionFactory cf=getTargetConnectionFactory();
  if (cf instanceof TopicConnectionFactory) {
    return ((TopicConnectionFactory)cf).createTopicConnection();
  }
 else {
    Connection con=cf.createConnection();
    if (!(con instanceof TopicConnection)) {
      throw new javax.jms.IllegalStateException("'targetConnectionFactory' is not a TopicConnectionFactory");
    }
    return (TopicConnection)con;
  }
}
