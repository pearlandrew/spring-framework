{
  if (!this.mergeEnabled) {
    throw new IllegalStateException("Not allowed to merge when the 'mergeEnabled' property is set to 'false'");
  }
  if (parent == null) {
    return this;
  }
  if (!(parent instanceof Map)) {
    throw new IllegalArgumentException("Cannot merge with object of type [" + parent.getClass() + "]");
  }
  Map merged=new ManagedMap();
  merged.putAll((Map)parent);
  merged.putAll(this);
  return merged;
}
