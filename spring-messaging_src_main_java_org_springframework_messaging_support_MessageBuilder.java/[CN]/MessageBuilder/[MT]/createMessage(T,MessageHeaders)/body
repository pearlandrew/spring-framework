{
  Assert.notNull(payload,"Payload must not be null");
  Assert.notNull(messageHeaders,"MessageHeaders must not be null");
  if (payload instanceof Throwable) {
    return (Message<T>)new ErrorMessage((Throwable)payload,messageHeaders);
  }
 else {
    return new GenericMessage<T>(payload,messageHeaders);
  }
}
