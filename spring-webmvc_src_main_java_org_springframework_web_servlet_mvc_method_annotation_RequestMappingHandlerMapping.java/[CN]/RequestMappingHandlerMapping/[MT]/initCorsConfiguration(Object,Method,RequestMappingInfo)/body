{
  HandlerMethod handlerMethod=createHandlerMethod(handler,method);
  CrossOrigin typeAnnotation=AnnotationUtils.findAnnotation(handlerMethod.getBeanType(),CrossOrigin.class);
  CrossOrigin methodAnnotation=AnnotationUtils.findAnnotation(method,CrossOrigin.class);
  if (typeAnnotation == null && methodAnnotation == null) {
    return null;
  }
  CorsConfiguration config=new CorsConfiguration();
  updateCorsConfig(config,typeAnnotation);
  updateCorsConfig(config,methodAnnotation);
  if (CollectionUtils.isEmpty(config.getAllowedMethods())) {
    for (    RequestMethod allowedMethod : mappingInfo.getMethodsCondition().getMethods()) {
      config.addAllowedMethod(allowedMethod.name());
    }
  }
  if (CollectionUtils.isEmpty(config.getAllowedHeaders())) {
    for (    NameValueExpression<String> headerExpression : mappingInfo.getHeadersCondition().getExpressions()) {
      if (!headerExpression.isNegated()) {
        config.addAllowedHeader(headerExpression.getName());
      }
    }
  }
  return config;
}
