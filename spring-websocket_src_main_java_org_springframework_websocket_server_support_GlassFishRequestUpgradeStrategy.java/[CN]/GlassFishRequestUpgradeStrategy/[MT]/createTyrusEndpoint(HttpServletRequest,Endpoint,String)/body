{
  String requestUri=request.getRequestURI();
  String randomValue=String.valueOf(random.nextLong());
  String endpointPath=requestUri.endsWith("/") ? requestUri + randomValue : requestUri + "/" + randomValue;
  EndpointRegistration endpointConfig=new EndpointRegistration(endpointPath,endpoint);
  endpointConfig.setSubprotocols(Arrays.asList(selectedProtocol));
  return new TyrusEndpoint(new EndpointWrapper(endpoint,endpointConfig,ComponentProviderService.create(),null,"/",new ErrorCollector(),endpointConfig.getConfigurator()));
}
