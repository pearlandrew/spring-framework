{
  if (this.beanFactory instanceof ListableBeanFactory) {
    ListableBeanFactory lbf=(ListableBeanFactory)this.beanFactory;
    String[] beanNames=lbf.getBeanNamesForType(Scheduler.class);
    for (int i=0; i < beanNames.length; i++) {
      Scheduler schedulerBean=(Scheduler)lbf.getBean(beanNames[i]);
      if (schedulerName.equals(schedulerBean.getSchedulerName())) {
        return schedulerBean;
      }
    }
  }
  Scheduler schedulerInRepo=SchedulerRepository.getInstance().lookup(schedulerName);
  if (schedulerInRepo == null) {
    throw new IllegalStateException("No Scheduler named '" + schedulerName + "' found");
  }
  return schedulerInRepo;
}
