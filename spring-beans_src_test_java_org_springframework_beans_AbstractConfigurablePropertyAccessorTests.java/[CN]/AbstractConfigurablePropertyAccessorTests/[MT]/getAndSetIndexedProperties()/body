{
  IndexedTestBean target=new IndexedTestBean();
  AbstractPropertyAccessor accessor=createAccessor(target);
  TestBean tb0=target.getArray()[0];
  TestBean tb1=target.getArray()[1];
  TestBean tb2=((TestBean)target.getList().get(0));
  TestBean tb3=((TestBean)target.getList().get(1));
  TestBean tb6=((TestBean)target.getSet().toArray()[0]);
  TestBean tb7=((TestBean)target.getSet().toArray()[1]);
  TestBean tb4=((TestBean)target.getMap().get("key1"));
  TestBean tb5=((TestBean)target.getMap().get("key.3"));
  assertEquals("name0",tb0.getName());
  assertEquals("name1",tb1.getName());
  assertEquals("name2",tb2.getName());
  assertEquals("name3",tb3.getName());
  assertEquals("name6",tb6.getName());
  assertEquals("name7",tb7.getName());
  assertEquals("name4",tb4.getName());
  assertEquals("name5",tb5.getName());
  assertEquals("name0",accessor.getPropertyValue("array[0].name"));
  assertEquals("name1",accessor.getPropertyValue("array[1].name"));
  assertEquals("name2",accessor.getPropertyValue("list[0].name"));
  assertEquals("name3",accessor.getPropertyValue("list[1].name"));
  assertEquals("name6",accessor.getPropertyValue("set[0].name"));
  assertEquals("name7",accessor.getPropertyValue("set[1].name"));
  assertEquals("name4",accessor.getPropertyValue("map[key1].name"));
  assertEquals("name5",accessor.getPropertyValue("map[key.3].name"));
  assertEquals("name4",accessor.getPropertyValue("map['key1'].name"));
  assertEquals("name5",accessor.getPropertyValue("map[\"key.3\"].name"));
  assertEquals("nameX",accessor.getPropertyValue("map[key4][0].name"));
  assertEquals("nameY",accessor.getPropertyValue("map[key4][1].name"));
  MutablePropertyValues pvs=new MutablePropertyValues();
  pvs.add("array[0].name","name5");
  pvs.add("array[1].name","name4");
  pvs.add("list[0].name","name3");
  pvs.add("list[1].name","name2");
  pvs.add("set[0].name","name8");
  pvs.add("set[1].name","name9");
  pvs.add("map[key1].name","name1");
  pvs.add("map['key.3'].name","name0");
  pvs.add("map[key4][0].name","nameA");
  pvs.add("map[key4][1].name","nameB");
  accessor.setPropertyValues(pvs);
  assertEquals("name5",tb0.getName());
  assertEquals("name4",tb1.getName());
  assertEquals("name3",tb2.getName());
  assertEquals("name2",tb3.getName());
  assertEquals("name1",tb4.getName());
  assertEquals("name0",tb5.getName());
  assertEquals("name5",accessor.getPropertyValue("array[0].name"));
  assertEquals("name4",accessor.getPropertyValue("array[1].name"));
  assertEquals("name3",accessor.getPropertyValue("list[0].name"));
  assertEquals("name2",accessor.getPropertyValue("list[1].name"));
  assertEquals("name8",accessor.getPropertyValue("set[0].name"));
  assertEquals("name9",accessor.getPropertyValue("set[1].name"));
  assertEquals("name1",accessor.getPropertyValue("map[\"key1\"].name"));
  assertEquals("name0",accessor.getPropertyValue("map['key.3'].name"));
  assertEquals("nameA",accessor.getPropertyValue("map[key4][0].name"));
  assertEquals("nameB",accessor.getPropertyValue("map[key4][1].name"));
}
