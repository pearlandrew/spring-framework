{
  for (  View candidateView : candidateViews) {
    if (candidateView instanceof SmartView) {
      SmartView smartView=(SmartView)candidateView;
      if (smartView.isRedirectView()) {
        if (logger.isDebugEnabled()) {
          logger.debug("Returning redirect view [" + candidateView + "]");
        }
        return candidateView;
      }
    }
  }
  for (  MediaType mediaType : requestedMediaTypes) {
    for (    View candidateView : candidateViews) {
      if (StringUtils.hasText(candidateView.getContentType())) {
        MediaType candidateContentType=MediaType.parseMediaType(candidateView.getContentType());
        if (mediaType.includes(candidateContentType)) {
          if (logger.isDebugEnabled()) {
            logger.debug("Returning [" + candidateView + "] based on requested media type '"+ mediaType+ "'");
          }
          return candidateView;
        }
      }
    }
  }
  return null;
}
