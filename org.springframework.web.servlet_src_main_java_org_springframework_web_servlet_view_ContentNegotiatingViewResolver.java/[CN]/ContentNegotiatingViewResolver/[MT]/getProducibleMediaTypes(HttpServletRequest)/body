{
  Set<MediaType> mediaTypes=(Set<MediaType>)request.getAttribute(HandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE);
  if (!CollectionUtils.isEmpty(mediaTypes)) {
    return new ArrayList<MediaType>(mediaTypes);
  }
 else {
    return Collections.singletonList(MediaType.ALL);
  }
}
