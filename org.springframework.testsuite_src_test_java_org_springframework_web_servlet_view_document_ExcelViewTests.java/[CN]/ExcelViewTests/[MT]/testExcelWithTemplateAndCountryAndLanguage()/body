{
  request.setAttribute(DispatcherServlet.LOCALE_RESOLVER_ATTRIBUTE,newDummyLocaleResolver("en","US"));
  AbstractExcelView excelView=new AbstractExcelView(){
    protected void buildExcelDocument(    Map model,    HSSFWorkbook wb,    HttpServletRequest request,    HttpServletResponse response) throws Exception {
      HSSFSheet sheet=wb.getSheet("Sheet1");
      HSSFCell cell=getCell(sheet,2,4);
      cell.setCellValue("Test Value");
      cell=getCell(sheet,2,3);
      setText(cell,"Test Value");
      cell=getCell(sheet,3,4);
      setText(cell,"Test Value");
      cell=getCell(sheet,2,4);
      setText(cell,"Test Value");
    }
  }
;
  excelView.setApplicationContext(webAppCtx);
  excelView.setUrl("template");
  excelView.render(new HashMap(),request,response);
  POIFSFileSystem poiFs=new POIFSFileSystem(new ByteArrayInputStream(response.getContentAsByteArray()));
  HSSFWorkbook wb=new HSSFWorkbook(poiFs);
  HSSFSheet sheet=wb.getSheet("Sheet1");
  HSSFRow row=sheet.getRow(0);
  HSSFCell cell=row.getCell((short)0);
  assertEquals("Test Template American English",cell.getStringCellValue());
}
