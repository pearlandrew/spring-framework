{
  if (metadata == null || !metadata.isAnnotated(CONDITIONAL_ANNOTATION)) {
    return NONE;
  }
  if (deferIfConfigurationCandidate && metadata instanceof AnnotationMetadata && ConfigurationClassUtils.isConfigurationCandidate((AnnotationMetadata)metadata)) {
    return NONE;
  }
  return new ConditionEvaluatorImpl(metadata);
}
