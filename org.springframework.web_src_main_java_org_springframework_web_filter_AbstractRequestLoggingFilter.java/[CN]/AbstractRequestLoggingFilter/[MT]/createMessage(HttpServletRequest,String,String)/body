{
  StringBuffer buffer=new StringBuffer();
  buffer.append(prefix);
  buffer.append("uri=").append(request.getRequestURI());
  if (isIncludeQueryString()) {
    buffer.append('?').append(request.getQueryString());
  }
  if (isIncludeClientInfo()) {
    String client=request.getRemoteAddr();
    if (StringUtils.hasLength(client)) {
      buffer.append(";client=").append(client);
    }
    HttpSession session=request.getSession(false);
    if (session != null) {
      buffer.append(";session=").append(session.getId());
    }
    String user=request.getRemoteUser();
    if (user != null) {
      buffer.append(";user=").append(user);
    }
  }
  buffer.append(suffix);
  return buffer.toString();
}
