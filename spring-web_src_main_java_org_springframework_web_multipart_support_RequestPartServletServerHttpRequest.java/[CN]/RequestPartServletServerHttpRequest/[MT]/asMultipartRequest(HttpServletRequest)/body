{
  MultipartHttpServletRequest unwrapped=WebUtils.getNativeRequest(request,MultipartHttpServletRequest.class);
  if (unwrapped != null) {
    return unwrapped;
  }
 else   if (ClassUtils.hasMethod(HttpServletRequest.class,"getParts")) {
    return new StandardMultipartHttpServletRequest(request);
  }
  throw new IllegalArgumentException("Expected MultipartHttpServletRequest: is a MultipartResolver configured?");
}
