{
  String[] fields=StringUtils.commaDelimitedListToStringArray(formatted);
  if (collectionType.getType().isArray()) {
    Object array=Array.newInstance(getElementType(),fields.length);
    for (int i=0; i < fields.length; i++) {
      Array.set(array,i,elementFormatter.parse(fields[i],locale));
    }
    return array;
  }
 else {
    Collection collection=newCollection();
    for (int i=0; i < fields.length; i++) {
      collection.add(elementFormatter.parse(fields[i],locale));
    }
    return collection;
  }
}
