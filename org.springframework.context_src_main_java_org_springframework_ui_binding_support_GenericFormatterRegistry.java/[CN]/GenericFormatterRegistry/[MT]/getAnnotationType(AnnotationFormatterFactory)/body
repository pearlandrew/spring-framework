{
  Class classToIntrospect=factory.getClass();
  while (classToIntrospect != null) {
    Type[] genericInterfaces=classToIntrospect.getGenericInterfaces();
    for (    Type genericInterface : genericInterfaces) {
      if (genericInterface instanceof ParameterizedType) {
        ParameterizedType pInterface=(ParameterizedType)genericInterface;
        if (AnnotationFormatterFactory.class.isAssignableFrom((Class)pInterface.getRawType())) {
          return getParameterClass(pInterface.getActualTypeArguments()[0],factory.getClass());
        }
      }
    }
    classToIntrospect=classToIntrospect.getSuperclass();
  }
  throw new IllegalArgumentException("Unable to extract Annotation type A argument from AnnotationFormatterFactory [" + factory.getClass().getName() + "]; does the factory parameterize the <A> generic type?");
}
