{
  super.initApplicationContext();
  if (!(getApplicationContext() instanceof ConfigurableApplicationContext)) {
    throw new IllegalStateException("[" + getClass().getName() + "] needs to run in a ConfigurableApplicationContext");
  }
  ConfigurableListableBeanFactory beanFactory=((ConfigurableApplicationContext)getApplicationContext()).getBeanFactory();
  detectAndCreateHandlers(beanFactory);
}
