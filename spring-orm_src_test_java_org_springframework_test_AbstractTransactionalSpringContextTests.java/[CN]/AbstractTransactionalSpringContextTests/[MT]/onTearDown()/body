{
  if (this.transactionStatus != null && !this.transactionStatus.isCompleted()) {
    try {
      onTearDownInTransaction();
    }
  finally {
      endTransaction();
    }
  }
  if (this.transactionsStarted > 0) {
    onTearDownAfterTransaction();
  }
}
