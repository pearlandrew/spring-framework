{
  ParserContext parserContext=context.getParserContext();
  PropertyValues containerValues=context.getContainerValues();
  Element listenerEle=context.getListenerElement();
  RootBeanDefinition listenerDef=new RootBeanDefinition();
  listenerDef.setSource(parserContext.extractSource(listenerEle));
  BeanDefinition containerDef=createContainer(context);
  String ref=listenerEle.getAttribute(REF_ATTRIBUTE);
  if (!StringUtils.hasText(ref)) {
    parserContext.getReaderContext().error("Listener 'ref' attribute contains empty value.",listenerEle);
  }
 else {
    listenerDef.getPropertyValues().add("delegate",new RuntimeBeanReference(ref));
  }
  String method=null;
  if (listenerEle.hasAttribute(METHOD_ATTRIBUTE)) {
    method=listenerEle.getAttribute(METHOD_ATTRIBUTE);
    if (!StringUtils.hasText(method)) {
      parserContext.getReaderContext().error("Listener 'method' attribute contains empty value.",listenerEle);
    }
  }
  listenerDef.getPropertyValues().add("defaultListenerMethod",method);
  PropertyValue messageConverterPv=getMessageConverter(containerValues);
  if (messageConverterPv != null) {
    listenerDef.getPropertyValues().addPropertyValue(messageConverterPv);
  }
  if (listenerEle.hasAttribute(RESPONSE_DESTINATION_ATTRIBUTE)) {
    String responseDestination=listenerEle.getAttribute(RESPONSE_DESTINATION_ATTRIBUTE);
    boolean pubSubDomain=indicatesPubSub(containerValues);
    listenerDef.getPropertyValues().add(pubSubDomain ? "defaultResponseTopicName" : "defaultResponseQueueName",responseDestination);
    if (containerDef.getPropertyValues().contains("destinationResolver")) {
      listenerDef.getPropertyValues().add("destinationResolver",containerDef.getPropertyValues().getPropertyValue("destinationResolver").getValue());
    }
  }
  listenerDef.setBeanClassName("org.springframework.jms.listener.adapter.MessageListenerAdapter");
  containerDef.getPropertyValues().add("messageListener",listenerDef);
  String containerBeanName=listenerEle.getAttribute(ID_ATTRIBUTE);
  if (!StringUtils.hasText(containerBeanName)) {
    containerBeanName=parserContext.getReaderContext().generateBeanName(containerDef);
  }
  parserContext.registerBeanComponent(new BeanComponentDefinition(containerDef,containerBeanName));
}
