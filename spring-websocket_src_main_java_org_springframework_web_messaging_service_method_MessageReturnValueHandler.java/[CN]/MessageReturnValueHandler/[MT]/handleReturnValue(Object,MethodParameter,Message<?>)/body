{
  Message<?> returnMessage=(Message<?>)returnValue;
  if (returnMessage == null) {
    return;
  }
  PubSubHeaders inHeaders=PubSubHeaders.fromMessageHeaders(message.getHeaders());
  String sessionId=inHeaders.getSessionId();
  String subscriptionId=inHeaders.getSubscriptionId();
  Assert.notNull(subscriptionId,"No subscription id: " + message);
  PubSubHeaders outHeaders=PubSubHeaders.fromMessageHeaders(returnMessage.getHeaders());
  outHeaders.setSessionId(sessionId);
  outHeaders.setSubscriptionId(subscriptionId);
  returnMessage=messageFactory.createMessage(returnMessage.getPayload(),outHeaders.toMessageHeaders());
  this.clientChannel.send(returnMessage);
}
