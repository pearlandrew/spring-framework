{
  Assert.notNull(this.outboundChannel,"No clientChannel to send messages to");
  Message<?> returnMessage=(Message<?>)returnValue;
  if (message == null) {
    return;
  }
  WebMessageHeaderAccesssor headers=WebMessageHeaderAccesssor.wrap(message);
  Assert.notNull(headers.getSubscriptionId(),"No subscription id: " + message);
  WebMessageHeaderAccesssor returnHeaders=WebMessageHeaderAccesssor.wrap(returnMessage);
  returnHeaders.setSessionId(headers.getSessionId());
  returnHeaders.setSubscriptionId(headers.getSubscriptionId());
  if (returnHeaders.getDestination() == null) {
    returnHeaders.setDestination(headers.getDestination());
  }
  returnMessage=MessageBuilder.withPayload(returnMessage.getPayload()).copyHeaders(returnHeaders.toMap()).build();
  this.outboundChannel.send(returnMessage);
}
