{
  Objects.requireNonNull(subscriber);
  State newState=publisher.dataAvailable ? DATA_AVAILABLE : DATA_UNAVAILABLE;
  if (publisher.changeState(this,newState)) {
    Subscription subscription=new RequestBodySubscription(publisher);
    publisher.subscriber=subscriber;
    subscriber.onSubscribe(subscription);
  }
 else {
    throw new IllegalStateException(toString());
  }
}
