{
  Connection connection=null;
  try {
    SimpleDriverDataSource shutdownDataSource=new SimpleDriverDataSource();
    shutdownDataSource.setDriverClass(EmbeddedDriver.class);
    shutdownDataSource.setUrl(String.format(URL_TEMPLATE,databaseName,"shutdown=true"));
    connection=shutdownDataSource.getConnection();
  }
 catch (  SQLException e) {
    if (e instanceof SQLNonTransientConnectionException) {
      SQLNonTransientConnectionException ex=(SQLNonTransientConnectionException)e;
      if (!SHUTDOWN_CODE.equals(ex.getSQLState())) {
        logException(e);
      }
    }
 else {
      logException(e);
    }
  }
 finally {
    JdbcUtils.closeConnection(connection);
  }
}
