{
  try {
    new EmbeddedDriver().connect(String.format(URL_TEMPLATE,databaseName,SHUTDOWN_COMMAND),new Properties());
  }
 catch (  SQLException ex) {
    if (!SHUTDOWN_CODE.equals(ex.getSQLState())) {
      logger.warn("Could not shutdown in-memory Derby database",ex);
      return;
    }
    if (!IS_AT_LEAST_DOT_SIX) {
      purgeDatabase(databaseName);
    }
  }
}
