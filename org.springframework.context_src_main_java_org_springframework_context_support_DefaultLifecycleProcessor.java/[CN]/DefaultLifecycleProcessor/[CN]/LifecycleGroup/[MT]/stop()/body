{
  if (members.size() == 0) {
    return;
  }
  Collections.sort(members,Collections.reverseOrder());
  final CountDownLatch latch=new CountDownLatch(this.smartMemberCount);
  for (  LifecycleGroupMember member : members) {
    if (lifecycleBeans.containsKey(member.name)) {
      doStop(lifecycleBeans,member.name,latch);
    }
 else     if (member.bean instanceof SmartLifecycle) {
      latch.countDown();
    }
  }
  try {
    latch.await(this.timeout,TimeUnit.MILLISECONDS);
    if (latch.getCount() != 0) {
      if (logger.isWarnEnabled()) {
        logger.warn("failed to shutdown beans with phase value " + this.phase + " within timeout of "+ this.timeout);
      }
    }
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
  }
}
