{
  Configuration config=new Configuration();
  config.getProperties().put(Environment.CURRENT_SESSION_CONTEXT_CLASS,SpringSessionContext.class.getName());
  config.getProperties().put(Environment.DATASOURCE,this.dataSource);
  config.getProperties().put("hibernate.classLoader.application",this.resourcePatternResolver.getClassLoader());
  if (this.hibernateProperties != null) {
    config.addProperties(this.hibernateProperties);
  }
  scanPackages(config);
  for (  Class<?> annotatedClass : this.annotatedClasses) {
    ReflectionUtils.invokeMethod(addAnnotatedClassMethod,config,annotatedClass);
  }
  this.sessionFactory=config.buildSessionFactory();
}
