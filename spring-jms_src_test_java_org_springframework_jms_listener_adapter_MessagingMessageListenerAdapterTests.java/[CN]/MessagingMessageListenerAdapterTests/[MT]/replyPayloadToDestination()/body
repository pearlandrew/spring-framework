{
  Queue replyDestination=mock(Queue.class);
  Message<String> request=MessageBuilder.withPayload("Response").setHeader("destination",replyDestination).build();
  Session session=mock(Session.class);
  MessageProducer messageProducer=mock(MessageProducer.class);
  TextMessage responseMessage=mock(TextMessage.class);
  given(session.createTextMessage("Response")).willReturn(responseMessage);
  given(session.createProducer(replyDestination)).willReturn(messageProducer);
  MessagingMessageListenerAdapter listener=getPayloadInstance(request,"replyPayloadToDestination",Message.class);
  listener.onMessage(mock(javax.jms.Message.class),session);
  verify(session,times(0)).createQueue(anyString());
  verify(session).createTextMessage("Response");
  verify(messageProducer).send(responseMessage);
  verify(messageProducer).close();
}
