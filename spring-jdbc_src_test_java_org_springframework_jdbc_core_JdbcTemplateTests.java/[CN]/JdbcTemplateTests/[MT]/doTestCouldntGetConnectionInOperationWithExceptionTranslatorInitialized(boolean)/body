{
  SQLException sqlException=new SQLException("foo","07xxx");
  this.dataSource=mock(DataSource.class);
  given(this.dataSource.getConnection()).willThrow(sqlException);
  this.template=new JdbcTemplate();
  this.template.setDataSource(this.dataSource);
  this.template.setLazyInit(false);
  if (beanProperty) {
    this.template.setExceptionTranslator(new SQLErrorCodeSQLExceptionTranslator(this.dataSource));
  }
 else {
    this.template.afterPropertiesSet();
  }
  RowCountCallbackHandler rcch=new RowCountCallbackHandler();
  this.thrown.expect(CannotGetJdbcConnectionException.class);
  this.thrown.expect(exceptionCause(sameInstance(sqlException)));
  this.template.query("SELECT ID, FORENAME FROM CUSTMR WHERE ID < 3",rcch);
}
