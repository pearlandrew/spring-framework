{
  Assert.notNull(classLoader,"ClassLoader must not be null");
  this.classLoader=classLoader;
  try {
    SecurityManager sm=System.getSecurityManager();
    if (sm != null) {
      AccessController.doPrivileged(new InstantiationAction());
    }
 else {
      doInstantiate();
    }
  }
 catch (  Exception e) {
    throw new IllegalStateException("Could not initialize JBoss ClassLoader because JBoss5 API classes are not available",e);
  }
}
