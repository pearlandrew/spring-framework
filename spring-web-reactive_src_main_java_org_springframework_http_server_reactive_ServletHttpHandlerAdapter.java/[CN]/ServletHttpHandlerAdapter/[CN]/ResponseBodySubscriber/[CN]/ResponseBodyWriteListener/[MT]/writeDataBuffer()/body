{
  InputStream input=dataBuffer.asInputStream();
  ServletOutputStream output=synchronizer.getResponse().getOutputStream();
  int bytesWritten=0;
  byte[] buffer=new byte[bufferSize];
  int bytesRead=-1;
  while (output.isReady() && (bytesRead=input.read(buffer)) != -1) {
    output.write(buffer,0,bytesRead);
    bytesWritten+=bytesRead;
  }
  return bytesWritten;
}
