{
  if (this.webApplicationContext != null) {
    if (this.webApplicationContext instanceof ConfigurableApplicationContext) {
      if (!((ConfigurableApplicationContext)this.webApplicationContext).isActive()) {
        ((ConfigurableApplicationContext)this.webApplicationContext).refresh();
      }
    }
    return this.webApplicationContext;
  }
  String attrName=getContextAttribute();
  if (attrName != null) {
    return WebApplicationContextUtils.getWebApplicationContext(getServletContext(),attrName);
  }
 else {
    return WebApplicationContextUtils.getWebApplicationContext(getServletContext());
  }
}
