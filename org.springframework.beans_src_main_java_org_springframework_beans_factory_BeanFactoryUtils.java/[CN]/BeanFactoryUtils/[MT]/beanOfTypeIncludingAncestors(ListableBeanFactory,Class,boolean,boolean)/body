{
  Map beansOfType=beansOfTypeIncludingAncestors(lbf,type,includeNonSingletons,allowEagerInit);
  if (beansOfType.size() == 1) {
    return beansOfType.values().iterator().next();
  }
 else {
    throw new NoSuchBeanDefinitionException(type,"expected single bean but found " + beansOfType.size());
  }
}
