{
  skipLeadingEol(buffer);
  String command=readCommand(buffer);
  if (command.length() > 0) {
    MultiValueMap<String,String> headers=readHeaders(buffer);
    byte[] payload=readPayload(buffer,headers);
    return MessageBuilder.withPayloadAndHeaders(payload,StompHeaderAccessor.create(StompCommand.valueOf(command),headers)).build();
  }
 else {
    return null;
  }
}
