{
  ApplicationContext context=new ClassPathXmlApplicationContext("advisedByProxyFactoryBean.xml",getClass());
  Messenger bean=(Messenger)context.getBean("messenger");
  assertTrue("Bean is not a proxy",AopUtils.isAopProxy(bean));
  assertTrue("Bean is not an Advised object",bean instanceof Advised);
  CountingBeforeAdvice advice=(CountingBeforeAdvice)context.getBean("advice");
  assertEquals(0,advice.getCalls());
  bean.getMessage();
  assertEquals(1,advice.getCalls());
}
