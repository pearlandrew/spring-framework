{
  ObjectMapper objectMapper;
  if (this.createXmlMapper) {
    try {
      Class<? extends ObjectMapper> xmlMapper=(Class<? extends ObjectMapper>)ClassUtils.forName("com.fasterxml.jackson.dataformat.xml.XmlMapper",this.moduleClassLoader);
      objectMapper=BeanUtils.instantiate(xmlMapper);
    }
 catch (    ClassNotFoundException ex) {
      throw new IllegalStateException("Could not instantiate XmlMapper - not found on classpath");
    }
  }
 else {
    objectMapper=new ObjectMapper();
  }
  configure(objectMapper);
  return (T)objectMapper;
}
