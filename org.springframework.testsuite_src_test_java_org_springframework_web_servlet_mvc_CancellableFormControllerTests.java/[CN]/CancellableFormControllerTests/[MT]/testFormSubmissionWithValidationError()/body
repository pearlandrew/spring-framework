{
  String successView="successView";
  String formView="formView";
  TestController ctl=new TestController();
  ctl.setSuccessView(successView);
  ctl.setFormView(formView);
  TestValidator val=new TestValidator();
  ctl.setValidator(val);
  MockHttpServletRequest request=new MockHttpServletRequest();
  MockHttpServletResponse response=new MockHttpServletResponse();
  request.setMethod("POST");
  request.addParameter("name","Rob Harrop");
  request.addParameter("age","23");
  ModelAndView mv=ctl.handleRequest(request,response);
  assertEquals("Incorrect view name",formView,mv.getViewName());
  Errors errors=(Errors)mv.getModel().get(BindException.MODEL_KEY_PREFIX + ctl.getCommandName());
  assertNotNull("No errors",errors);
  assertEquals(1,errors.getErrorCount());
  assertTrue(val.invoked);
}
