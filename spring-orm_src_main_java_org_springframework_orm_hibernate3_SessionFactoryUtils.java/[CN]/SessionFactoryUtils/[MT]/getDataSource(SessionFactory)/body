{
  if (sessionFactory instanceof SessionFactoryImplementor) {
    ConnectionProvider cp=((SessionFactoryImplementor)sessionFactory).getConnectionProvider();
    if (cp instanceof LocalDataSourceConnectionProvider) {
      return ((LocalDataSourceConnectionProvider)cp).getDataSource();
    }
  }
  return null;
}
