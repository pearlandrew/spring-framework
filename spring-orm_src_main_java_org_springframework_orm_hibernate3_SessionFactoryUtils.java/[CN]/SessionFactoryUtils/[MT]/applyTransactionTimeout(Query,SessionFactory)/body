{
  Assert.notNull(query,"No Query object specified");
  if (sessionFactory != null) {
    SessionHolder sessionHolder=(SessionHolder)TransactionSynchronizationManager.getResource(sessionFactory);
    if (sessionHolder != null && sessionHolder.hasTimeout()) {
      query.setTimeout(sessionHolder.getTimeToLiveInSeconds());
    }
  }
}
