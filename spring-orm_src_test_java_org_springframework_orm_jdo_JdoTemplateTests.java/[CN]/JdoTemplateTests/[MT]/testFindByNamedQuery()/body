{
  Query query=mock(Query.class);
  given(pmf.getPersistenceManager()).willReturn(pm);
  given(pm.newNamedQuery(String.class,"some query name")).willReturn(query);
  Collection coll=new HashSet();
  given(query.execute()).willReturn(coll);
  JdoTemplate jt=new JdoTemplate(pmf);
  assertEquals(coll,jt.findByNamedQuery(String.class,"some query name"));
  verify(pm).close();
}
