{
  String path=(String)request.getAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE);
  if (path == null) {
    throw new IllegalStateException("Required request attribute '" + HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE + "' is not set");
  }
  if (!StringUtils.hasText(path) || isInvalidPath(path)) {
    if (logger.isTraceEnabled()) {
      logger.trace("Ignoring invalid resource path [" + path + "]");
    }
    return null;
  }
  ResourceResolverChain resolveChain=new DefaultResourceResolverChain(getResourceResolvers());
  Resource resource=resolveChain.resolveResource(request,path,getLocations());
  if (resource == null || getResourceTransformers().isEmpty()) {
    return resource;
  }
  ResourceTransformerChain transformChain=new DefaultResourceTransformerChain(resolveChain,getResourceTransformers());
  resource=transformChain.transform(request,resource);
  return resource;
}
