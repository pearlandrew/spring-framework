{
  String targetUrl=createTargetUrl(model,request);
  targetUrl=updateTargetUrl(targetUrl,model,request,response);
  FlashMap flashMap=RequestContextUtils.getOutputFlashMap(request);
  if (!CollectionUtils.isEmpty(flashMap)) {
    UriComponents uriComponents=UriComponentsBuilder.fromUriString(targetUrl).build();
    flashMap.setTargetRequestPath(uriComponents.getPath());
    flashMap.addTargetRequestParams(uriComponents.getQueryParams());
  }
  FlashMapManager flashMapManager=RequestContextUtils.getFlashMapManager(request);
  flashMapManager.saveOutputFlashMap(flashMap,request,response);
  sendRedirect(request,response,targetUrl.toString(),this.http10Compatible);
}
