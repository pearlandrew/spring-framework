{
  MockHttpServletRequest request=new MockHttpServletRequest(getServletContext(),"GET","/locale.do;abc=def");
  request.addPreferredLocale(Locale.CANADA);
  request.addUserRole("role1");
  MockHttpServletResponse response=new MockHttpServletResponse();
  ComplexWebApplicationContext.MockMultipartResolver multipartResolver=(ComplexWebApplicationContext.MockMultipartResolver)complexDispatcherServlet.getWebApplicationContext().getBean("multipartResolver");
  MultipartHttpServletRequest multipartRequest=multipartResolver.resolveMultipart(request);
  complexDispatcherServlet.service(multipartRequest,response);
  multipartResolver.cleanupMultipart(multipartRequest);
  assertNotNull(request.getAttribute("cleanedUp"));
}
