{
  Assert.notNull(this.wrappedEnvironment,"Environment must not be null. Did you call setEnvironment()?");
  environment=new AbstractEnvironment(){
  }
;
  LinkedList<PropertySource<?>> propertySources=environment.getPropertySources();
  EnvironmentPropertySource environmentPropertySource=new EnvironmentPropertySource("wrappedEnvironment",wrappedEnvironment);
  if (!this.localOverride) {
    propertySources.add(environmentPropertySource);
  }
  if (this.localProperties != null) {
    int cx=0;
    for (    Properties localProps : this.localProperties) {
      propertySources.add(new PropertiesPropertySource("localProperties" + cx++,localProps));
    }
  }
  if (this.localOverride) {
    propertySources.add(environmentPropertySource);
  }
  super.postProcessBeanFactory(beanFactory);
}
