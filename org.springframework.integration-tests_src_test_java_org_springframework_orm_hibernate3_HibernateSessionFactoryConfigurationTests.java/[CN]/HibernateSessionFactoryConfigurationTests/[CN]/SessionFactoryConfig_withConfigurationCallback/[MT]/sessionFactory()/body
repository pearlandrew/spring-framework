{
  return new SessionFactoryBuilder(dataSource()).setSchemaUpdate(true).doWithConfiguration(new HibernateConfigurationCallback<org.hibernate.cfg.Configuration>(){
    public void configure(    org.hibernate.cfg.Configuration configuration) throws Exception {
      configuration.addFile(new File(this.getClass().getClassLoader().getResource("org/springframework/orm/hibernate3/scannable/FooMapping.hbm.xml").toURI()));
    }
  }
).buildSessionFactory();
}
