{
  final Properties registeredClassCache=new Properties();
  final Properties registeredCollectionCache=new Properties();
  LocalSessionFactoryBean sfb=new LocalSessionFactoryBean(){
    @Override protected Configuration newConfiguration(){
      return new Configuration(){
        @Override public void setCacheConcurrencyStrategy(        String clazz,        String concurrencyStrategy,        String regionName){
          registeredClassCache.setProperty(clazz,concurrencyStrategy + "," + regionName);
        }
        @Override public void setCollectionCacheConcurrencyStrategy(        String collectionRole,        String concurrencyStrategy,        String regionName){
          registeredCollectionCache.setProperty(collectionRole,concurrencyStrategy + "," + regionName);
        }
      }
;
    }
    @Override protected SessionFactory newSessionFactory(    Configuration config){
      return null;
    }
  }
;
  sfb.setMappingResources(new String[0]);
  sfb.setDataSource(new DriverManagerDataSource());
  Properties classCache=new Properties();
  classCache.setProperty("org.springframework.tests.sample.beans.TestBean","read-write,myRegion");
  sfb.setEntityCacheStrategies(classCache);
  Properties collectionCache=new Properties();
  collectionCache.setProperty("org.springframework.tests.sample.beans.TestBean.friends","read-only,myRegion");
  sfb.setCollectionCacheStrategies(collectionCache);
  sfb.afterPropertiesSet();
  assertEquals(classCache,registeredClassCache);
  assertEquals(collectionCache,registeredCollectionCache);
}
