{
  GenericWebApplicationContext context=new GenericWebApplicationContext();
  context.registerBeanDefinition("controller",new RootBeanDefinition(controllerType));
  if (useAutoProxy) {
    DefaultAdvisorAutoProxyCreator autoProxyCreator=new DefaultAdvisorAutoProxyCreator();
    autoProxyCreator.setBeanFactory(context.getBeanFactory());
    context.getBeanFactory().addBeanPostProcessor(autoProxyCreator);
    context.getBeanFactory().registerSingleton("advisor",new DefaultPointcutAdvisor(new SimpleTraceInterceptor()));
  }
  context.refresh();
  handlerMapping.setApplicationContext(context);
  handlerAdapter.afterPropertiesSet();
  exceptionResolver.afterPropertiesSet();
}
