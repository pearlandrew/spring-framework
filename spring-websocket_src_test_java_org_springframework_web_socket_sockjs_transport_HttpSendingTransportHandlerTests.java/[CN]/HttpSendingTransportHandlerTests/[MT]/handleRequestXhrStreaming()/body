{
  XhrStreamingTransportHandler transportHandler=new XhrStreamingTransportHandler();
  transportHandler.setSockJsConfiguration(sockJsConfig);
  AbstractSockJsSession session=transportHandler.createSession("1",webSocketHandler);
  transportHandler.handleRequest(request,response,webSocketHandler,session);
  assertEquals("application/javascript;charset=UTF-8",this.response.getHeaders().getContentType().toString());
  assertTrue("Streaming request not started",this.servletRequest.isAsyncStarted());
  verify(webSocketHandler).afterConnectionEstablished(session);
}
