{
  ApplicationContext context=getApplicationContext();
  String[] beanNames=context.getBeanNamesForType(Object.class);
  for (  String beanName : beanNames) {
    Class<?> handlerType=context.getType(beanName);
    RequestMapping mapping=context.findAnnotationOnBean(beanName,RequestMapping.class);
    if (mapping != null) {
      String[] modeKeys=mapping.value();
      String[] params=mapping.params();
      RequestMethod[] methods=mapping.method();
      boolean registerHandlerType=true;
      if (modeKeys.length == 0 || params.length == 0) {
        registerHandlerType=!detectHandlerMethods(handlerType,beanName,mapping);
      }
      if (registerHandlerType) {
        ParameterMappingPredicate predicate=new ParameterMappingPredicate(params,methods);
        for (        String modeKey : modeKeys) {
          registerHandler(new PortletMode(modeKey),beanName,predicate);
        }
      }
    }
 else     if (AnnotationUtils.findAnnotation(handlerType,Controller.class) != null) {
      detectHandlerMethods(handlerType,beanName,mapping);
    }
  }
}
