{
  final int amount=1103;
  final int custid=3;
  mockDatabaseMetaData.getDatabaseProductName();
  ctrlDatabaseMetaData.setReturnValue("MyDB");
  mockDatabaseMetaData.getUserName();
  ctrlDatabaseMetaData.setReturnValue("me");
  mockDatabaseMetaData.supportsCatalogsInProcedureCalls();
  ctrlDatabaseMetaData.setReturnValue(false);
  mockDatabaseMetaData.supportsSchemasInProcedureCalls();
  ctrlDatabaseMetaData.setReturnValue(false);
  mockDatabaseMetaData.storesUpperCaseIdentifiers();
  ctrlDatabaseMetaData.setReturnValue(false);
  mockDatabaseMetaData.storesLowerCaseIdentifiers();
  ctrlDatabaseMetaData.setReturnValue(true);
  mockCallable.registerOutParameter(1,4);
  ctrlCallable.setVoidCallable();
  mockCallable.setObject(2,1103,4);
  ctrlCallable.setVoidCallable();
  mockCallable.setObject(3,3,4);
  ctrlCallable.setVoidCallable();
  mockCallable.execute();
  ctrlCallable.setReturnValue(false);
  mockCallable.getUpdateCount();
  ctrlCallable.setReturnValue(-1);
  mockCallable.getObject(1);
  ctrlCallable.setReturnValue(new Long(4));
  if (debugEnabled) {
    mockCallable.getWarnings();
    ctrlCallable.setReturnValue(null);
  }
  mockCallable.close();
  ctrlCallable.setVoidCallable();
  mockConnection.prepareCall("{? = call add_invoice(?, ?)}");
  ctrlConnection.setReturnValue(mockCallable);
  replay();
  SimpleJdbcCall adder=new SimpleJdbcCall(mockDataSource).withFunctionName("add_invoice");
  adder.declareParameters(new SqlOutParameter("return",Types.INTEGER),new SqlParameter("amount",Types.INTEGER),new SqlParameter("custid",Types.INTEGER));
  Number newId=adder.executeFunction(Number.class,new MapSqlParameterSource().addValue("amount",amount).addValue("custid",custid));
  assertEquals(4,newId.intValue());
}
