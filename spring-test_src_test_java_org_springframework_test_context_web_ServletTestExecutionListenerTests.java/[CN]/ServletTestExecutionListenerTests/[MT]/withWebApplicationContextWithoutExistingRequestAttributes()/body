{
  assertAttributeExists();
  RequestContextHolder.resetRequestAttributes();
  listener.prepareTestInstance(testContext);
  assertAttributeDoesNotExist();
  verify(testContext).setAttribute(RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE,Boolean.TRUE);
  when(testContext.getAttribute(RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE)).thenReturn(Boolean.TRUE);
  listener.beforeTestMethod(testContext);
  assertAttributeDoesNotExist();
  verify(testContext).setAttribute(RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE,Boolean.TRUE);
  listener.afterTestMethod(testContext);
  verify(testContext).removeAttribute(RESET_REQUEST_CONTEXT_HOLDER_ATTRIBUTE);
  assertNull("request attributes should have been cleared",RequestContextHolder.getRequestAttributes());
}
