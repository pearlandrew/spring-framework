{
  Assert.hasLength(mediaType,"'mediaType' must not be empty");
  String[] parts=StringUtils.tokenizeToStringArray(mediaType,";");
  Map<String,String> parameters;
  if (parts.length <= 1) {
    parameters=null;
  }
 else {
    parameters=new LinkedHashMap<String,String>(parts.length - 1);
  }
  for (int i=1; i < parts.length; i++) {
    String part=parts[i];
    int idx=part.indexOf('=');
    if (idx != -1) {
      String name=part.substring(0,idx);
      String value=part.substring(idx + 1,part.length());
      parameters.put(name,value);
    }
  }
  String fullType=parts[0].trim();
  if (WILDCARD_TYPE.equals(fullType)) {
    fullType="*/*";
  }
  int idx=fullType.indexOf('/');
  String type=fullType.substring(0,idx);
  String subtype=fullType.substring(idx + 1,fullType.length());
  return new MediaType(type,subtype,parameters);
}
