{
  String appDestPrefix=messageBrokerElement.getAttribute("application-destination-prefix");
  ConstructorArgumentValues cavs=new ConstructorArgumentValues();
  cavs.addIndexedArgumentValue(0,clientInChannelDef);
  cavs.addIndexedArgumentValue(1,clientOutChannelDef);
  cavs.addIndexedArgumentValue(2,brokerMessagingTemplateRef);
  MutablePropertyValues mpvs=new MutablePropertyValues();
  mpvs.add("destinationPrefixes",Arrays.asList(StringUtils.tokenizeToStringArray(appDestPrefix,",")));
  mpvs.add("messageConverter",brokerMessageConverterRef);
  RootBeanDefinition annotationMethodMessageHandlerDef=new RootBeanDefinition(SimpAnnotationMethodMessageHandler.class,cavs,mpvs);
  String defaultSeparator=messageBrokerElement.getAttribute("default-separator");
  if (!defaultSeparator.isEmpty()) {
    annotationMethodMessageHandlerDef.getPropertyValues().add("pathMatcher",new AntPathMatcher(defaultSeparator));
  }
  registerBeanDef(annotationMethodMessageHandlerDef,parserCxt,source);
}
