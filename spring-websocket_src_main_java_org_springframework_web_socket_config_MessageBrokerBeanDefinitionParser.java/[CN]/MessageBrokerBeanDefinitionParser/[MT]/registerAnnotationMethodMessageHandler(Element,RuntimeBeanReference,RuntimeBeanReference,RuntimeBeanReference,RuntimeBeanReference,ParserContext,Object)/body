{
  String appDestPrefix=messageBrokerElement.getAttribute("application-destination-prefix");
  ConstructorArgumentValues cavs=new ConstructorArgumentValues();
  cavs.addIndexedArgumentValue(0,clientInChannelDef);
  cavs.addIndexedArgumentValue(1,clientOutChannelDef);
  cavs.addIndexedArgumentValue(2,brokerMessagingTemplateRef);
  MutablePropertyValues mpvs=new MutablePropertyValues();
  mpvs.add("destinationPrefixes",Arrays.asList(StringUtils.tokenizeToStringArray(appDestPrefix,",")));
  mpvs.add("messageConverter",brokerMessageConverterRef);
  RootBeanDefinition beanDef=new RootBeanDefinition(SimpAnnotationMethodMessageHandler.class,cavs,mpvs);
  if (messageBrokerElement.hasAttribute("path-matcher")) {
    beanDef.getPropertyValues().add("pathMatcher",new RuntimeBeanReference(messageBrokerElement.getAttribute("path-matcher")));
  }
  registerBeanDef(beanDef,parserCxt,source);
}
