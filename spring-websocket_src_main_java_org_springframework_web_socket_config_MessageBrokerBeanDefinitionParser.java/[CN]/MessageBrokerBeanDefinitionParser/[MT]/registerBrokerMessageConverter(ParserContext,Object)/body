{
  RootBeanDefinition contentTypeResolverDef=new RootBeanDefinition(DefaultContentTypeResolver.class);
  ManagedList<RootBeanDefinition> convertersDef=new ManagedList<RootBeanDefinition>();
  if (jackson2Present) {
    convertersDef.add(new RootBeanDefinition(MappingJackson2MessageConverter.class));
    contentTypeResolverDef.getPropertyValues().add("defaultMimeType",MimeTypeUtils.APPLICATION_JSON);
  }
  convertersDef.add(new RootBeanDefinition(StringMessageConverter.class));
  convertersDef.add(new RootBeanDefinition(ByteArrayMessageConverter.class));
  ConstructorArgumentValues cavs=new ConstructorArgumentValues();
  cavs.addIndexedArgumentValue(0,convertersDef);
  cavs.addIndexedArgumentValue(1,contentTypeResolverDef);
  RootBeanDefinition brokerMessage=new RootBeanDefinition(CompositeMessageConverter.class,cavs,null);
  return new RuntimeBeanReference(registerBeanDef(brokerMessage,parserCxt,source));
}
