{
  JsonEncoding encoding=getJsonEncoding(outputMessage.getHeaders().getContentType());
  @SuppressWarnings("deprecation") JsonGenerator jsonGenerator=this.objectMapper.getJsonFactory().createJsonGenerator(outputMessage.getBody(),encoding);
  if (this.objectMapper.isEnabled(SerializationFeature.INDENT_OUTPUT)) {
    jsonGenerator.useDefaultPrettyPrinter();
  }
  try {
    if (this.jsonPrefix != null) {
      jsonGenerator.writeRaw(this.jsonPrefix);
    }
    if (object instanceof MappingJacksonValueHolder) {
      MappingJacksonValueHolder valueHolder=(MappingJacksonValueHolder)object;
      object=valueHolder.getValue();
      Class<?> serializationView=valueHolder.getSerializationView();
      this.objectMapper.writerWithView(serializationView).writeValue(jsonGenerator,object);
    }
 else {
      this.objectMapper.writeValue(jsonGenerator,object);
    }
  }
 catch (  JsonProcessingException ex) {
    throw new HttpMessageNotWritableException("Could not write JSON: " + ex.getMessage(),ex);
  }
}
