{
  final ConfigurableApplicationContext context=new AnnotationConfigApplicationContext(Config.class,SimpleMessageListenerTestBean.class);
  JmsListenerContainerTestFactory factory=context.getBean(JmsListenerContainerTestFactory.class);
  assertEquals("one container should have been registered",1,factory.getContainers().size());
  MessageListenerTestContainer container=factory.getContainers().get(0);
  JmsListenerEndpoint endpoint=container.getEndpoint();
  assertEquals("Wrong endpoint type",MethodJmsListenerEndpoint.class,endpoint.getClass());
  MethodJmsListenerEndpoint methodEndpoint=(MethodJmsListenerEndpoint)endpoint;
  assertNotNull(methodEndpoint.getBean());
  assertNotNull(methodEndpoint.getMethod());
  assertTrue(methodEndpoint.isQueue());
  assertTrue("Should have been started " + container,container.isStarted());
  SimpleMessageListenerContainer listenerContainer=new SimpleMessageListenerContainer();
  methodEndpoint.setupMessageContainer(listenerContainer);
  assertNotNull(listenerContainer.getMessageListener());
  context.close();
  assertTrue("Should have been stopped " + container,container.isStopped());
}
