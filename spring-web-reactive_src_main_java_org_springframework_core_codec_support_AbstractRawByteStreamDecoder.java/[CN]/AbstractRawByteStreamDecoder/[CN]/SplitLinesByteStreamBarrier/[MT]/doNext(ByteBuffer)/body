{
  this.buffer=ByteBuffer.allocate(this.buffer.capacity() + byteBuffer.capacity()).put(this.buffer).put(byteBuffer);
  while (REQUESTED.get(this) > 0) {
    int separatorIndex=findEndOfLine(this.buffer);
    if (separatorIndex != -1) {
      if (BackpressureUtils.getAndSub(REQUESTED,this,1L) > 0) {
        byte[] message=new byte[separatorIndex];
        this.buffer.get(message);
        consumeSeparator(this.buffer);
        this.buffer=this.buffer.slice();
        super.doNext(ByteBuffer.wrap(message));
      }
    }
 else {
      super.doRequest(1);
    }
  }
}
