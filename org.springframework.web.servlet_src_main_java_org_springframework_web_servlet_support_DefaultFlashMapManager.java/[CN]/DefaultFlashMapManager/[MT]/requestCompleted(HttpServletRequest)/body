{
  FlashMap flashMap=(FlashMap)request.getAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE);
  if (flashMap == null) {
    throw new IllegalStateException("requestCompleted called but \"output\" FlashMap was never created");
  }
  if (!flashMap.isEmpty() && flashMap.isCreatedBy(this.hashCode())) {
    if (logger.isDebugEnabled()) {
      logger.debug("Saving FlashMap=" + flashMap);
    }
    onSaveFlashMap(flashMap,request);
    retrieveFlashMaps(request,true).add(flashMap);
  }
}
