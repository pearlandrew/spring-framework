{
  List<FlashMap> allMaps=retrieveFlashMaps(request,false);
  if (CollectionUtils.isEmpty(allMaps)) {
    return null;
  }
  if (logger.isDebugEnabled()) {
    logger.debug("Looking up previous FlashMap among available FlashMaps: " + allMaps);
  }
  List<FlashMap> matches=new ArrayList<FlashMap>();
  for (  FlashMap flashMap : allMaps) {
    if (flashMap.matches(request)) {
      if (logger.isDebugEnabled()) {
        logger.debug("Matched " + flashMap);
      }
      matches.add(flashMap);
    }
  }
  if (!matches.isEmpty()) {
    Collections.sort(matches);
    FlashMap match=matches.remove(0);
    allMaps.remove(match);
    return Collections.unmodifiableMap(match);
  }
  return null;
}
