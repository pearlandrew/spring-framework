{
  HttpSession session=request.getSession(allowCreate);
  if (session == null) {
    return null;
  }
  Map<String,FlashMap> result=(Map<String,FlashMap>)session.getAttribute(FLASH_MAPS_SESSION_ATTRIBUTE);
  if (result == null && allowCreate) {
synchronized (DefaultFlashMapManager.class) {
      result=(Map<String,FlashMap>)session.getAttribute(FLASH_MAPS_SESSION_ATTRIBUTE);
      if (result == null) {
        result=new ConcurrentHashMap<String,FlashMap>(5);
        session.setAttribute(FLASH_MAPS_SESSION_ATTRIBUTE,result);
      }
    }
  }
  return result;
}
