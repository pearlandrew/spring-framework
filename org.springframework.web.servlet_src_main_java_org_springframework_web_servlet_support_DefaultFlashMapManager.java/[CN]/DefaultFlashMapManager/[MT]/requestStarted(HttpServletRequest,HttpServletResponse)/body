{
  if (request.getAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE) != null) {
    return;
  }
  FlashMap inputFlashMap=lookupFlashMap(request);
  if (inputFlashMap != null) {
    request.setAttribute(INPUT_FLASH_MAP_ATTRIBUTE,Collections.unmodifiableMap(inputFlashMap));
  }
  FlashMap outputFlashMap=new FlashMap(this.hashCode());
  request.setAttribute(OUTPUT_FLASH_MAP_ATTRIBUTE,outputFlashMap);
  removeExpiredFlashMaps(request);
}
