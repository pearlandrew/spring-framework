{
  HttpSession session=request.getSession(allowCreate);
  if (session == null) {
    return null;
  }
  List<FlashMap> allFlashMaps=(List<FlashMap>)session.getAttribute(FLASH_MAPS_SESSION_ATTRIBUTE);
  if (allFlashMaps == null && allowCreate) {
synchronized (this) {
      allFlashMaps=(List<FlashMap>)session.getAttribute(FLASH_MAPS_SESSION_ATTRIBUTE);
      if (allFlashMaps == null) {
        allFlashMaps=new CopyOnWriteArrayList<FlashMap>();
        session.setAttribute(FLASH_MAPS_SESSION_ATTRIBUTE,allFlashMaps);
      }
    }
  }
  return allFlashMaps;
}
