{
  MockHttpServletRequest request=new MockHttpServletRequest();
  request.setMethod("GET");
  request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE,"../testsecret/secret.txt");
  MockHttpServletResponse response=new MockHttpServletResponse();
  handler.handleRequest(request,response);
  assertEquals(404,response.getStatus());
  request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE,"test/../../testsecret/secret.txt");
  response=new MockHttpServletResponse();
  handler.handleRequest(request,response);
  assertEquals(404,response.getStatus());
  handler.setLocations(Arrays.<Resource>asList(new ClassPathResource("testsecret/",getClass())));
  request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE,"secret.txt");
  response=new MockHttpServletResponse();
  handler.handleRequest(request,response);
  assertEquals(200,response.getStatus());
  assertEquals("text/plain",response.getContentType());
  assertEquals("big secret",response.getContentAsString());
}
