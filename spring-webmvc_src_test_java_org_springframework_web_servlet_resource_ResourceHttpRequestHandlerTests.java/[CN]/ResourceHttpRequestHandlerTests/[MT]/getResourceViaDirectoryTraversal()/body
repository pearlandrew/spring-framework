{
  this.request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE,"../testsecret/secret.txt");
  this.handler.handleRequest(this.request,this.response);
  assertEquals(404,this.response.getStatus());
  this.request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE,"test/../../testsecret/secret.txt");
  this.response=new MockHttpServletResponse();
  this.handler.handleRequest(this.request,this.response);
  assertEquals(404,this.response.getStatus());
  this.handler.setLocations(Arrays.<Resource>asList(new ClassPathResource("testsecret/",getClass())));
  this.request.setAttribute(HandlerMapping.PATH_WITHIN_HANDLER_MAPPING_ATTRIBUTE,"secret.txt");
  this.response=new MockHttpServletResponse();
  this.handler.handleRequest(this.request,this.response);
  assertEquals(200,this.response.getStatus());
  assertEquals("text/plain",this.response.getContentType());
  assertEquals("big secret",this.response.getContentAsString());
}
