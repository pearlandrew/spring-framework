{
  if (getDefaultLocale() != null && request.getHeader("Accept-Language") == null) {
    return getDefaultLocale();
  }
  Locale locale=request.getLocale();
  if (!isSupportedLocale(locale)) {
    locale=findSupportedLocale(request,locale);
  }
  return locale;
}
