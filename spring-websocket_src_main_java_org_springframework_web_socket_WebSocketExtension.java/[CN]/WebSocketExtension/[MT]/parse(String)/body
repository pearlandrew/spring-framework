{
  Assert.doesNotContain(extension,",","this string contains multiple extension declarations");
  String[] parts=StringUtils.tokenizeToStringArray(extension,";");
  String name=parts[0].trim();
  Map<String,String> parameters=null;
  if (parts.length > 1) {
    parameters=new LinkedHashMap<String,String>(parts.length - 1);
    for (int i=1; i < parts.length; i++) {
      String parameter=parts[i];
      int eqIndex=parameter.indexOf('=');
      if (eqIndex != -1) {
        String attribute=parameter.substring(0,eqIndex);
        String value=parameter.substring(eqIndex + 1,parameter.length());
        parameters.put(attribute,value);
      }
    }
  }
  return new WebSocketExtension(name,parameters);
}
