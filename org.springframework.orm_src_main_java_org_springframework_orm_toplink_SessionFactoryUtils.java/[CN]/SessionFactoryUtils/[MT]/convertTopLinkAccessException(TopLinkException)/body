{
  if (ex instanceof DatabaseException) {
    return new TopLinkJdbcException((DatabaseException)ex);
  }
  if (ex instanceof OptimisticLockException) {
    return new TopLinkOptimisticLockingFailureException((OptimisticLockException)ex);
  }
  if (ex instanceof QueryException) {
    return new TopLinkQueryException((QueryException)ex);
  }
  if (ex instanceof ConcurrencyException) {
    return new ConcurrencyFailureException(ex.getMessage(),ex);
  }
  if (ex instanceof ConversionException) {
    return new TypeMismatchDataAccessException(ex.getMessage(),ex);
  }
  return new TopLinkSystemException(ex);
}
