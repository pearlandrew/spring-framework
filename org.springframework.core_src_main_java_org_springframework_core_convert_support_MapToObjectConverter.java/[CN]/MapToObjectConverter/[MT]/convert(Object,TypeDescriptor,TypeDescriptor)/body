{
  if (source == null) {
    return this.conversionService.convertNullSource(sourceType,targetType);
  }
  Map<?,?> sourceMap=(Map<?,?>)source;
  if (sourceMap.size() == 0) {
    return null;
  }
 else {
    Object firstValue=sourceMap.values().iterator().next();
    TypeDescriptor sourceValueType=sourceType.getMapValueTypeDescriptor();
    if (sourceValueType == TypeDescriptor.NULL) {
      sourceValueType=TypeDescriptor.forObject(firstValue);
    }
    boolean valuesCompatible=false;
    if (sourceValueType != TypeDescriptor.NULL && sourceValueType.isAssignableTo(targetType)) {
      valuesCompatible=true;
    }
    if (valuesCompatible) {
      return firstValue;
    }
 else {
      MapEntryConverter converter=new MapEntryConverter(sourceValueType,sourceValueType,targetType,targetType,true,valuesCompatible,this.conversionService);
      return converter.convertValue(firstValue);
    }
  }
}
