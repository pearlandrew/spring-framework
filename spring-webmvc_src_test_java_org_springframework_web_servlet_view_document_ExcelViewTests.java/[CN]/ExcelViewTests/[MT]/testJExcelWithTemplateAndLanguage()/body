{
  request.setAttribute(DispatcherServlet.LOCALE_RESOLVER_ATTRIBUTE,newDummyLocaleResolver("de",""));
  AbstractJExcelView excelView=new AbstractJExcelView(){
    @Override protected void buildExcelDocument(    Map<String,Object> model,    WritableWorkbook wb,    HttpServletRequest request,    HttpServletResponse response) throws Exception {
      WritableSheet sheet=wb.getSheet("Sheet1");
      sheet.addCell(new Label(2,4,"Test Value"));
      sheet.addCell(new Label(2,3,"Test Value"));
      sheet.addCell(new Label(3,4,"Test Value"));
      sheet.addCell(new Label(2,4,"Test Value"));
    }
  }
;
  excelView.setApplicationContext(webAppCtx);
  excelView.setUrl("template");
  excelView.render(new HashMap<String,Object>(),request,response);
  Workbook wb=Workbook.getWorkbook(new ByteArrayInputStream(response.getContentAsByteArray()));
  Sheet sheet=wb.getSheet("Sheet1");
  Cell cell=sheet.getCell(0,0);
  assertEquals("Test Template auf Deutsch",cell.getContents());
}
