{
  HashMap<String,Object> model=new HashMap<String,Object>();
  Object obj=new Integer(1);
  model.put("foo","bar");
  model.put("I",obj);
  String url="forward-to";
  HttpServletRequest request=mock(HttpServletRequest.class);
  given(request.getAttribute(View.PATH_VARIABLES)).willReturn(null);
  given(request.getAttribute(WebUtils.INCLUDE_REQUEST_URI_ATTRIBUTE)).willReturn("somepath");
  given(request.getRequestDispatcher(url)).willReturn(new MockRequestDispatcher(url));
  MockHttpServletResponse response=new MockHttpServletResponse();
  InternalResourceView v=new InternalResourceView();
  v.setUrl(url);
  v.render(model,request,response);
  assertEquals(url,response.getIncludedUrl());
  Set<String> keys=model.keySet();
  for (Iterator<String> iter=keys.iterator(); iter.hasNext(); ) {
    String key=iter.next();
    verify(request).setAttribute(key,model.get(key));
  }
}
