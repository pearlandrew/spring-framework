{
  boolean shouldPublish=this.brokerAvailable.compareAndSet(true,false);
  if (this.eventPublisher != null && shouldPublish) {
    if (logger.isDebugEnabled()) {
      logger.debug("Publishing BrokerAvailabilityEvent (unavailable)");
    }
    this.eventPublisher.publishEvent(new BrokerAvailabilityEvent(false,this));
  }
}
