{
  final CountDownLatch asyncResultLatch=new CountDownLatch(1);
  WebAsyncManager asyncManager=WebAsyncUtils.getAsyncManager(request);
  asyncManager.registerCallableInterceptor("mockmvc",new CallableProcessingInterceptor(){
    public void preProcess(    NativeWebRequest request,    Callable<?> task) throws Exception {
    }
    public void postProcess(    NativeWebRequest request,    Callable<?> task,    Object value) throws Exception {
      asyncResultLatch.countDown();
    }
  }
);
  asyncManager.registerDeferredResultInterceptor("mockmvc",new DeferredResultProcessingInterceptor(){
    public void preProcess(    NativeWebRequest request,    DeferredResult<?> result) throws Exception {
    }
    public void postProcess(    NativeWebRequest request,    DeferredResult<?> result,    Object value) throws Exception {
      asyncResultLatch.countDown();
    }
    public void afterExpiration(    NativeWebRequest request,    DeferredResult<?> result) throws Exception {
    }
  }
);
  return asyncResultLatch;
}
