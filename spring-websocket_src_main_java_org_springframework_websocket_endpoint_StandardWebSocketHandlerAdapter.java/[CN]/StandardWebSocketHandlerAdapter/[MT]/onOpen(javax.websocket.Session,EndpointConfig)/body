{
  logger.debug("New WebSocket session: " + session);
  try {
    WebSocketSession webSocketSession=new WebSocketStandardSessionAdapter(session);
    this.sessionMap.put(session.getId(),webSocketSession);
    session.addMessageHandler(new StandardMessageHandler(session.getId()));
    this.webSocketHandler.newSession(webSocketSession);
  }
 catch (  Throwable ex) {
    logger.error("Error while processing new session",ex);
  }
}
