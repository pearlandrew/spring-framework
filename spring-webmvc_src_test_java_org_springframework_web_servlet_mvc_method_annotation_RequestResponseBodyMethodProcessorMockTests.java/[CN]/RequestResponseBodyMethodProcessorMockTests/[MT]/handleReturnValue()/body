{
  MediaType accepted=MediaType.TEXT_PLAIN;
  servletRequest.addHeader("Accept",accepted.toString());
  String body="Foo";
  given(messageConverter.canWrite(String.class,null)).willReturn(true);
  given(messageConverter.getSupportedMediaTypes()).willReturn(Collections.singletonList(MediaType.TEXT_PLAIN));
  given(messageConverter.canWrite(String.class,accepted)).willReturn(true);
  processor.handleReturnValue(body,returnTypeString,mavContainer,webRequest);
  assertTrue("The requestHandled flag wasn't set",mavContainer.isRequestHandled());
  verify(messageConverter).write(eq(body),eq(accepted),isA(HttpOutputMessage.class));
}
