{
  Object handler=this.handlerMap.get(urlPath);
  if (handler != null) {
    if (handler instanceof String) {
      String handlerName=(String)handler;
      handler=getApplicationContext().getBean(handlerName);
    }
    validateHandler(handler,request);
    return buildPathExposingHandler(handler,urlPath,null);
  }
  List<String> matchingPaths=new ArrayList<String>();
  for (  String registeredPath : this.handlerMap.keySet()) {
    if (getPathMatcher().match(registeredPath,urlPath)) {
      matchingPaths.add(registeredPath);
    }
  }
  String bestPathMatch=null;
  if (!matchingPaths.isEmpty()) {
    Collections.sort(matchingPaths,getPathMatcher().getPatternComparator(urlPath));
    if (logger.isDebugEnabled()) {
      logger.debug("Matching path for request [" + urlPath + "] are "+ matchingPaths);
    }
    bestPathMatch=matchingPaths.get(0);
  }
  if (bestPathMatch != null) {
    handler=this.handlerMap.get(bestPathMatch);
    if (handler instanceof String) {
      String handlerName=(String)handler;
      handler=getApplicationContext().getBean(handlerName);
    }
    validateHandler(handler,request);
    String pathWithinMapping=getPathMatcher().extractPathWithinPattern(bestPathMatch,urlPath);
    Map<String,String> uriTemplateVariables=getPathMatcher().extractUriTemplateVariables(bestPathMatch,urlPath);
    return buildPathExposingHandler(handler,pathWithinMapping,uriTemplateVariables);
  }
  return null;
}
