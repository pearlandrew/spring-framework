{
  if (responseType != null) {
    Class<?> responseClass=null;
    if (responseType instanceof Class) {
      responseClass=(Class)responseType;
    }
    List<MediaType> allSupportedMediaTypes=new ArrayList<MediaType>();
    for (    HttpMessageConverter<?> messageConverter : getMessageConverters()) {
      if (responseClass != null) {
        if (messageConverter.canRead(responseClass,null)) {
          allSupportedMediaTypes.addAll(getSupportedMediaTypes(messageConverter));
        }
      }
 else       if (messageConverter instanceof GenericHttpMessageConverter) {
        GenericHttpMessageConverter genericMessageConverter=(GenericHttpMessageConverter)messageConverter;
        if (genericMessageConverter.canRead(responseType,null)) {
          allSupportedMediaTypes.addAll(getSupportedMediaTypes(messageConverter));
        }
      }
    }
    if (!allSupportedMediaTypes.isEmpty()) {
      MediaType.sortBySpecificity(allSupportedMediaTypes);
      if (logger.isDebugEnabled()) {
        logger.debug("Setting request Accept header to " + allSupportedMediaTypes);
      }
      request.getHeaders().setAccept(allSupportedMediaTypes);
    }
  }
}
