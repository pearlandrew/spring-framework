{
  ApplicationContext ctx=mock(ApplicationContext.class);
  when(ctx.getResource(anyString())).thenReturn(mock(Resource.class));
  when(ctx.getAutowireCapableBeanFactory()).thenReturn(mock(AutowireCapableBeanFactory.class));
  Class<?> clazz=IsolatedWithoutTxMgr.class;
  Mockito.<Class<?>>when(testContext.getTestClass()).thenReturn(clazz);
  when(testContext.getTestMethod()).thenReturn(clazz.getDeclaredMethod("foo"));
  when(testContext.getApplicationContext()).thenReturn(ctx);
  assertExceptionContains("cannot execute SQL scripts using Transaction Mode [ISOLATED] without a PlatformTransactionManager");
}
