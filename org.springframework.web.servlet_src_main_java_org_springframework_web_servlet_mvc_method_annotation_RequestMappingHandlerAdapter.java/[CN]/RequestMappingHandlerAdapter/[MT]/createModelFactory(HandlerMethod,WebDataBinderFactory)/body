{
  List<InvocableHandlerMethod> modelAttrMethods=new ArrayList<InvocableHandlerMethod>();
  Class<?> handlerType=handlerMethod.getBeanType();
  Set<Method> attributeMethods=modelAttributeMethodCache.get(handlerType);
  if (attributeMethods == null) {
    attributeMethods=HandlerMethodSelector.selectMethods(handlerType,MODEL_ATTRIBUTE_METHODS);
    modelAttributeMethodCache.put(handlerType,attributeMethods);
  }
  for (  Method method : attributeMethods) {
    InvocableHandlerMethod attrMethod=new InvocableHandlerMethod(handlerMethod.getBean(),method);
    attrMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);
    attrMethod.setDataBinderFactory(binderFactory);
    attrMethod.setParameterNameDiscoverer(this.parameterNameDiscoverer);
    modelAttrMethods.add(attrMethod);
  }
  SessionAttributesHandler sessionAttrsHandler=sessionAttributesHandlerCache.get(handlerType);
  FlashAttributesHandler flashAttrsHandler=flashAttributesHandlerCache.get(handlerType);
  return new ModelFactory(modelAttrMethods,binderFactory,sessionAttrsHandler,flashAttrsHandler);
}
