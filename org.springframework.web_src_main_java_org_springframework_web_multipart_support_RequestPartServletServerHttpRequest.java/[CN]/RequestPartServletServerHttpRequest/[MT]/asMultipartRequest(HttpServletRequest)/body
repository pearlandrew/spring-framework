{
  if (request instanceof MultipartHttpServletRequest) {
    return (MultipartHttpServletRequest)request;
  }
 else   if (ClassUtils.hasMethod(HttpServletRequest.class,"getParts")) {
    return new StandardMultipartHttpServletRequest(request);
  }
  throw new IllegalArgumentException("Expected MultipartHttpServletRequest: is a MultipartResolver configured?");
}
