{
  FlashMap flashMap=new FlashMap("key","_flashKey");
  flashMap.put("name","value");
  request.setAttribute(DefaultFlashMapManager.CURRENT_FLASH_MAP_ATTRIBUTE,flashMap);
  this.flashMapManager.setFlashMapTimeout(0);
  this.flashMapManager.requestCompleted(this.request);
  Thread.currentThread().sleep(1);
  String sessionKey=DefaultFlashMapManager.FLASH_MAPS_SESSION_ATTRIBUTE;
  Map<String,FlashMap> allFlashMaps=(Map<String,FlashMap>)this.request.getSession().getAttribute(sessionKey);
  assertSame(flashMap,allFlashMaps.get("key"));
  assertTrue(flashMap.isExpired());
}
