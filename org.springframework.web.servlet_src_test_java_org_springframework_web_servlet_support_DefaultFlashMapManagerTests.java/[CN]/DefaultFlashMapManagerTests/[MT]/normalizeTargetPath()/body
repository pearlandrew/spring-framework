{
  this.flashMapManager.requestStarted(this.request);
  FlashMap flashMap=RequestContextUtils.getOutputFlashMap(this.request);
  flashMap.put("key","value");
  flashMap.setTargetRequestPath(".");
  this.request.setRequestURI("/once/upon/a/time");
  this.flashMapManager.requestCompleted(this.request);
  assertEquals("/once/upon/a",flashMap.getTargetRequestPath());
  flashMap.setTargetRequestPath("./");
  this.request.setRequestURI("/once/upon/a/time");
  this.flashMapManager.requestCompleted(this.request);
  assertEquals("/once/upon/a/",flashMap.getTargetRequestPath());
  flashMap.setTargetRequestPath("..");
  this.request.setRequestURI("/once/upon/a/time");
  this.flashMapManager.requestCompleted(this.request);
  assertEquals("/once/upon",flashMap.getTargetRequestPath());
  flashMap.setTargetRequestPath("../");
  this.request.setRequestURI("/once/upon/a/time");
  this.flashMapManager.requestCompleted(this.request);
  assertEquals("/once/upon/",flashMap.getTargetRequestPath());
  flashMap.setTargetRequestPath("../../only");
  this.request.setRequestURI("/once/upon/a/time");
  this.flashMapManager.requestCompleted(this.request);
  assertEquals("/once/only",flashMap.getTargetRequestPath());
}
