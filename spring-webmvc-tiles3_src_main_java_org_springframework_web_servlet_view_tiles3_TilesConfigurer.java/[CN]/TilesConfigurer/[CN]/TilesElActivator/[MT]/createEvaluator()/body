{
  try {
    JspFactory factory=JspFactory.getDefaultFactory();
    if ((factory != null) && (factory.getJspApplicationContext(servletContext).getExpressionFactory() != null)) {
      logger.info("Found JSP 2.1 ExpressionFactory");
      ELAttributeEvaluator evaluator=new ELAttributeEvaluator();
      evaluator.setExpressionFactory(factory.getJspApplicationContext(servletContext).getExpressionFactory());
      evaluator.setResolver(new CompositeELResolverImpl());
      return evaluator;
    }
  }
 catch (  Throwable ex) {
    logger.warn("Could not obtain JSP 2.1 ExpressionFactory",ex);
  }
  return null;
}
