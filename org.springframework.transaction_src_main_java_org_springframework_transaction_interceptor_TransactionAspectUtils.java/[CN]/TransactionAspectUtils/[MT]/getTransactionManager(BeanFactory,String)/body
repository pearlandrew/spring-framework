{
  if (beanFactory instanceof ConfigurableListableBeanFactory) {
    return getTransactionManager((ConfigurableListableBeanFactory)beanFactory,qualifier);
  }
 else   if (beanFactory.containsBean(qualifier)) {
    return beanFactory.getBean(qualifier,PlatformTransactionManager.class);
  }
 else {
    throw new IllegalStateException("No matching PlatformTransactionManager bean found for bean name '" + qualifier + "'! (Note: Qualifier matching not supported because given BeanFactory does not "+ "implement ConfigurableListableBeanFactory.)");
  }
}
