{
  List<GrantedAuthority> authorities=new ArrayList<GrantedAuthority>(roles.length);
  for (  String role : roles) {
    if (this.rolePrefix == null || role.startsWith(this.rolePrefix)) {
      authorities.add(new SimpleGrantedAuthority(role));
    }
 else {
      authorities.add(new SimpleGrantedAuthority(this.rolePrefix + role));
    }
  }
  return this;
}
