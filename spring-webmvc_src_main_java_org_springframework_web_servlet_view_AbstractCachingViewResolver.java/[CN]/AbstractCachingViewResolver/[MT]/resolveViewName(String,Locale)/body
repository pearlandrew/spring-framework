{
  if (!isCache()) {
    return createView(viewName,locale);
  }
 else {
    Object cacheKey=getCacheKey(viewName,locale);
synchronized (this.viewCache) {
      View view=this.viewCache.get(cacheKey);
      if (view == null && (!this.cacheUnresolved || !this.viewCache.containsKey(cacheKey))) {
        view=createView(viewName,locale);
        if (view != null || this.cacheUnresolved) {
          this.viewCache.put(cacheKey,view);
          if (logger.isTraceEnabled()) {
            logger.trace("Cached view [" + cacheKey + "]");
          }
        }
      }
      return view;
    }
  }
}
