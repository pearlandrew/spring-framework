{
  if (value == null) {
    return typeDescriptor;
  }
  if (typeDescriptor.isCollection() && Object.class.equals(typeDescriptor.getElementType())) {
    return typeDescriptor.resolveCollectionElementType((Collection<?>)value);
  }
 else   if (typeDescriptor.isMap() && Object.class.equals(typeDescriptor.getMapKeyType()) && Object.class.equals(typeDescriptor.getMapValueType())) {
    return typeDescriptor.resolveMapKeyValueTypes((Map<?,?>)value);
  }
 else {
    return typeDescriptor;
  }
}
