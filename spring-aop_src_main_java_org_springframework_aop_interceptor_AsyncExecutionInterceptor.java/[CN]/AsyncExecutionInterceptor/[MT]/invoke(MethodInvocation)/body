{
  Class<?> targetClass=(invocation.getThis() != null ? AopUtils.getTargetClass(invocation.getThis()) : null);
  Method specificMethod=ClassUtils.getMostSpecificMethod(invocation.getMethod(),targetClass);
  specificMethod=BridgeMethodResolver.findBridgedMethod(specificMethod);
  AsyncTaskExecutor executor=determineAsyncExecutor(specificMethod);
  if (executor == null) {
    throw new IllegalStateException("No executor specified and no default executor set on AsyncExecutionInterceptor either");
  }
  Future<?> result=executor.submit(new Callable<Object>(){
    @Override public Object call() throws Exception {
      try {
        Object result=invocation.proceed();
        if (result instanceof Future) {
          return ((Future<?>)result).get();
        }
      }
 catch (      Throwable ex) {
        ReflectionUtils.rethrowException(ex);
      }
      return null;
    }
  }
);
  if (Future.class.isAssignableFrom(invocation.getMethod().getReturnType())) {
    return result;
  }
 else {
    return null;
  }
}
