{
  this.sessionHolder=sessionHolder;
  this.sessionFactory=sessionFactory;
  this.jdbcExceptionTranslator=jdbcExceptionTranslator;
  this.newSession=newSession;
  TransactionManager jtaTm=SessionFactoryUtils.getJtaTransactionManager(sessionFactory,sessionHolder.getAnySession());
  if (jtaTm != null) {
    this.hibernateTransactionCompletion=true;
    try {
      this.jtaTransaction=jtaTm.getTransaction();
    }
 catch (    SystemException ex) {
      throw new DataAccessResourceFailureException("Could not access JTA transaction",ex);
    }
  }
}
