{
  AbstractJasperReportsView view=getView(COMPILED_REPORT);
  if (!(view instanceof AbstractJasperReportsSingleFormatView) || !((AbstractJasperReportsSingleFormatView)view).useWriter()) {
    return;
  }
  String characterEncoding="UTF-8";
  Map<Object,Object> parameters=new HashMap<Object,Object>();
  parameters.put(JRExporterParameter.CHARACTER_ENCODING,characterEncoding);
  view.setExporterParameters(parameters);
  view.convertExporterParameters();
  view.render(getModel(),this.request,this.response);
  assertEquals(characterEncoding,this.response.getCharacterEncoding());
}
