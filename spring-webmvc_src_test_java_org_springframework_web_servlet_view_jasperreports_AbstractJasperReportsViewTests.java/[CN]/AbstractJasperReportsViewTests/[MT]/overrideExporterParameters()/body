{
  AbstractJasperReportsView view=getView(COMPILED_REPORT);
  assumeTrue(view instanceof AbstractJasperReportsSingleFormatView && ((AbstractJasperReportsSingleFormatView)view).useWriter());
  String characterEncoding="UTF-8";
  String overiddenCharacterEncoding="ASCII";
  Map<Object,Object> parameters=new HashMap<>();
  parameters.put(net.sf.jasperreports.engine.JRExporterParameter.CHARACTER_ENCODING,characterEncoding);
  view.setExporterParameters(parameters);
  view.convertExporterParameters();
  Map<String,Object> model=getModel();
  model.put(net.sf.jasperreports.engine.JRExporterParameter.CHARACTER_ENCODING.toString(),overiddenCharacterEncoding);
  view.render(model,this.request,this.response);
  assertEquals(overiddenCharacterEncoding,this.response.getCharacterEncoding());
}
