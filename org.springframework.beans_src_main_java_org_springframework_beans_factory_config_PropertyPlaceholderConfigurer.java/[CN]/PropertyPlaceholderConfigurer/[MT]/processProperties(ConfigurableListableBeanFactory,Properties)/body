{
  StringValueResolver valueResolver=new PlaceholderResolvingStringValueResolver(props);
  BeanDefinitionVisitor visitor=new BeanDefinitionVisitor(valueResolver);
  String[] beanNames=beanFactoryToProcess.getBeanDefinitionNames();
  for (int i=0; i < beanNames.length; i++) {
    if (!(beanNames[i].equals(this.beanName) && beanFactoryToProcess.equals(this.beanFactory))) {
      BeanDefinition bd=beanFactoryToProcess.getBeanDefinition(beanNames[i]);
      try {
        visitor.visitBeanDefinition(bd);
      }
 catch (      BeanDefinitionStoreException ex) {
        throw new BeanDefinitionStoreException(bd.getResourceDescription(),beanNames[i],ex.getMessage());
      }
    }
  }
  beanFactoryToProcess.resolveAliases(valueResolver);
}
