{
  MultiValueMap<String,String> result=new LinkedMultiValueMap<String,String>();
  result.putAll(getExternalSourceHeaders());
  result.setAll(this.headers);
  String destination=super.getDestination();
  if (destination != null) {
    result.set(DESTINATION,destination);
  }
  MediaType contentType=getContentType();
  if (contentType != null) {
    result.set(CONTENT_TYPE,contentType.toString());
  }
  if (StompCommand.MESSAGE.equals(getStompCommand())) {
    String subscriptionId=getSubscriptionId();
    if (subscriptionId != null) {
      result.set(SUBSCRIPTION,subscriptionId);
    }
 else {
      logger.warn("STOMP MESSAGE frame should have a subscription: " + this.toString());
    }
    if ((getMessageId() == null)) {
      result.set(MESSAGE_ID,getSessionId() + "-" + messageIdCounter.getAndIncrement());
    }
  }
  return result;
}
