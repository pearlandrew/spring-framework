{
  Assert.notNull(clazz,"Class must not be null");
  try {
    Annotation[] anns=clazz.getDeclaredAnnotations();
    for (    Annotation ann : anns) {
      if (ann.annotationType().equals(annotationType)) {
        return (A)ann;
      }
    }
    for (    Annotation ann : anns) {
      if (!isInJavaLangAnnotationPackage(ann) && visited.add(ann)) {
        A annotation=findAnnotation(ann.annotationType(),annotationType,visited);
        if (annotation != null) {
          return annotation;
        }
      }
    }
  }
 catch (  Exception ex) {
    return null;
  }
  for (  Class<?> ifc : clazz.getInterfaces()) {
    A annotation=findAnnotation(ifc,annotationType,visited);
    if (annotation != null) {
      return annotation;
    }
  }
  Class<?> superclass=clazz.getSuperclass();
  if (superclass == null || superclass.equals(Object.class)) {
    return null;
  }
  return findAnnotation(superclass,annotationType,visited);
}
