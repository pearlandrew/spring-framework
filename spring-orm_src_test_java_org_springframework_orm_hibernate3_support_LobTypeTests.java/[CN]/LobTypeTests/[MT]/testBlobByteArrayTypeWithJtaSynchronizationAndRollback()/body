{
  TransactionManager tm=mock(TransactionManager.class);
  MockJtaTransaction transaction=new MockJtaTransaction();
  given(tm.getStatus()).willReturn(Status.STATUS_ACTIVE);
  given(tm.getTransaction()).willReturn(transaction);
  byte[] content="content".getBytes();
  given(lobHandler.getBlobAsBytes(rs,"column")).willReturn(content);
  BlobByteArrayType type=new BlobByteArrayType(lobHandler,tm);
  assertEquals(content,type.nullSafeGet(rs,new String[]{"column"},null));
  type.nullSafeSet(ps,content,1);
  Synchronization synch=transaction.getSynchronization();
  assertNotNull(synch);
  synch.afterCompletion(Status.STATUS_ROLLEDBACK);
  verify(lobCreator).setBlobAsBytes(ps,1,content);
}
