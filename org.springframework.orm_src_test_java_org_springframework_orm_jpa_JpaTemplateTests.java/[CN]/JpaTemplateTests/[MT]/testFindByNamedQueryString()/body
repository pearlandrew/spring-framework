{
  String queryName="some query name";
  MockControl queryControl=MockControl.createControl(Query.class);
  Query query=(Query)queryControl.getMock();
  List result=new ArrayList();
  managerControl.expectAndReturn(manager.createNamedQuery(queryName),query);
  queryControl.expectAndReturn(query.getResultList(),result);
  managerControl.replay();
  factoryControl.replay();
  queryControl.replay();
  assertSame(result,template.findByNamedQuery(queryName));
  managerControl.verify();
  factoryControl.verify();
  queryControl.verify();
}
