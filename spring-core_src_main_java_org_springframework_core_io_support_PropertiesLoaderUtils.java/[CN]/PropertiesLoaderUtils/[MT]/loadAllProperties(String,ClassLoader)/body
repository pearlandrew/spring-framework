{
  Assert.notNull(resourceName,"Resource name must not be null");
  ClassLoader clToUse=classLoader;
  if (clToUse == null) {
    clToUse=ClassUtils.getDefaultClassLoader();
  }
  Properties props=new Properties();
  Enumeration<URL> urls=clToUse.getResources(resourceName);
  while (urls.hasMoreElements()) {
    URL url=urls.nextElement();
    URLConnection con=url.openConnection();
    ResourceUtils.useCachesIfNecessary(con);
    InputStream is=con.getInputStream();
    try {
      if (resourceName != null && resourceName.endsWith(XML_FILE_EXTENSION)) {
        props.loadFromXML(is);
      }
 else {
        props.load(is);
      }
    }
  finally {
      is.close();
    }
  }
  return props;
}
