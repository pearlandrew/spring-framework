{
  ObjectName objectName=ObjectName.getInstance("spring:name=Test");
  JmxTestBean bean=new JmxTestBean();
  Map beans=new HashMap();
  beans.put(objectName,bean);
  CountingAttributeChangeNotificationListener listener=new CountingAttributeChangeNotificationListener();
  Map notificationListeners=new HashMap();
  notificationListeners.put(objectName,listener);
  MBeanExporter exporter=new MBeanExporter();
  exporter.setServer(server);
  exporter.setBeans(beans);
  exporter.setNotificationListenerMappings(notificationListeners);
  exporter.afterPropertiesSet();
  String attributeName="Name";
  server.setAttribute(objectName,new Attribute(attributeName,"Rob Harrop"));
  assertEquals("Listener not notified",1,listener.getCount(attributeName));
}
