{
  Map<String,String> domestic=new HashMap<String,String>();
  domestic.put("international","false");
  domestic.put("areaCode","205");
  domestic.put("prefix","339");
  domestic.put("line","1234");
  domestic.put("countryCode","whatever");
  domestic.put("cityCode","whatever");
  Mapper<Map,PhoneNumber> mapper=MapperFactory.mapperBuilder(Map.class,PhoneNumber.class).addConditionalMapping("countryCode","international == 'true'").addConditionalMapping("cityCode","international == 'true'").getMapper();
  PhoneNumber number=mapper.map(domestic,new PhoneNumber());
  assertEquals("205",number.getAreaCode());
  assertEquals("339",number.getPrefix());
  assertEquals("1234",number.getLine());
  assertNull(number.getCountryCode());
  assertNull(number.getCityCode());
  Map<String,String> international=new HashMap<String,String>();
  international.put("international","true");
  international.put("areaCode","205");
  international.put("prefix","339");
  international.put("line","1234");
  international.put("countryCode","1");
  international.put("cityCode","2");
  PhoneNumber number2=mapper.map(international,new PhoneNumber());
  assertEquals("205",number2.getAreaCode());
  assertEquals("339",number2.getPrefix());
  assertEquals("1234",number2.getLine());
  assertEquals("1",number2.getCountryCode());
  assertEquals("2",number2.getCityCode());
}
