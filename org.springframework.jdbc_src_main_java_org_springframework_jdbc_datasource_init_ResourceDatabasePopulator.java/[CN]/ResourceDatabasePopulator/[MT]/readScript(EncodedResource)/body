{
  LineNumberReader lnr=new LineNumberReader(resource.getReader());
  String currentStatement=lnr.readLine();
  StringBuilder scriptBuilder=new StringBuilder();
  while (currentStatement != null) {
    if (StringUtils.hasText(currentStatement) && (this.commentPrefix != null && !currentStatement.startsWith(this.commentPrefix))) {
      if (scriptBuilder.length() > 0) {
        scriptBuilder.append('\n');
      }
      scriptBuilder.append(currentStatement);
    }
    currentStatement=lnr.readLine();
  }
  maybeAddSeparatorToScript(scriptBuilder);
  return scriptBuilder.toString();
}
