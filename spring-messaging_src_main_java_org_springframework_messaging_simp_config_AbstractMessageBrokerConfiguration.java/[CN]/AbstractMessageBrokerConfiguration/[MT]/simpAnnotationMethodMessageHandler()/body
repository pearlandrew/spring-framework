{
  SimpAnnotationMethodMessageHandler handler=createAnnotationMethodMessageHandler();
  handler.setDestinationPrefixes(getBrokerRegistry().getApplicationDestinationPrefixes());
  handler.setMessageConverter(brokerMessageConverter());
  handler.setValidator(simpValidator());
  List<HandlerMethodArgumentResolver> argumentResolvers=new ArrayList<HandlerMethodArgumentResolver>();
  addArgumentResolvers(argumentResolvers);
  handler.setCustomArgumentResolvers(argumentResolvers);
  List<HandlerMethodReturnValueHandler> returnValueHandlers=new ArrayList<HandlerMethodReturnValueHandler>();
  addReturnValueHandlers(returnValueHandlers);
  handler.setCustomReturnValueHandlers(returnValueHandlers);
  PathMatcher pathMatcher=this.getBrokerRegistry().getPathMatcher();
  if (pathMatcher != null) {
    handler.setPathMatcher(pathMatcher);
  }
  return handler;
}
