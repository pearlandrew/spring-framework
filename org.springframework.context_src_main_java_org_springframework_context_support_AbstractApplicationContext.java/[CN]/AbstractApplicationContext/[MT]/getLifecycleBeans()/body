{
  ConfigurableListableBeanFactory beanFactory=getBeanFactory();
  String[] beanNames=beanFactory.getSingletonNames();
  Map beans=new LinkedHashMap();
  for (int i=0; i < beanNames.length; i++) {
    Object bean=beanFactory.getSingleton(beanNames[i]);
    if (bean instanceof Lifecycle) {
      beans.put(beanNames[i],bean);
    }
  }
  return beans;
}
