{
  ConfigurableListableBeanFactory beanFactory=getBeanFactory();
  String[] beanNames=beanFactory.getSingletonNames();
  Map<String,Lifecycle> beans=new LinkedHashMap<String,Lifecycle>();
  for (  String beanName : beanNames) {
    Object bean=beanFactory.getSingleton(beanName);
    if (bean instanceof Lifecycle) {
      beans.put(beanName,(Lifecycle)bean);
    }
  }
  return beans;
}
