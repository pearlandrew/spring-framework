{
  PreparedStatement preparedStatement=setupBatchOperation();
  final SqlParameterSource[] ids=new SqlParameterSource[2];
  ids[0]=new MapSqlParameterSource("id",100);
  ids[1]=new MapSqlParameterSource("id",200);
  int[] actualRowsAffected=template.batchUpdate("UPDATE NOSUCHTABLE SET DATE_DISPATCHED = SYSDATE WHERE ID = :id",ids);
  assertTrue("executed 2 updates",actualRowsAffected.length == 2);
  assertEquals(1,actualRowsAffected[0]);
  assertEquals(2,actualRowsAffected[1]);
  verify(preparedStatement).setObject(1,100);
  verify(preparedStatement).setObject(1,200);
  verify(preparedStatement,times(2)).addBatch();
  verify(preparedStatement).close();
}
