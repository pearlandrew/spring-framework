{
  ManagedMap<RuntimeBeanReference,String> cronTaskMap=new ManagedMap<RuntimeBeanReference,String>();
  ManagedMap<RuntimeBeanReference,String> fixedDelayTaskMap=new ManagedMap<RuntimeBeanReference,String>();
  ManagedMap<RuntimeBeanReference,String> fixedRateTaskMap=new ManagedMap<RuntimeBeanReference,String>();
  NodeList childNodes=element.getChildNodes();
  for (int i=0; i < childNodes.getLength(); i++) {
    Node child=childNodes.item(i);
    if (!(child instanceof Element) || !child.getLocalName().equals("task")) {
      continue;
    }
    Element taskElement=(Element)child;
    String ref=taskElement.getAttribute("ref");
    String method=taskElement.getAttribute("method");
    RuntimeBeanReference runnableBeanRef=new RuntimeBeanReference(this.createRunnableBean(ref,method,parserContext));
    String cronAttribute=taskElement.getAttribute("cron");
    if (StringUtils.hasText(cronAttribute)) {
      cronTaskMap.put(runnableBeanRef,cronAttribute);
    }
 else {
      String fixedDelayAttribute=taskElement.getAttribute("fixed-delay");
      if (StringUtils.hasText(fixedDelayAttribute)) {
        fixedDelayTaskMap.put(runnableBeanRef,fixedDelayAttribute);
      }
 else {
        String fixedRateAttribute=taskElement.getAttribute("fixed-rate");
        if (!StringUtils.hasText(fixedRateAttribute)) {
          parserContext.getReaderContext().error("one of 'cron', 'fixed-delay', or 'fixed-rate' is required",taskElement);
          return;
        }
        fixedRateTaskMap.put(runnableBeanRef,fixedRateAttribute);
      }
    }
  }
  String schedulerRef=element.getAttribute("scheduler");
  if (StringUtils.hasText(schedulerRef)) {
    builder.addPropertyReference("taskScheduler",schedulerRef);
  }
  builder.addPropertyValue("cronTasks",cronTaskMap);
  builder.addPropertyValue("fixedDelayTasks",fixedDelayTaskMap);
  builder.addPropertyValue("fixedRateTasks",fixedRateTaskMap);
}
