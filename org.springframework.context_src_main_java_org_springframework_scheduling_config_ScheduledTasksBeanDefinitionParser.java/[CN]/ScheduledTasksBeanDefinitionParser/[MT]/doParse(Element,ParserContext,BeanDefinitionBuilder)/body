{
  ManagedMap<RuntimeBeanReference,String> cronTaskMap=new ManagedMap<RuntimeBeanReference,String>();
  ManagedMap<RuntimeBeanReference,String> fixedDelayTaskMap=new ManagedMap<RuntimeBeanReference,String>();
  ManagedMap<RuntimeBeanReference,String> fixedRateTaskMap=new ManagedMap<RuntimeBeanReference,String>();
  NodeList childNodes=element.getChildNodes();
  for (int i=0; i < childNodes.getLength(); i++) {
    Node child=childNodes.item(i);
    if (!isScheduledElement(child,parserContext)) {
      continue;
    }
    Element taskElement=(Element)child;
    String ref=taskElement.getAttribute("ref");
    String method=taskElement.getAttribute("method");
    if (!StringUtils.hasText(ref) || !StringUtils.hasText(method)) {
      parserContext.getReaderContext().error("Both 'ref' and 'method' are required",taskElement);
      continue;
    }
    RuntimeBeanReference runnableBeanRef=new RuntimeBeanReference(createRunnableBean(ref,method,taskElement,parserContext));
    String cronAttribute=taskElement.getAttribute("cron");
    if (StringUtils.hasText(cronAttribute)) {
      cronTaskMap.put(runnableBeanRef,cronAttribute);
    }
 else {
      String fixedDelayAttribute=taskElement.getAttribute("fixed-delay");
      if (StringUtils.hasText(fixedDelayAttribute)) {
        fixedDelayTaskMap.put(runnableBeanRef,fixedDelayAttribute);
      }
 else {
        String fixedRateAttribute=taskElement.getAttribute("fixed-rate");
        if (!StringUtils.hasText(fixedRateAttribute)) {
          parserContext.getReaderContext().error("One of 'cron', 'fixed-delay', or 'fixed-rate' is required",taskElement);
          continue;
        }
        fixedRateTaskMap.put(runnableBeanRef,fixedRateAttribute);
      }
    }
  }
  String schedulerRef=element.getAttribute("scheduler");
  if (StringUtils.hasText(schedulerRef)) {
    builder.addPropertyReference("taskScheduler",schedulerRef);
  }
  builder.addPropertyValue("cronTasks",cronTaskMap);
  builder.addPropertyValue("fixedDelayTasks",fixedDelayTaskMap);
  builder.addPropertyValue("fixedRateTasks",fixedRateTaskMap);
}
