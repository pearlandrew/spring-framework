{
  Assert.notNull(request,"Request must not be null");
  Assert.notNull(allowedOrigins,"Allowed origins must not be null");
  String origin=request.getHeaders().getOrigin();
  if (origin == null || allowedOrigins.contains("*")) {
    return true;
  }
 else   if (CollectionUtils.isEmpty(allowedOrigins)) {
    UriComponents actualUrl=UriComponentsBuilder.fromHttpRequest(request).build();
    UriComponents originUrl=UriComponentsBuilder.fromOriginHeader(origin).build();
    return (actualUrl.getHost().equals(originUrl.getHost()) && getPort(actualUrl) == getPort(originUrl));
  }
 else {
    return allowedOrigins.contains(origin);
  }
}
