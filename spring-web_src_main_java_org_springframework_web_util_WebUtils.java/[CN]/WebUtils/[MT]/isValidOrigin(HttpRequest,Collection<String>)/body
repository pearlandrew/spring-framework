{
  Assert.notNull(request,"Request must not be null");
  Assert.notNull(allowedOrigins,"Allowed origins must not be null");
  String origin=request.getHeaders().getOrigin();
  if (origin == null || allowedOrigins.contains("*")) {
    return true;
  }
 else   if (allowedOrigins.isEmpty()) {
    UriComponents originComponents;
    try {
      originComponents=UriComponentsBuilder.fromHttpUrl(origin).build();
    }
 catch (    IllegalArgumentException ex) {
      logger.error("Failed to parse Origin header value [" + origin + "]");
      return false;
    }
    UriComponents requestComponents=UriComponentsBuilder.fromHttpRequest(request).build();
    int originPort=getPort(originComponents);
    int requestPort=getPort(requestComponents);
    return (originComponents.getHost().equals(requestComponents.getHost()) && originPort == requestPort);
  }
 else {
    return allowedOrigins.contains(origin);
  }
}
