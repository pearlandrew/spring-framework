{
  List<M> messages=new ArrayList<M>();
  this.messageQueue.drainTo(messages);
  for (  Message<?> message : messages) {
    StompHeaderAccessor headers=StompHeaderAccessor.wrap(message);
    if (!forwardInternal(message,headers,connection)) {
      return;
    }
  }
}
