{
  Object incomingCorrelationId=headers.get(MessageHeaders.CORRELATION_ID);
  @SuppressWarnings("unchecked") List<List<Object>> incomingSequenceDetails=(List<List<Object>>)headers.get(MessageHeaders.SEQUENCE_DETAILS);
  if (incomingCorrelationId != null) {
    if (incomingSequenceDetails == null) {
      incomingSequenceDetails=new ArrayList<List<Object>>();
    }
 else {
      incomingSequenceDetails=new ArrayList<List<Object>>(incomingSequenceDetails);
    }
    incomingSequenceDetails.add(Arrays.asList(incomingCorrelationId,headers.get(MessageHeaders.SEQUENCE_NUMBER),headers.get(MessageHeaders.SEQUENCE_SIZE)));
    incomingSequenceDetails=Collections.unmodifiableList(incomingSequenceDetails);
  }
  if (incomingSequenceDetails != null) {
    setHeader(MessageHeaders.SEQUENCE_DETAILS,incomingSequenceDetails);
  }
  return setCorrelationId(correlationId).setSequenceNumber(sequenceNumber).setSequenceSize(sequenceSize);
}
