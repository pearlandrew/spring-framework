{
  ClassPathXmlApplicationContext ctx=new ClassPathXmlApplicationContext("/org/springframework/beans/factory/xml/resource.xml"){
    public Resource getResource(    String location){
      if ("classpath:org/springframework/beans/factory/xml/test.properties".equals(location)) {
        return new ClassPathResource("test.properties",ClassPathXmlApplicationContextTests.class);
      }
      return super.getResource(location);
    }
  }
;
  ResourceTestBean resource1=(ResourceTestBean)ctx.getBean("resource1");
  ResourceTestBean resource2=(ResourceTestBean)ctx.getBean("resource2");
  assertTrue(resource1.getResource() instanceof ClassPathResource);
  StringWriter writer=new StringWriter();
  FileCopyUtils.copy(new InputStreamReader(resource1.getResource().getInputStream()),writer);
  assertEquals("contexttest",writer.toString());
  writer=new StringWriter();
  FileCopyUtils.copy(new InputStreamReader(resource1.getInputStream()),writer);
  assertEquals("contexttest",writer.toString());
  writer=new StringWriter();
  FileCopyUtils.copy(new InputStreamReader(resource2.getResource().getInputStream()),writer);
  assertEquals("contexttest",writer.toString());
  writer=new StringWriter();
  FileCopyUtils.copy(new InputStreamReader(resource2.getInputStream()),writer);
  assertEquals("contexttest",writer.toString());
  ctx.close();
}
