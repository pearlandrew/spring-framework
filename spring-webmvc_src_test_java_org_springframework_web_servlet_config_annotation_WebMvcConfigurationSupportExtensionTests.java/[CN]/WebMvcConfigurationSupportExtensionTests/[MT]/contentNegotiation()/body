{
  MockHttpServletRequest request=new MockHttpServletRequest("GET","/foo.json");
  NativeWebRequest webRequest=new ServletWebRequest(request);
  ContentNegotiationManager manager=webConfig.requestMappingHandlerMapping().getContentNegotiationManager();
  assertEquals(Arrays.asList(MediaType.APPLICATION_JSON),manager.resolveMediaTypes(webRequest));
  request.setRequestURI("/foo.xml");
  assertEquals(Arrays.asList(MediaType.APPLICATION_XML),manager.resolveMediaTypes(webRequest));
  request.setRequestURI("/foo.rss");
  assertEquals(Arrays.asList(MediaType.valueOf("application/rss+xml")),manager.resolveMediaTypes(webRequest));
  request.setRequestURI("/foo.atom");
  assertEquals(Arrays.asList(MediaType.APPLICATION_ATOM_XML),manager.resolveMediaTypes(webRequest));
  request.setRequestURI("/foo");
  request.setParameter("f","json");
  assertEquals(Arrays.asList(MediaType.APPLICATION_JSON),manager.resolveMediaTypes(webRequest));
}
