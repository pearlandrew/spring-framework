{
  if (ex instanceof JDBCConnectionException) {
    return new DataAccessResourceFailureException(ex.getMessage(),ex);
  }
  if (ex instanceof SQLGrammarException) {
    return new InvalidDataAccessResourceUsageException(ex.getMessage(),ex);
  }
  if (ex instanceof LockAcquisitionException) {
    return new CannotAcquireLockException(ex.getMessage(),ex);
  }
  if (ex instanceof ConstraintViolationException) {
    return new DataIntegrityViolationException(ex.getMessage(),ex);
  }
  if (ex instanceof DataException) {
    return new DataIntegrityViolationException(ex.getMessage(),ex);
  }
  if (ex instanceof JDBCException) {
    return new HibernateJdbcException((JDBCException)ex);
  }
  if (ex instanceof PropertyValueException) {
    return new DataIntegrityViolationException(ex.getMessage(),ex);
  }
  if (ex instanceof PersistentObjectException) {
    return new InvalidDataAccessApiUsageException(ex.getMessage(),ex);
  }
  if (ex instanceof TransientObjectException) {
    return new InvalidDataAccessApiUsageException(ex.getMessage(),ex);
  }
  if (ex instanceof ObjectDeletedException) {
    return new InvalidDataAccessApiUsageException(ex.getMessage(),ex);
  }
  if (ex instanceof QueryException) {
    return new HibernateQueryException((QueryException)ex);
  }
  if (ex instanceof UnresolvableObjectException) {
    return new HibernateObjectRetrievalFailureException((UnresolvableObjectException)ex);
  }
  if (ex instanceof WrongClassException) {
    return new HibernateObjectRetrievalFailureException((WrongClassException)ex);
  }
  if (ex instanceof NonUniqueResultException) {
    return new IncorrectResultSizeDataAccessException(ex.getMessage(),1);
  }
  if (ex instanceof StaleObjectStateException) {
    return new HibernateOptimisticLockingFailureException((StaleObjectStateException)ex);
  }
  if (ex instanceof StaleStateException) {
    return new HibernateOptimisticLockingFailureException((StaleStateException)ex);
  }
  return new HibernateSystemException(ex);
}
