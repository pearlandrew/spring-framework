{
  if (data == null) {
    throw new NullPointerException();
  }
 else   if ((offset < 0) || ((offset + length) > data.length) || (length < 0)) {
    throw new IndexOutOfBoundsException();
  }
 else   if (closed) {
    throw new IOException("Stream closed");
  }
 else {
    if (buffers.peekLast() == null || buffers.getLast().length == index) {
      addBuffer(length);
    }
    if ((index + length) > buffers.getLast().length) {
      do {
        if (index == buffers.getLast().length) {
          addBuffer(length);
        }
        int copyLength=buffers.getLast().length - index;
        if (length < copyLength) {
          copyLength=length;
        }
        System.arraycopy(data,offset,buffers.getLast(),index,copyLength);
        offset+=copyLength;
        index+=copyLength;
        length-=copyLength;
      }
 while (length > 0);
    }
 else {
      System.arraycopy(data,offset,buffers.getLast(),index,length);
      index+=length;
    }
  }
}
