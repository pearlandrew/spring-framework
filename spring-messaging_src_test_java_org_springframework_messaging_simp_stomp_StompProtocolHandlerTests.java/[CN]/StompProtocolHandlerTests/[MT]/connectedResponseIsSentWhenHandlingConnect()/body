{
  this.stompHandler.setHandleConnect(true);
  TextMessage textMessage=StompTextMessageBuilder.create(StompCommand.CONNECT).headers("login:guest","passcode:guest","accept-version:1.1,1.0","heart-beat:10000,10000").build();
  this.stompHandler.handleMessageFromClient(this.session,textMessage,this.channel);
  verifyNoMoreInteractions(this.channel);
  assertEquals(1,this.session.getSentMessages().size());
  textMessage=(TextMessage)this.session.getSentMessages().get(0);
  Message<?> message=new StompDecoder().decode(ByteBuffer.wrap(textMessage.getPayload().getBytes()));
  StompHeaderAccessor replyHeaders=StompHeaderAccessor.wrap(message);
  assertEquals(StompCommand.CONNECTED,replyHeaders.getCommand());
  assertEquals("1.1",replyHeaders.getVersion());
  assertArrayEquals(new long[]{0,0},replyHeaders.getHeartbeat());
  assertEquals("joe",replyHeaders.getNativeHeader("user-name").get(0));
  assertEquals("s1",replyHeaders.getNativeHeader("queue-suffix").get(0));
}
