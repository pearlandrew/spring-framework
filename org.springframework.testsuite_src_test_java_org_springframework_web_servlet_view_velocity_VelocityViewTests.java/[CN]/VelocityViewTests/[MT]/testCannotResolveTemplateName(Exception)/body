{
  final String templateName="test.vm";
  MockControl wmc=MockControl.createControl(WebApplicationContext.class);
  WebApplicationContext wac=(WebApplicationContext)wmc.getMock();
  wac.getParentBeanFactory();
  wmc.setReturnValue(null);
  VelocityConfig vc=new VelocityConfig(){
    public VelocityEngine getVelocityEngine(){
      return new VelocityEngine(){
        public Template getTemplate(        String tn) throws ResourceNotFoundException, ParseErrorException, Exception {
          assertEquals(tn,templateName);
          throw templateLookupException;
        }
      }
;
    }
  }
;
  wac.getBeansOfType(VelocityConfig.class,true,false);
  Map configurers=new HashMap();
  configurers.put("velocityConfigurer",vc);
  wmc.setReturnValue(configurers);
  wmc.replay();
  VelocityView vv=new VelocityView();
  vv.setUrl(templateName);
  try {
    vv.setApplicationContext(wac);
    fail();
  }
 catch (  ApplicationContextException ex) {
    assertEquals(ex.getCause(),templateLookupException);
  }
  wmc.verify();
}
