{
  Map<String,String> variables=(Map<String,String>)request.getAttribute(HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE);
  int patternVariableCount=StringUtils.countOccurrencesOf(mappedPattern,"{");
  if ((variables == null || patternVariableCount != variables.size()) && pathMatcher.match(mappedPattern,lookupPath)) {
    variables=pathMatcher.extractUriTemplateVariables(mappedPattern,lookupPath);
    Map<String,String> decodedVariables=urlPathHelper.decodePathVariables(request,variables);
    request.setAttribute(HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE,decodedVariables);
  }
}
