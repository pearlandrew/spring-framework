{
  Assert.notNull(message);
  MessageHeaders headers=message.getHeaders();
  String sessionId=SimpMessageHeaderAccessor.getSessionId(headers);
  Map<String,Object> sessionAttributes=SimpMessageHeaderAccessor.getSessionAttributes(headers);
  if (sessionId == null || sessionAttributes == null) {
    throw new IllegalStateException("Message does not contain SiMP session id or attributes: " + message);
  }
  return new SimpAttributes(sessionId,sessionAttributes);
}
