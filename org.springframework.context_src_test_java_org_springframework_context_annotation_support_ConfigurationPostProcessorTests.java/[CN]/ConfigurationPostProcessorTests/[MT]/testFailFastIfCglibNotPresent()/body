{
@Configuration class Config {
  }
  DefaultListableBeanFactory factory=new DefaultListableBeanFactory();
  factory.registerBeanDefinition("config",rootBeanDefinition(Config.class).getBeanDefinition());
  ConfigurationClassPostProcessor cpp=new ConfigurationClassPostProcessor();
  ConfigurationClassPostProcessor.CGLIB_TEST_CLASS=BOGUS_CGLIB_TEST_CLASS;
  try {
    cpp.postProcessBeanFactory(factory);
  }
 catch (  RuntimeException ex) {
    assertTrue(ex.getMessage().contains("CGLIB is required to process @Configuration classes"));
  }
 finally {
    ConfigurationClassPostProcessor.CGLIB_TEST_CLASS=ORIG_CGLIB_TEST_CLASS;
  }
}
