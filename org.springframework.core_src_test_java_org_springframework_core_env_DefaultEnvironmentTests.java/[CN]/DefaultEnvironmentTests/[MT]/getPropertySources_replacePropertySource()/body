{
  AbstractEnvironment env=new AbstractEnvironment(){
  }
;
  env.addPropertySource("system",new HashMap(){
{
      put("foo","systemValue");
    }
  }
);
  env.addPropertySource("local",new HashMap(){
{
      put("foo","localValue");
    }
  }
);
  assertThat(env.getProperty("foo"),equalTo("localValue"));
  LinkedList<PropertySource<?>> propertySources=env.getPropertySources();
  int localIndex=propertySources.indexOf(PropertySource.named("local"));
  MapPropertySource newSource=new MapPropertySource("new",new HashMap(){
{
      put("foo","newValue");
    }
  }
);
  propertySources.set(localIndex,newSource);
  assertThat(env.getProperty("foo"),equalTo("newValue"));
  assertThat(propertySources.size(),is(2));
}
