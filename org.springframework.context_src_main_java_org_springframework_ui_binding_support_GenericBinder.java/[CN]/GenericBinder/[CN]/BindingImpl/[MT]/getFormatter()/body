{
  if (formatter != null) {
    return formatter;
  }
 else {
    TypeDescriptor type;
    try {
      type=property.getValueTypeDescriptor(createEvaluationContext());
    }
 catch (    EvaluationException e) {
      throw new IllegalArgumentException("Failed to get property expression value type descriptor - this should not happen",e);
    }
    Formatter formatter=formatterRegistry.getFormatter(type);
    return formatter != null ? formatter : defaultFormatter;
  }
}
