{
  MockControl mockSession=MockControl.createControl(Session.class);
  final Session session=(Session)mockSession.getMock();
  mockSession.replay();
  MockControl mockDestinationResolver=MockControl.createControl(DestinationResolver.class);
  DestinationResolver dynamicResolver=(DestinationResolver)mockDestinationResolver.getMock();
  mockDestinationResolver.replay();
  final JndiDestinationResolver resolver=new JndiDestinationResolver(){
    protected Object lookup(    String jndiName,    Class requiredClass) throws NamingException {
      throw new NamingException();
    }
  }
;
  resolver.setDynamicDestinationResolver(dynamicResolver);
  try {
    resolver.resolveDestinationName(session,DESTINATION_NAME,true);
    fail("expected DestinationResolutionException");
  }
 catch (  DestinationResolutionException ex) {
  }
  mockSession.verify();
  mockDestinationResolver.verify();
}
