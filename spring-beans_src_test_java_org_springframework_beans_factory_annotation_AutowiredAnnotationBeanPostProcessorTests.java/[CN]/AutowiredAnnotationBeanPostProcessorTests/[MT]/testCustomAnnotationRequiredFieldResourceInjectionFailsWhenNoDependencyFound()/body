{
  DefaultListableBeanFactory bf=new DefaultListableBeanFactory();
  AutowiredAnnotationBeanPostProcessor bpp=new AutowiredAnnotationBeanPostProcessor();
  bpp.setAutowiredAnnotationType(MyAutowired.class);
  bpp.setRequiredParameterName("optional");
  bpp.setRequiredParameterValue(false);
  bpp.setBeanFactory(bf);
  bf.addBeanPostProcessor(bpp);
  bf.registerBeanDefinition("customBean",new RootBeanDefinition(CustomAnnotationRequiredFieldResourceInjectionBean.class));
  try {
    bf.getBean("customBean");
    fail("expected BeanCreationException; no dependency available for required field");
  }
 catch (  BeanCreationException ex) {
  }
  bf.destroySingletons();
}
