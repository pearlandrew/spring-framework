{
  ByteArrayOutputStream baos=new ByteArrayOutputStream(BUFFER_SIZE);
  byte[] buffer=new byte[BUFFER_SIZE];
  int bufferCount=-1;
  while ((bufferCount=message.readBytes(buffer)) >= 0) {
    baos.write(buffer,0,bufferCount);
    if (bufferCount < BUFFER_SIZE) {
      break;
    }
  }
  return baos.toByteArray();
}
