{
  Assert.notNull(connectMessage,"connectMessage is required");
  Composable<TcpConnection<Message<byte[]>,Message<byte[]>>> promise=openTcpConnection();
  promise.consume(new Consumer<TcpConnection<Message<byte[]>,Message<byte[]>>>(){
    @Override public void accept(    TcpConnection<Message<byte[]>,Message<byte[]>> connection){
      handleTcpConnection(connection,connectMessage);
    }
  }
);
  promise.when(Throwable.class,new Consumer<Throwable>(){
    @Override public void accept(    Throwable ex){
      relaySessions.remove(sessionId);
      handleTcpClientFailure("Failed to connect to message broker",ex);
    }
  }
);
}
