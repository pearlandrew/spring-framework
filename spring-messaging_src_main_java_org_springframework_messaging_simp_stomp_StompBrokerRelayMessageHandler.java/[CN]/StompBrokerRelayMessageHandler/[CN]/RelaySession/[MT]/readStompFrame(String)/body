{
  if (StringUtils.isEmpty(stompFrame)) {
    return;
  }
  Message<?> message=stompMessageConverter.toMessage(stompFrame);
  if (logger.isTraceEnabled()) {
    logger.trace("Reading message " + message);
  }
  StompHeaderAccessor headers=StompHeaderAccessor.wrap(message);
  if (StompCommand.CONNECTED == headers.getStompCommand()) {
synchronized (this.monitor) {
      this.isConnected=true;
      flushMessages(this.promise.get());
    }
    return;
  }
  headers.setSessionId(this.sessionId);
  message=MessageBuilder.fromMessage(message).copyHeaders(headers.toMap()).build();
  sendMessageToClient(message);
}
