{
  if (logger.isTraceEnabled()) {
    logger.trace("Reading message " + message);
  }
  StompHeaderAccessor headers=StompHeaderAccessor.wrap(message);
  if (StompCommand.CONNECTED == headers.getCommand()) {
    this.stompConnection.setReady();
    publishBrokerAvailableEvent();
  }
  headers.setSessionId(this.sessionId);
  message=MessageBuilder.withPayloadAndHeaders(message.getPayload(),headers).build();
  sendMessageToClient(message);
}
