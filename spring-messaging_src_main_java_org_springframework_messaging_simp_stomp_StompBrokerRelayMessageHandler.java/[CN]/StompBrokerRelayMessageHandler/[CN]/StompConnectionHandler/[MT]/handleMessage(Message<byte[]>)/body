{
  StompHeaderAccessor headerAccessor=MessageHeaderAccessor.getAccessor(message,StompHeaderAccessor.class);
  headerAccessor.setSessionId(this.sessionId);
  if (StompCommand.CONNECTED.equals(headerAccessor.getCommand())) {
    if (logger.isInfoEnabled()) {
      logger.info("Received STOMP CONNECTED: " + headerAccessor);
    }
    afterStompConnected(headerAccessor);
  }
 else   if (StompCommand.ERROR.equals(headerAccessor.getCommand()) && logger.isErrorEnabled()) {
    logger.error("Received STOMP ERROR: " + message);
  }
 else   if (logger.isTraceEnabled()) {
    logger.trace(headerAccessor.isHeartbeat() ? "Received heartbeat in session " + this.sessionId : "Received " + headerAccessor);
  }
  headerAccessor.setImmutable();
  sendMessageToClient(message);
}
