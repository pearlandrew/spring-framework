{
  publishBrokerUnavailableEvent();
  this.clientInboundChannel.unsubscribe(this);
  this.brokerChannel.unsubscribe(this);
  try {
    this.tcpClient.shutdown().get(5000,TimeUnit.MILLISECONDS);
  }
 catch (  Throwable t) {
    logger.error("Error in shutdown of TCP client",t);
  }
}
