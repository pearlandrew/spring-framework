{
  this.clientInboundChannel.unsubscribe(this);
  this.brokerChannel.unsubscribe(this);
  for (  StompConnectionHandler handler : this.connectionHandlers.values()) {
    try {
      handler.resetTcpConnection();
    }
 catch (    Throwable t) {
      logger.error("Failed to close STOMP connection " + t.getMessage());
    }
  }
  try {
    this.tcpClient.shutdown();
  }
 catch (  Throwable t) {
    logger.error("Error while shutting down TCP client",t);
  }
}
