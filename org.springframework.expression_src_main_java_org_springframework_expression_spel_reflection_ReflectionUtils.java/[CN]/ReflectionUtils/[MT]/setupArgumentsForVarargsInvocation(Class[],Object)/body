{
  int nParams=parameterTypes.length;
  int nArgs=arguments.length;
  if (nParams != arguments.length || parameterTypes[nParams - 1] != (arguments[nArgs - 1] == null ? null : arguments[nArgs - 1].getClass())) {
    int arraySize=0;
    if (arguments != null && nArgs >= nParams) {
      arraySize=nArgs - (nParams - 1);
    }
    Object[] repackagedArguments=(Object[])Array.newInstance(parameterTypes[nParams - 1].getComponentType(),arraySize);
    for (int i=0; i < arraySize; i++) {
      repackagedArguments[i]=arguments[nParams + i - 1];
    }
    Object[] newArgs=new Object[nParams];
    for (int i=0; i < newArgs.length - 1; i++) {
      newArgs[i]=arguments[i];
    }
    newArgs[newArgs.length - 1]=repackagedArguments;
    return newArgs;
  }
  return arguments;
}
