{
  StompHeaderAccessor headers=StompHeaderAccessor.wrap(message);
  headers.setStompCommandIfNotSet(command);
  String sessionId=headers.getSessionId();
  if (sessionId == null) {
    if (StompCommand.SEND.equals(command)) {
      sessionId=STOMP_RELAY_SYSTEM_SESSION_ID;
    }
 else {
      logger.error("No sessionId in message " + message);
      return;
    }
  }
  RelaySession session=this.relaySessions.get(sessionId);
  if (session == null) {
    logger.warn("Session id=" + sessionId + " not found. Message cannot be forwarded: "+ message);
    return;
  }
  session.forward(message,headers);
}
