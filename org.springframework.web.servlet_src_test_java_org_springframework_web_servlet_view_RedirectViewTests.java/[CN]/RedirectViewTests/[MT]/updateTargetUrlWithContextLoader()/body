{
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  wac.registerSingleton("requestDataValueProcessor",RequestDataValueProcessorWrapper.class);
  MockServletContext servletContext=new MockServletContext();
  ContextLoader contextLoader=new ContextLoader(wac);
  contextLoader.initWebApplicationContext(servletContext);
  try {
    RequestDataValueProcessor mockProcessor=createMock(RequestDataValueProcessor.class);
    wac.getBean(RequestDataValueProcessorWrapper.class).setRequestDataValueProcessor(mockProcessor);
    RedirectView rv=new RedirectView();
    rv.setUrl("/path");
    HttpServletRequest request=new MockHttpServletRequest();
    HttpServletResponse response=new MockHttpServletResponse();
    EasyMock.expect(mockProcessor.processUrl(request,"/path")).andReturn("/path?key=123");
    EasyMock.replay(mockProcessor);
    rv.render(new ModelMap(),request,response);
    EasyMock.verify(mockProcessor);
  }
  finally {
    contextLoader.closeWebApplicationContext(servletContext);
  }
}
