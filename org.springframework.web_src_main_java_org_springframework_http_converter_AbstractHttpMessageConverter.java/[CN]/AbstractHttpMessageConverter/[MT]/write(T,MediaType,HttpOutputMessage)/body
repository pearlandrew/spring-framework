{
  HttpHeaders headers=outputMessage.getHeaders();
  if (contentType == null || contentType.isWildcardType() || contentType.isWildcardSubtype()) {
    contentType=getDefaultContentType(t);
  }
  if (contentType != null) {
    headers.setContentType(contentType);
  }
  Long contentLength=getContentLength(t,contentType);
  if (contentLength != null) {
    headers.setContentLength(contentLength);
  }
  writeInternal(t,outputMessage);
  outputMessage.getBody().flush();
}
