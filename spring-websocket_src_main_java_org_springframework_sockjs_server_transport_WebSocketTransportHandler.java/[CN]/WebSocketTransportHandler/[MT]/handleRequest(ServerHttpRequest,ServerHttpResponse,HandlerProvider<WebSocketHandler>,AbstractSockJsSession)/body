{
  try {
    WebSocketHandler sockJsWrapper=new SockJsWebSocketHandler(this.sockJsConfig,handler);
    this.handshakeHandler.doHandshake(request,response,new SimpleHandlerProvider<WebSocketHandler>(sockJsWrapper));
  }
 catch (  Throwable t) {
    throw new TransportErrorException("Failed to start handshake request",t,session.getId());
  }
}
