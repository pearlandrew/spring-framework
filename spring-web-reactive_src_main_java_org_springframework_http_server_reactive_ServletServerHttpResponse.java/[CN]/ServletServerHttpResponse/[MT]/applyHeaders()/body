{
  if (!this.headersWritten) {
    for (    Map.Entry<String,List<String>> entry : this.headers.entrySet()) {
      String headerName=entry.getKey();
      for (      String headerValue : entry.getValue()) {
        this.response.addHeader(headerName,headerValue);
      }
    }
    MediaType contentType=this.headers.getContentType();
    if (this.response.getContentType() == null && contentType != null) {
      this.response.setContentType(contentType.toString());
    }
    Charset charset=(contentType != null ? contentType.getCharSet() : null);
    if (this.response.getCharacterEncoding() == null && charset != null) {
      this.response.setCharacterEncoding(charset.name());
    }
    this.headersWritten=true;
  }
}
