{
  MockServerHttpRequest request=new MockServerHttpRequest(HttpMethod.GET,"http://localhost");
  MockServerHttpResponse response=new MockServerHttpResponse();
  ServerWebExchange exchange=new DefaultServerWebExchange(request,response,new MockWebSessionManager());
  exchange.getAttributes().put(Router.HTTP_MESSAGE_WRITERS_ATTRIBUTE,Collections.singleton(new EncoderHttpMessageWriter<CharSequence>(new CharSequenceEncoder())).stream());
  publisherResponse.writeTo(exchange).block();
  assertNotNull(response.getBody());
}
