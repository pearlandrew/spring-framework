{
  FreeMarkerView fv=new FreeMarkerView();
  MockControl wmc=MockControl.createControl(WebApplicationContext.class);
  WebApplicationContext wac=(WebApplicationContext)wmc.getMock();
  wac.getBeansOfType(FreeMarkerConfig.class,true,false);
  wmc.setReturnValue(new HashMap());
  wac.getParentBeanFactory();
  wmc.setReturnValue(null);
  wac.getServletContext();
  wmc.setReturnValue(new MockServletContext());
  wmc.replay();
  fv.setUrl("anythingButNull");
  try {
    fv.setApplicationContext(wac);
    fv.afterPropertiesSet();
    fail("Should have thrown BeanDefinitionStoreException");
  }
 catch (  ApplicationContextException ex) {
    assertTrue(ex.getMessage().indexOf("FreeMarkerConfig") != -1);
  }
  wmc.verify();
}
