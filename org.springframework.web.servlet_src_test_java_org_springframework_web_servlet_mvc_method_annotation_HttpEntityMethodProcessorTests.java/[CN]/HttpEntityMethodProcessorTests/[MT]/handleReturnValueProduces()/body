{
  String body="Foo";
  ResponseEntity<String> returnValue=new ResponseEntity<String>(body,HttpStatus.OK);
  servletRequest.addHeader("Accept","text/*");
  servletRequest.setAttribute(PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE,Collections.singleton(MediaType.TEXT_HTML));
  expect(messageConverter.canWrite(String.class,MediaType.TEXT_HTML)).andReturn(true);
  messageConverter.write(eq(body),eq(MediaType.TEXT_HTML),isA(HttpOutputMessage.class));
  replay(messageConverter);
  processor.handleReturnValue(returnValue,returnTypeResponseEntityProduces,mavContainer,webRequest);
  assertTrue(mavContainer.isRequestHandled());
  verify(messageConverter);
}
