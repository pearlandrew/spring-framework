{
@Configuration class Config {
    public @Bean String name(){
      return "foo";
    }
  }
  DefaultListableBeanFactory factory=new DefaultListableBeanFactory();
  factory.registerBeanDefinition("config1",rootBeanDefinition(Config.class).getBeanDefinition());
  ConfigurationPostProcessor cpp=new ConfigurationPostProcessor();
  ConfigurationPostProcessor.CGLIB_TEST_CLASS=BOGUS_CGLIB_TEST_CLASS;
  try {
    cpp.postProcessBeanFactory(factory);
  }
 catch (  RuntimeException ex) {
    assertTrue(ex.getMessage().contains("CGLIB is required to process @Configuration classes"));
  }
 finally {
    ConfigurationPostProcessor.CGLIB_TEST_CLASS=ORIG_CGLIB_TEST_CLASS;
  }
}
