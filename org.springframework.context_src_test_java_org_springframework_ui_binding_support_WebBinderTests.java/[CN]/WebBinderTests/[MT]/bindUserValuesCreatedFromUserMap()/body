{
  Binder<TestBean> binder=new WebBinder<TestBean>(new TestBean());
  binder.add(new CurrencyAnnotationFormatterFactory());
  binder.add(new BindingConfiguration("date",new DateFormatter()));
  Map<String,String> userMap=new LinkedHashMap<String,String>();
  userMap.put("string","test");
  userMap.put("_integer","doesn't matter");
  userMap.put("_bool","doesn't matter");
  userMap.put("!date","2009-06-10");
  userMap.put("!currency","$5.00");
  userMap.put("_currency","doesn't matter");
  userMap.put("_addresses","doesn't matter");
  List<UserValue> values=binder.createUserValues(userMap);
  List<BindingResult> results=binder.bind(values);
  assertEquals(6,results.size());
  assertEquals("test",results.get(0).getUserValue());
  assertEquals(null,results.get(1).getUserValue());
  assertEquals(Boolean.FALSE,results.get(2).getUserValue());
  assertEquals("2009-06-10",results.get(3).getUserValue());
  assertEquals("$5.00",results.get(4).getUserValue());
  assertEquals(null,results.get(5).getUserValue());
  assertEquals("test",binder.getModel().getString());
  assertEquals(0,binder.getModel().getInteger());
  assertEquals(new DateFormatter().parse("2009-06-10",Locale.US),binder.getModel().getDate());
  assertEquals(false,binder.getModel().isBool());
  assertEquals(new BigDecimal("5.00"),binder.getModel().getCurrency());
  assertEquals(null,binder.getModel().getAddresses());
}
