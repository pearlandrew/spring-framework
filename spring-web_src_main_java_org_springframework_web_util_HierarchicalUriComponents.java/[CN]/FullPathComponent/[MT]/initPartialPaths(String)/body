{
  List<PartialPath> result=new ArrayList<PartialPath>();
  int startIdx;
  int endIdx=0;
  while ((startIdx=path.indexOf("{/",endIdx)) != -1) {
    if (startIdx > endIdx) {
      String prevPart=path.substring(endIdx,startIdx);
      result.add(new PartialPath(prevPart,Type.PATH));
    }
    endIdx=path.indexOf('}',startIdx + 2) + 1;
    if (endIdx == -1) {
      throw new IllegalArgumentException("Path \"" + path + "\" has no "+ "closing \"}\" after \"{/\" at index "+ startIdx);
    }
    String part=path.substring(startIdx,endIdx);
    result.add(new PartialPath(part,Type.PATH_SEGMENT));
  }
  if (endIdx < path.length()) {
    String endPart=path.substring(endIdx);
    result.add(new PartialPath(endPart,Type.PATH));
  }
  return result;
}
