{
  if (this.encoded) {
    return this;
  }
  Assert.hasLength(encoding,"Encoding must not be empty");
  String schemeTo=encodeUriComponent(getScheme(),encoding,Type.SCHEME);
  String userInfoTo=encodeUriComponent(this.userInfo,encoding,Type.USER_INFO);
  String hostTo=encodeUriComponent(this.host,encoding,getHostType());
  PathComponent pathTo=this.path.encode(encoding);
  MultiValueMap<String,String> paramsTo=encodeQueryParams(encoding);
  String fragmentTo=encodeUriComponent(this.getFragment(),encoding,Type.FRAGMENT);
  return new HierarchicalUriComponents(schemeTo,userInfoTo,hostTo,this.port,pathTo,paramsTo,fragmentTo,true,false);
}
