{
  try {
    List<MimeMessage> mimeMessages=new ArrayList<MimeMessage>(mimeMessagePreparators.length);
    for (    MimeMessagePreparator preparator : mimeMessagePreparators) {
      MimeMessage mimeMessage=createMimeMessage();
      preparator.prepare(mimeMessage);
      mimeMessages.add(mimeMessage);
    }
    send(mimeMessages.toArray(new MimeMessage[mimeMessages.size()]));
  }
 catch (  MailException ex) {
    throw ex;
  }
catch (  MessagingException ex) {
    throw new MailParseException(ex);
  }
catch (  IOException ex) {
    throw new MailPreparationException(ex);
  }
catch (  Exception ex) {
    throw new MailPreparationException(ex);
  }
}
