{
  if (logger.isTraceEnabled()) {
    logger.trace("Trying to resolve XML entity with public ID [" + publicId + "] and system ID ["+ systemId+ "]");
  }
  if (systemId != null && systemId.endsWith(DTD_EXTENSION)) {
    int lastPathSeparator=systemId.lastIndexOf("/");
    int dtdNameStart=systemId.indexOf(DTD_NAME);
    if (dtdNameStart > lastPathSeparator) {
      String dtdFile=DTD_FILENAME + DTD_EXTENSION;
      if (logger.isTraceEnabled()) {
        logger.trace("Trying to locate [" + dtdFile + "] in Spring jar on classpath");
      }
      try {
        Resource resource=new ClassPathResource(dtdFile,getClass());
        InputSource source=new InputSource(resource.getInputStream());
        source.setPublicId(publicId);
        source.setSystemId(systemId);
        if (logger.isDebugEnabled()) {
          logger.debug("Found beans DTD [" + systemId + "] in classpath: "+ dtdFile);
        }
        return source;
      }
 catch (      IOException ex) {
        if (logger.isDebugEnabled()) {
          logger.debug("Could not resolve beans DTD [" + systemId + "]: not found in classpath",ex);
        }
      }
    }
  }
  return null;
}
