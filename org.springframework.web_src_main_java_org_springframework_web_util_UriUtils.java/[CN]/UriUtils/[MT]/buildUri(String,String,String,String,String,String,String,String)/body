{
  StringBuilder uriBuilder=new StringBuilder();
  if (scheme != null) {
    uriBuilder.append(scheme);
    uriBuilder.append(':');
  }
  if (userinfo != null || host != null || port != null) {
    uriBuilder.append("//");
    if (userinfo != null) {
      uriBuilder.append(userinfo);
      uriBuilder.append('@');
    }
    if (host != null) {
      uriBuilder.append(host);
    }
    if (port != null) {
      uriBuilder.append(':');
      uriBuilder.append(port);
    }
  }
 else   if (authority != null) {
    uriBuilder.append("//");
    uriBuilder.append(authority);
  }
  if (path != null) {
    uriBuilder.append(path);
  }
  if (query != null) {
    uriBuilder.append('?');
    uriBuilder.append(query);
  }
  if (fragment != null) {
    uriBuilder.append('#');
    uriBuilder.append(fragment);
  }
  return uriBuilder.toString();
}
