{
  RuntimeBeanReference contentNegotiationManagerRef;
  if (element.hasAttribute("content-negotiation-manager")) {
    String name=element.getAttribute("content-negotiation-manager");
    contentNegotiationManagerRef=new RuntimeBeanReference(name);
    if (!CONTENT_NEGOTIATION_MANAGER_BEAN_NAME.equals(name)) {
      parserContext.getRegistry().registerAlias(name,CONTENT_NEGOTIATION_MANAGER_BEAN_NAME);
    }
  }
 else {
    RootBeanDefinition factoryBeanDef=new RootBeanDefinition(ContentNegotiationManagerFactoryBean.class);
    factoryBeanDef.setSource(source);
    factoryBeanDef.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);
    factoryBeanDef.getPropertyValues().add("mediaTypes",getDefaultMediaTypes());
    String name=CONTENT_NEGOTIATION_MANAGER_BEAN_NAME;
    parserContext.getReaderContext().getRegistry().registerBeanDefinition(name,factoryBeanDef);
    parserContext.registerComponent(new BeanComponentDefinition(factoryBeanDef,name));
    contentNegotiationManagerRef=new RuntimeBeanReference(name);
  }
  return contentNegotiationManagerRef;
}
