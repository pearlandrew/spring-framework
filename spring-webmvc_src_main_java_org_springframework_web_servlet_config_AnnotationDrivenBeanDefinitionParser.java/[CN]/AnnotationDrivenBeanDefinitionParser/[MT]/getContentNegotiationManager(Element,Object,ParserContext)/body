{
  RuntimeBeanReference contentNegotiationManagerRef;
  if (element.hasAttribute("content-negotiation-manager")) {
    contentNegotiationManagerRef=new RuntimeBeanReference(element.getAttribute("content-negotiation-manager"));
  }
 else {
    RootBeanDefinition factoryBeanDef=new RootBeanDefinition(ContentNegotiationManagerFactoryBean.class);
    factoryBeanDef.setSource(source);
    factoryBeanDef.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);
    factoryBeanDef.getPropertyValues().add("mediaTypes",getDefaultMediaTypes());
    String beanName="mvcContentNegotiationManager";
    parserContext.getReaderContext().getRegistry().registerBeanDefinition(beanName,factoryBeanDef);
    parserContext.registerComponent(new BeanComponentDefinition(factoryBeanDef,beanName));
    contentNegotiationManagerRef=new RuntimeBeanReference(beanName);
  }
  return contentNegotiationManagerRef;
}
