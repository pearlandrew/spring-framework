{
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  wac.addMessage("test",Locale.getDefault(),"testmessage");
  final ServletContext servletContext=new MockServletContext();
  wac.setServletContext(servletContext);
  wac.refresh();
  servletContext.setAttribute(ContextLoaderPlugIn.SERVLET_CONTEXT_PREFIX,wac);
  ActionServlet actionServlet=new ActionServlet(){
    @Override public ServletContext getServletContext(){
      return servletContext;
    }
  }
;
  DispatchActionSupport action=new DispatchActionSupport(){
  }
;
  action.setServlet(actionServlet);
  assertEquals(wac,action.getWebApplicationContext());
  assertEquals(servletContext,action.getServletContext());
  assertEquals("testmessage",action.getMessageSourceAccessor().getMessage("test"));
  action.setServlet(null);
}
