{
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  wac.addMessage("test",Locale.getDefault(),"testmessage");
  final ServletContext servletContext=new MockServletContext();
  wac.setServletContext(servletContext);
  wac.refresh();
  servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE,wac);
  ActionServlet actionServlet=new ActionServlet(){
    @Override public ServletContext getServletContext(){
      return servletContext;
    }
  }
;
  LookupDispatchActionSupport action=new LookupDispatchActionSupport(){
    @Override protected Map getKeyMethodMap(){
      return new HashMap();
    }
  }
;
  action.setServlet(actionServlet);
  assertEquals(wac,action.getWebApplicationContext());
  assertEquals(servletContext,action.getServletContext());
  assertEquals("testmessage",action.getMessageSourceAccessor().getMessage("test"));
  action.setServlet(null);
}
