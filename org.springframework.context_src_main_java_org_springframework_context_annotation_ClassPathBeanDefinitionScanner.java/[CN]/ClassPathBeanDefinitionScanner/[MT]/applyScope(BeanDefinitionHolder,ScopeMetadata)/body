{
  String scope=scopeMetadata.getScopeName();
  ScopedProxyMode scopedProxyMode=scopeMetadata.getScopedProxyMode();
  definitionHolder.getBeanDefinition().setScope(scope);
  if (scopedProxyMode.equals(ScopedProxyMode.NO)) {
    return definitionHolder;
  }
  boolean proxyTargetClass=scopedProxyMode.equals(ScopedProxyMode.TARGET_CLASS);
  return ScopedProxyCreator.createScopedProxy(definitionHolder,this.registry,proxyTargetClass);
}
