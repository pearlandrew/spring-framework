{
  MockPortletSession session=new MockPortletSession();
  final PortletRequest request=createMock(PortletRequest.class);
  expect(request.getPortletSession(false)).andReturn(session);
  replay(request);
  try {
    PortletUtils.getRequiredSessionAttribute(request,"foo");
    fail("expected IllegalStateException");
  }
 catch (  IllegalStateException ex) {
  }
  verify(request);
}
