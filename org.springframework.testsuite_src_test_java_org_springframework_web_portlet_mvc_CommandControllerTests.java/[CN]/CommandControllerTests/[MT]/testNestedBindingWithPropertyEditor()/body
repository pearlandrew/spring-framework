{
  TestController tc=new TestController(){
    protected void initBinder(    PortletRequest request,    PortletRequestDataBinder binder){
      binder.registerCustomEditor(ITestBean.class,new PropertyEditorSupport(){
        public void setAsText(        String text) throws IllegalArgumentException {
          setValue(new TestBean(text));
        }
      }
);
    }
  }
;
  MockRenderRequest request=new MockRenderRequest();
  MockRenderResponse response=new MockRenderResponse();
  String name="test";
  String spouseName="testSpouse";
  int age=30;
  int spouseAge=31;
  request.addParameter("name",name);
  request.addParameter("age","" + age);
  request.addParameter("spouse",spouseName);
  request.addParameter("spouse.age","" + spouseAge);
  ModelAndView mav=tc.handleRenderRequest(request,response);
  TestBean command=(TestBean)mav.getModel().get(tc.getCommandName());
  assertEquals(name,command.getName());
  assertEquals(age,command.getAge());
  assertNotNull(command.getSpouse());
  assertEquals(spouseName,command.getSpouse().getName());
  assertEquals(spouseAge,command.getSpouse().getAge());
  BindException errors=(BindException)mav.getModel().get(ERRORS_KEY);
  assertEquals("There should be no errors",0,errors.getErrorCount());
}
