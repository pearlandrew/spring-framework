{
  Properties props=new Properties();
  props.setProperty("bogusKey","bogusValue");
  MockJavaMailSender sender=new MockJavaMailSender(){
    protected Transport getTransport(    Session sess) throws NoSuchProviderException {
      assertEquals("bogusValue",sess.getProperty("bogusKey"));
      return super.getTransport(sess);
    }
  }
;
  sender.setJavaMailProperties(props);
  sender.setHost("host");
  sender.setUsername("username");
  sender.setPassword("password");
  MimeMessage mimeMessage=sender.createMimeMessage();
  mimeMessage.setRecipient(Message.RecipientType.TO,new InternetAddress("you@mail.org"));
  sender.send(mimeMessage);
  assertEquals(sender.transport.getConnectedHost(),"host");
  assertEquals(sender.transport.getConnectedUsername(),"username");
  assertEquals(sender.transport.getConnectedPassword(),"password");
  assertTrue(sender.transport.isCloseCalled());
  assertEquals(1,sender.transport.getSentMessages().size());
  assertEquals(mimeMessage,sender.transport.getSentMessage(0));
}
