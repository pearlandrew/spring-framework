{
  assumeFalse(server instanceof ReactorHttpServer);
  RestTemplate restTemplate=new RestTemplate();
  byte[] body=randomBytes();
  RequestEntity<byte[]> request=RequestEntity.post(new URI("http://localhost:" + port)).body(body);
  ResponseEntity<byte[]> response=restTemplate.exchange(request,byte[].class);
  assertNotNull(response.getBody());
  assertEquals(RESPONSE_SIZE,response.getHeaders().getContentLength());
  assertEquals(RESPONSE_SIZE,response.getBody().length);
  while (!handler.requestComplete) {
    Thread.sleep(100);
  }
  if (handler.requestError != null) {
    throw handler.requestError;
  }
  assertEquals(REQUEST_SIZE,handler.requestSize);
}
