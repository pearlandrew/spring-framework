{
  Assert.state(SimpMessageType.MESSAGE.equals(getMessageType()),"Unexpected message type " + getMessage());
  if (getCommand() == null) {
    setHeader(COMMAND_HEADER,StompCommand.SEND);
  }
 else   if (!getCommand().equals(StompCommand.SEND)) {
    throw new IllegalStateException("Unexpected STOMP command " + getCommand());
  }
  return getCommand();
}
