{
  if (!collectionType.isInterface()) {
    try {
      return collectionType.newInstance();
    }
 catch (    Exception ex) {
      throw new IllegalArgumentException("Could not instantiate collection class [" + collectionType.getName() + "]: "+ ex.getMessage());
    }
  }
 else   if (List.class.equals(collectionType)) {
    return new ArrayList<Object>(initialCapacity);
  }
 else   if (SortedSet.class.equals(collectionType)) {
    return new TreeSet<Object>();
  }
 else {
    return new LinkedHashSet<Object>(initialCapacity);
  }
}
