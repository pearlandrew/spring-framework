{
  this.session.initWebSocketSession(this.webSocketSession);
  assertEquals("Open frame not sent",Collections.singletonList(new TextMessage("o")),this.webSocketSession.getSentMessages());
  assertEquals(Arrays.asList("schedule"),this.session.heartbeatSchedulingEvents);
  verify(this.webSocketHandler).afterConnectionEstablished(this.session);
  verifyNoMoreInteractions(this.taskScheduler,this.webSocketHandler);
}
