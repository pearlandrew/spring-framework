{
  Collection collection=(Collection)source;
  Object array=Array.newInstance(targetClass.getComponentType(),collection.size());
  int i=0;
  for (Iterator it=collection.iterator(); it.hasNext(); i++) {
    Object value=it.next();
    if (value != null) {
      ConversionExecutor converter;
      if (elementConverter != null) {
        converter=elementConverter;
      }
 else {
        converter=conversionService.getConversionExecutor(value.getClass(),targetClass.getComponentType());
      }
      value=converter.execute(value);
    }
    Array.set(array,i,value);
  }
  return array;
}
