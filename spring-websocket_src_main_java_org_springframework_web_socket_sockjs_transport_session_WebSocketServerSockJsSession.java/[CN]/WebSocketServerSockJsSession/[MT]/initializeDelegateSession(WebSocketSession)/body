{
  this.webSocketSession=session;
  try {
    TextMessage message=new TextMessage(SockJsFrame.openFrame().getContent());
    this.webSocketSession.sendMessage(message);
    scheduleHeartbeat();
    delegateConnectionEstablished();
  }
 catch (  Exception ex) {
    tryCloseWithSockJsTransportError(ex,CloseStatus.SERVER_ERROR);
  }
}
