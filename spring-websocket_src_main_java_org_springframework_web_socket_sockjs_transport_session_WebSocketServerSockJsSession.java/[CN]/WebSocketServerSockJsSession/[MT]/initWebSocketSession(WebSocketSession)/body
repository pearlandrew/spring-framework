{
  this.webSocketSession=session;
  try {
    TextMessage message=new TextMessage(SockJsFrame.openFrame().getContent());
    this.webSocketSession.sendMessage(message);
  }
 catch (  IOException ex) {
    tryCloseWithSockJsTransportError(ex,CloseStatus.SERVER_ERROR);
    return;
  }
  scheduleHeartbeat();
  delegateConnectionEstablished();
}
