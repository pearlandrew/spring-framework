{
  final String helperTool="wrongType";
  VelocityView vv=new VelocityView(){
    @Override protected void mergeTemplate(    Template template,    Context context,    HttpServletResponse response){
      fail();
    }
  }
;
  vv.setUrl(TEMPLATE_FILE);
  vv.setApplicationContext(wac);
  vv.setExposeSpringMacroHelpers(true);
  Map<String,Object> model=new HashMap<String,Object>();
  model.put(VelocityView.SPRING_MACRO_REQUEST_CONTEXT_ATTRIBUTE,helperTool);
  try {
    vv.render(model,request,response);
  }
 catch (  Exception ex) {
    assertTrue(ex instanceof ServletException);
    assertTrue(ex.getMessage().contains(VelocityView.SPRING_MACRO_REQUEST_CONTEXT_ATTRIBUTE));
  }
}
