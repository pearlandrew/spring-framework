{
  given(manager.getTransaction()).willReturn(tx);
  tt.execute(new TransactionCallback(){
    @Override public Object doInTransaction(    TransactionStatus status){
      bean.sharedEntityManagerUnsynchronized.joinTransaction();
      bean.sharedEntityManagerUnsynchronized.flush();
      return null;
    }
  }
);
  verify(tx).commit();
  verify(manager).flush();
  verify(manager,times(2)).close();
}
