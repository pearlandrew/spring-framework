{
  String urlFile=jarUrl.getFile();
  int startIndex=(urlFile.startsWith(JAR_URL_PREFIX) ? JAR_URL_PREFIX.length() : 0);
  int endIndex=urlFile.indexOf(JAR_URL_SEPARATOR);
  if (endIndex != -1) {
    String jarFile=urlFile.substring(startIndex,endIndex);
    try {
      return new URL(jarFile);
    }
 catch (    MalformedURLException ex) {
      if (!jarFile.startsWith("/")) {
        jarFile="/" + jarFile;
      }
      return new URL(FILE_URL_PREFIX + jarFile);
    }
  }
 else {
    return jarUrl;
  }
}
