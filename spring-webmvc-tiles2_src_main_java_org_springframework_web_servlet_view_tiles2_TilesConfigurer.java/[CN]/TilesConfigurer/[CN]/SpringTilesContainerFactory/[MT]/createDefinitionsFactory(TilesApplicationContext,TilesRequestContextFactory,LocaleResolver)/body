{
  if (definitionsFactoryClass != null) {
    DefinitionsFactory factory=BeanUtils.instantiate(definitionsFactoryClass);
    if (factory instanceof TilesApplicationContextAware) {
      ((TilesApplicationContextAware)factory).setApplicationContext(applicationContext);
    }
    BeanWrapper bw=PropertyAccessorFactory.forBeanPropertyAccess(factory);
    if (bw.isWritableProperty("localeResolver")) {
      bw.setPropertyValue("localeResolver",resolver);
    }
    if (bw.isWritableProperty("definitionDAO")) {
      bw.setPropertyValue("definitionDAO",createLocaleDefinitionDao(applicationContext,contextFactory,resolver));
    }
    if (factory instanceof Refreshable) {
      ((Refreshable)factory).refresh();
    }
    return factory;
  }
 else {
    return super.createDefinitionsFactory(applicationContext,contextFactory,resolver);
  }
}
