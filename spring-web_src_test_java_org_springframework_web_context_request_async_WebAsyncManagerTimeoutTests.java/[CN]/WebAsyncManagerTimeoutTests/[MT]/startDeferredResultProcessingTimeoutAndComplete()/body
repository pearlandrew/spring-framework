{
  DeferredResult<Integer> deferredResult=new DeferredResult<Integer>();
  DeferredResultProcessingInterceptor interceptor=createStrictMock(DeferredResultProcessingInterceptor.class);
  interceptor.preProcess(this.asyncWebRequest,deferredResult);
  expect(interceptor.handleTimeout(this.asyncWebRequest,deferredResult)).andReturn(true);
  interceptor.afterCompletion(this.asyncWebRequest,deferredResult);
  replay(interceptor);
  this.asyncManager.registerDeferredResultInterceptor("interceptor",interceptor);
  this.asyncManager.startDeferredResultProcessing(deferredResult);
  this.asyncWebRequest.onTimeout(ASYNC_EVENT);
  this.asyncWebRequest.onComplete(ASYNC_EVENT);
  assertFalse(this.asyncManager.hasConcurrentResult());
  assertEquals(DispatcherType.REQUEST,this.servletRequest.getDispatcherType());
  assertEquals(503,this.servletResponse.getStatus());
  verify(interceptor);
}
