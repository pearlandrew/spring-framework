{
  HashMap model=new HashMap();
  Object obj=new Integer(1);
  model.put("foo","bar");
  model.put("I",obj);
  String url="forward-to";
  MockControl reqControl=MockControl.createControl(HttpServletRequest.class);
  HttpServletRequest request=(HttpServletRequest)reqControl.getMock();
  Set keys=model.keySet();
  for (Iterator iter=keys.iterator(); iter.hasNext(); ) {
    String key=(String)iter.next();
    request.setAttribute(key,model.get(key));
    reqControl.setVoidCallable(1);
  }
  request.getRequestDispatcher(url);
  reqControl.setReturnValue(new MockRequestDispatcher(url));
  reqControl.replay();
  MockHttpServletResponse response=new MockHttpServletResponse();
  InternalResourceView v=new InternalResourceView();
  v.setUrl(url);
  v.setAlwaysInclude(true);
  v.render(model,request,response);
  assertEquals(url,response.getIncludedUrl());
  reqControl.verify();
}
