{
  List<SpringPersistenceUnitInfo> infos=new LinkedList<SpringPersistenceUnitInfo>();
  boolean buildDefaultUnit=(this.packagesToScan != null || this.mappingResources != null);
  PersistenceUnitReader reader=new PersistenceUnitReader(this.resourcePatternResolver,this.dataSourceLookup);
  SpringPersistenceUnitInfo[] readInfos=reader.readPersistenceUnitInfos(this.persistenceXmlLocations);
  for (  SpringPersistenceUnitInfo readInfo : readInfos) {
    infos.add(readInfo);
    if (this.defaultPersistenceUnitName != null && this.defaultPersistenceUnitName.equals(readInfo.getPersistenceUnitName())) {
      buildDefaultUnit=false;
    }
  }
  if (buildDefaultUnit) {
    infos.add(buildDefaultPersistenceUnitInfo());
  }
  return infos;
}
