{
  EntityManagerFactory emf=getEntityManagerFactory();
  if (emf == null && getEntityManager() == null) {
    throw new IllegalArgumentException("entityManagerFactory or entityManager is required");
  }
  if (emf instanceof EntityManagerFactoryInfo) {
    JpaDialect jpaDialect=((EntityManagerFactoryInfo)emf).getJpaDialect();
    if (jpaDialect != null) {
      setJpaDialect(jpaDialect);
    }
  }
}
