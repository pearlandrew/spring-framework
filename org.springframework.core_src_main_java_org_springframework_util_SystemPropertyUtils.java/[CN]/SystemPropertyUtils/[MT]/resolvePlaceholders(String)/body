{
  StringBuffer buf=new StringBuffer(text);
  int startIndex=buf.indexOf(PLACEHOLDER_PREFIX);
  while (startIndex != -1) {
    int endIndex=buf.indexOf(PLACEHOLDER_SUFFIX,startIndex + PLACEHOLDER_PREFIX.length());
    if (endIndex != -1) {
      String placeholder=buf.substring(startIndex + PLACEHOLDER_PREFIX.length(),endIndex);
      int nextIndex=endIndex + PLACEHOLDER_SUFFIX.length();
      try {
        String propVal=System.getProperty(placeholder);
        if (propVal == null) {
          propVal=System.getenv(placeholder);
        }
        if (propVal != null) {
          buf.replace(startIndex,endIndex + PLACEHOLDER_SUFFIX.length(),propVal);
          nextIndex=startIndex + propVal.length();
        }
 else {
          System.err.println("Could not resolve placeholder '" + placeholder + "' in ["+ text+ "] as system property: neither system property nor environment variable found");
        }
      }
 catch (      Throwable ex) {
        System.err.println("Could not resolve placeholder '" + placeholder + "' in ["+ text+ "] as system property: "+ ex);
      }
      startIndex=buf.indexOf(PLACEHOLDER_PREFIX,nextIndex);
    }
 else {
      startIndex=-1;
    }
  }
  return buf.toString();
}
