{
  PageContext ctx=new CountingMockPageContext();
  CountingMockExpressionEvaluator eval=(CountingMockExpressionEvaluator)ctx.getExpressionEvaluator();
  ctx.setAttribute("bla","blie");
  ctx.setAttribute("blo","blue");
  String expr="text${bla}text${blo}text";
  Object o=ExpressionEvaluationUtils.evaluate("test",expr,String.class,ctx);
  assertEquals("textblietextbluetext",o);
  assertEquals(2,eval.evaluateCount);
  expr="${bla}text${blo}text";
  o=ExpressionEvaluationUtils.evaluate("test",expr,String.class,ctx);
  assertEquals("blietextbluetext",o);
  assertEquals(4,eval.evaluateCount);
  expr="${bla}text${blo}";
  o=ExpressionEvaluationUtils.evaluate("test",expr,String.class,ctx);
  assertEquals("blietextblue",o);
  assertEquals(6,eval.evaluateCount);
  expr="${bla}text${blo}";
  o=ExpressionEvaluationUtils.evaluate("test",expr,Object.class,ctx);
  assertEquals("blietextblue",o);
  assertEquals(8,eval.evaluateCount);
}
