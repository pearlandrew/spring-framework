{
  if (cancelled) {
    return;
  }
  logger.trace("Updating demand " + demand + " by "+ n);
  demand.increase(n);
  logger.trace("Stalled: " + stalled);
  if (stalled) {
    stalled=false;
    try {
      onDataAvailable();
    }
 catch (    IOException ex) {
      onError(ex);
    }
  }
}
