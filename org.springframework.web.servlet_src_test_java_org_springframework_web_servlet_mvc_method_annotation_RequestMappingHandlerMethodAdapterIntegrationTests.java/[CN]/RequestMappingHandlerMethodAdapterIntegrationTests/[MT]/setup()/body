{
  ConfigurableWebBindingInitializer bindingInitializer=new ConfigurableWebBindingInitializer();
  bindingInitializer.setValidator(new StubValidator());
  List<HandlerMethodArgumentResolver> customResolvers=new ArrayList<HandlerMethodArgumentResolver>();
  customResolvers.add(new ServletWebArgumentResolverAdapter(new ColorArgumentResolver()));
  this.handlerAdapter=new RequestMappingHandlerMethodAdapter();
  this.handlerAdapter.setWebBindingInitializer(bindingInitializer);
  this.handlerAdapter.setCustomArgumentResolvers(customResolvers);
  GenericWebApplicationContext context=new GenericWebApplicationContext();
  context.refresh();
  this.handlerAdapter.setApplicationContext(context);
  this.handlerAdapter.setBeanFactory(context.getBeanFactory());
  this.handlerAdapter.afterPropertiesSet();
  this.request=new MockHttpServletRequest();
  this.response=new MockHttpServletResponse();
  RequestContextHolder.setRequestAttributes(new ServletWebRequest(request));
}
