{
  ConfigurableWebBindingInitializer bindingInitializer=new ConfigurableWebBindingInitializer();
  bindingInitializer.setValidator(new StubValidator());
  List<HandlerMethodArgumentResolver> customResolvers=new ArrayList<HandlerMethodArgumentResolver>();
  customResolvers.add(new ServletWebArgumentResolverAdapter(new ColorArgumentResolver()));
  GenericWebApplicationContext context=new GenericWebApplicationContext();
  context.refresh();
  handlerAdapter=new RequestMappingHandlerMethodAdapter();
  handlerAdapter.setWebBindingInitializer(bindingInitializer);
  handlerAdapter.setCustomArgumentResolvers(customResolvers);
  handlerAdapter.setApplicationContext(context);
  handlerAdapter.setBeanFactory(context.getBeanFactory());
  handlerAdapter.afterPropertiesSet();
  request=new MockHttpServletRequest();
  response=new MockHttpServletResponse();
  RequestContextHolder.setRequestAttributes(new ServletWebRequest(request));
}
