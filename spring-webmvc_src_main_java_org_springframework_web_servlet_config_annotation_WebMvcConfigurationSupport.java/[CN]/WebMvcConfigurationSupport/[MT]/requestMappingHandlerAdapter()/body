{
  RequestMappingHandlerAdapter adapter=createRequestMappingHandlerAdapter();
  adapter.setContentNegotiationManager(mvcContentNegotiationManager());
  adapter.setMessageConverters(getMessageConverters());
  adapter.setWebBindingInitializer(getConfigurableWebBindingInitializer());
  adapter.setCustomArgumentResolvers(getArgumentResolvers());
  adapter.setCustomReturnValueHandlers(getReturnValueHandlers());
  if (jackson2Present) {
    List<RequestBodyAdvice> requestBodyAdvices=new ArrayList<RequestBodyAdvice>();
    requestBodyAdvices.add(new JsonViewRequestBodyAdvice());
    adapter.setRequestBodyAdvice(requestBodyAdvices);
    List<ResponseBodyAdvice<?>> responseBodyAdvices=new ArrayList<ResponseBodyAdvice<?>>();
    responseBodyAdvices.add(new JsonViewResponseBodyAdvice());
    adapter.setResponseBodyAdvice(responseBodyAdvices);
  }
  AsyncSupportConfigurer configurer=new AsyncSupportConfigurer();
  configureAsyncSupport(configurer);
  if (configurer.getTaskExecutor() != null) {
    adapter.setTaskExecutor(configurer.getTaskExecutor());
  }
  if (configurer.getTimeout() != null) {
    adapter.setAsyncRequestTimeout(configurer.getTimeout());
  }
  adapter.setCallableInterceptors(configurer.getCallableInterceptors());
  adapter.setDeferredResultInterceptors(configurer.getDeferredResultInterceptors());
  return adapter;
}
