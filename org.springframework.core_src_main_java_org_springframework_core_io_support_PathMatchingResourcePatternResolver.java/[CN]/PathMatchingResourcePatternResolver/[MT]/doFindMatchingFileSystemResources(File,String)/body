{
  if (logger.isDebugEnabled()) {
    logger.debug("Looking for matching resources in directory tree [" + rootDir.getPath() + "]");
  }
  Set matchingFiles=retrieveMatchingFiles(rootDir,subPattern);
  Set result=new LinkedHashSet(matchingFiles.size());
  for (Iterator it=matchingFiles.iterator(); it.hasNext(); ) {
    File file=(File)it.next();
    result.add(new FileSystemResource(file));
  }
  return result;
}
