{
  if (index >= collection.size()) {
    if (growCollection) {
      growCollection(collectionEntryTypeDescriptor,index,collection);
    }
 else {
      throw new SpelEvaluationException(getStartPosition(),SpelMessage.COLLECTION_INDEX_OUT_OF_BOUNDS,collection.size(),index);
    }
  }
  int pos=0;
  for (  Object o : collection) {
    if (pos == index) {
      return new TypedValue(o,collectionEntryTypeDescriptor.elementTypeDescriptor(o));
    }
    pos++;
  }
  throw new IllegalStateException();
}
