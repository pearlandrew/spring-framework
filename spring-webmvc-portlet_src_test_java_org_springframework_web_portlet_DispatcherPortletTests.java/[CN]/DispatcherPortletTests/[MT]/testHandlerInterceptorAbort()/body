{
  MockRenderRequest request=new MockRenderRequest();
  MockRenderResponse response=new MockRenderResponse();
  request.setPortletMode(PortletMode.VIEW);
  request.addUserRole("role1");
  request.addParameter("abort","true");
  complexDispatcherPortlet.doDispatch(request,response);
  assertTrue(request.getAttribute("test1-remove-never") != null);
  assertTrue(request.getAttribute("test1-remove-post") != null);
  assertTrue(request.getAttribute("test1-remove-after") == null);
  assertTrue(request.getAttribute("test2-remove-never") == null);
  assertTrue(request.getAttribute("test2-remove-post") == null);
  assertTrue(request.getAttribute("test2-remove-after") == null);
}
