{
  MockRenderRequest request=new MockRenderRequest();
  MockRenderResponse response=new MockRenderResponse();
  request.setPortletMode(PortletMode.VIEW);
  request.addUserRole("role2");
  request.setParameter("action","not mapped");
  request.setParameter("myParam","not mapped");
  complexDispatcherPortlet.doDispatch(request,response);
  Map<?,?> model=(Map<?,?>)request.getAttribute(ViewRendererServlet.MODEL_ATTRIBUTE);
  assertEquals("view was here",model.get("result"));
  InternalResourceView view=(InternalResourceView)request.getAttribute(ViewRendererServlet.VIEW_ATTRIBUTE);
  assertEquals("someViewName",view.getBeanName());
}
