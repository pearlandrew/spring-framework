{
  this.request.setMethod(HttpMethod.OPTIONS.name());
  this.request.addHeader(HttpHeaders.ORIGIN,"http://domain2.com/test.html");
  this.request.addHeader(CorsUtils.ACCESS_CONTROL_REQUEST_HEADERS,"Header1, Header2");
  this.request.addHeader(CorsUtils.ACCESS_CONTROL_REQUEST_METHOD,"GET");
  this.conf.addAllowedHeader("*");
  this.conf.addAllowedOrigin("http://domain2.com/test.html");
  this.processor.processPreFlightRequest(this.conf,request,response);
  assertTrue(response.containsHeader(CorsUtils.ACCESS_CONTROL_ALLOW_ORIGIN));
  assertTrue(response.containsHeader(CorsUtils.ACCESS_CONTROL_ALLOW_HEADERS));
  assertTrue(response.getHeader(CorsUtils.ACCESS_CONTROL_ALLOW_HEADERS).contains("Header1"));
  assertTrue(response.getHeader(CorsUtils.ACCESS_CONTROL_ALLOW_HEADERS).contains("Header2"));
  assertFalse(response.getHeader(CorsUtils.ACCESS_CONTROL_ALLOW_HEADERS).contains("*"));
  assertEquals(HttpServletResponse.SC_OK,response.getStatus());
}
