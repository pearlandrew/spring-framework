{
  if (!TransactionSynchronizationManager.isSynchronizationActive()) {
    throw new IllegalStateException("Spring transaction synchronization needs to be active for " + "setting values in iBATIS TypeHandlers that delegate to a Spring LobHandler");
  }
  final LobCreator lobCreator=this.lobHandler.getLobCreator();
  try {
    setParameterInternal(ps,i,parameter,jdbcType,lobCreator);
  }
 catch (  IOException ex) {
    throw new SQLException("I/O errors during LOB access: " + ex.getMessage());
  }
  TransactionSynchronizationManager.registerSynchronization(new LobCreatorSynchronization(lobCreator));
}
