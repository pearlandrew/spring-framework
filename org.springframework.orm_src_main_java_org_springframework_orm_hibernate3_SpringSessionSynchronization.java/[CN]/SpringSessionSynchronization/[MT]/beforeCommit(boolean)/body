{
  if (!readOnly) {
    Session session=getCurrentSession();
    if (!session.getFlushMode().lessThan(FlushMode.COMMIT)) {
      try {
        SessionFactoryUtils.logger.debug("Flushing Hibernate Session on transaction synchronization");
        session.flush();
      }
 catch (      HibernateException ex) {
        if (this.jdbcExceptionTranslator != null && ex instanceof JDBCException) {
          JDBCException jdbcEx=(JDBCException)ex;
          throw this.jdbcExceptionTranslator.translate("Hibernate flushing: " + jdbcEx.getMessage(),jdbcEx.getSQL(),jdbcEx.getSQLException());
        }
        throw SessionFactoryUtils.convertHibernateAccessException(ex);
      }
    }
  }
}
