{
  NumberFormat format=NumberFormat.getInstance(locale);
  if (pattern != null) {
    if (format instanceof DecimalFormat) {
      ((DecimalFormat)format).applyPattern(pattern);
    }
 else {
      logger.warn("Unable to apply format pattern '" + pattern + "'; Returned NumberFormat is not a DecimalFormat");
    }
  }
  if (parseBigDecimal != null) {
    if (format instanceof DecimalFormat) {
      ((DecimalFormat)format).setParseBigDecimal(parseBigDecimal);
    }
 else {
      logger.warn("Unable to call setParseBigDecimal; not a DecimalFormat");
    }
  }
  return format;
}
