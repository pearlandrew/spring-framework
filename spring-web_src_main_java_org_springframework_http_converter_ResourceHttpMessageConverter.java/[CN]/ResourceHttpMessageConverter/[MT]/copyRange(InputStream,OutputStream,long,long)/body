{
  long skipped=in.skip(start);
  if (skipped < start) {
    throw new IOException("Skipped only " + skipped + " bytes out of "+ start+ " required.");
  }
  long bytesToCopy=end - start + 1;
  byte buffer[]=new byte[StreamUtils.BUFFER_SIZE];
  while (bytesToCopy > 0) {
    int bytesRead=in.read(buffer);
    if (bytesRead <= bytesToCopy) {
      out.write(buffer,0,bytesRead);
      bytesToCopy-=bytesRead;
    }
 else {
      out.write(buffer,0,(int)bytesToCopy);
      bytesToCopy=0;
    }
    if (bytesRead == -1) {
      break;
    }
  }
}
