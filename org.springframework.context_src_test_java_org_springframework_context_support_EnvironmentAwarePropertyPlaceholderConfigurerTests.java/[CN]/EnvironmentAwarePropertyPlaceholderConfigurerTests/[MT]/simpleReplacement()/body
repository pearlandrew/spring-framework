{
  DefaultListableBeanFactory bf=new DefaultListableBeanFactory();
  bf.registerBeanDefinition("testBean",genericBeanDefinition(TestBean.class).addPropertyValue("name","${my.name}").getBeanDefinition());
  MockEnvironment env=new MockEnvironment();
  env.setProperty("my.name","myValue");
  EnvironmentAwarePropertyPlaceholderConfigurer ppc=new EnvironmentAwarePropertyPlaceholderConfigurer();
  ppc.setEnvironment(env);
  ppc.postProcessBeanFactory(bf);
  assertThat(bf.getBean(TestBean.class).getName(),equalTo("myValue"));
}
