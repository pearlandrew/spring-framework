{
  Servlet servlet=createMock(Servlet.class);
  MockFilterChain chain=new MockFilterChain(servlet);
  servlet.service(this.request,this.response);
  replay(servlet);
  chain.doFilter(this.request,this.response);
  verify(servlet);
  try {
    chain.doFilter(this.request,this.response);
    fail("Expected Exception");
  }
 catch (  IllegalStateException ex) {
    assertEquals("This FilterChain has already been called!",ex.getMessage());
  }
}
