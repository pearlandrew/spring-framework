{
  if (visited.add(element)) {
    for (    Annotation annotation : element.getAnnotations()) {
      if (annotation.annotationType().getName().equals(annotationType) || depth > 0) {
        T result=processor.process(annotation,depth);
        if (result != null) {
          return result;
        }
        result=doProcess(annotation.annotationType(),annotationType,processor,visited,depth + 1);
        if (result != null) {
          processor.postProcess(annotation,result);
          return result;
        }
      }
    }
    for (    Annotation annotation : element.getAnnotations()) {
      T result=doProcess(annotation.annotationType(),annotationType,processor,visited,depth);
      if (result != null) {
        processor.postProcess(annotation,result);
        return result;
      }
    }
  }
  return null;
}
