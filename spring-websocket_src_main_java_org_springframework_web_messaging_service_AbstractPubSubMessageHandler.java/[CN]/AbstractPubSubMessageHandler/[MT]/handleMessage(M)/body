{
  PubSubHeaders headers=PubSubHeaders.fromMessageHeaders(message.getHeaders());
  MessageType messageType=headers.getMessageType();
  if (!canHandle(message,messageType)) {
    return;
  }
  if (MessageType.MESSAGE.equals(messageType)) {
    handlePublish(message);
  }
 else   if (MessageType.SUBSCRIBE.equals(messageType)) {
    handleSubscribe(message);
  }
 else   if (MessageType.UNSUBSCRIBE.equals(messageType)) {
    handleUnsubscribe(message);
  }
 else   if (MessageType.CONNECT.equals(messageType)) {
    handleConnect(message);
  }
 else   if (MessageType.DISCONNECT.equals(messageType)) {
    handleDisconnect(message);
  }
 else {
    handleOther(message);
  }
}
