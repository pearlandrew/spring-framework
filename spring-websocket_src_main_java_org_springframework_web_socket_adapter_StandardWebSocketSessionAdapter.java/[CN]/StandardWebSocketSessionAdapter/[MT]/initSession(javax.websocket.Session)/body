{
  Assert.notNull(session,"session must not be null");
  this.session=session;
  if (this.protocol == null) {
    if (StringUtils.hasText(session.getNegotiatedSubprotocol())) {
      this.protocol=session.getNegotiatedSubprotocol();
    }
  }
}
