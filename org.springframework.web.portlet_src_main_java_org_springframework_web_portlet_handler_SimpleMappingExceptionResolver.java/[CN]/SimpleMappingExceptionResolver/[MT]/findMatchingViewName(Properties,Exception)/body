{
  String viewName=null;
  String dominantMapping=null;
  int deepest=Integer.MAX_VALUE;
  for (Enumeration names=exceptionMappings.propertyNames(); names.hasMoreElements(); ) {
    String exceptionMapping=(String)names.nextElement();
    int depth=getDepth(exceptionMapping,ex);
    if (depth >= 0 && depth < deepest) {
      deepest=depth;
      dominantMapping=exceptionMapping;
      viewName=exceptionMappings.getProperty(exceptionMapping);
    }
  }
  if (viewName != null && logger.isDebugEnabled()) {
    logger.debug("Resolving to view '" + viewName + "' for exception of type ["+ ex.getClass().getName()+ "], based on exception mapping ["+ dominantMapping+ "]");
  }
  return viewName;
}
