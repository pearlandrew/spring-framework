{
  this.request=request;
  this.response=response;
  this.model=model;
  this.webApplicationContext=(WebApplicationContext)request.getAttribute(WEB_APPLICATION_CONTEXT_ATTRIBUTE);
  if (this.webApplicationContext == null) {
    this.webApplicationContext=RequestContextUtils.getWebApplicationContext(request,servletContext);
  }
  LocaleResolver localeResolver=RequestContextUtils.getLocaleResolver(request);
  if (localeResolver != null) {
    this.locale=localeResolver.resolveLocale(request);
  }
 else {
    this.locale=getFallbackLocale();
  }
  this.defaultHtmlEscape=WebUtils.getDefaultHtmlEscape(this.webApplicationContext.getServletContext());
  this.urlPathHelper=new UrlPathHelper();
  try {
    this.requestDataValueProcessor=this.webApplicationContext.getBean(REQUEST_DATA_VALUE_PROCESSOR_BEAN_NAME,RequestDataValueProcessor.class);
  }
 catch (  NoSuchBeanDefinitionException ex) {
  }
}
