{
  if (request instanceof ServletServerHttpRequest) {
    ServletServerHttpRequest servletRequest=(ServletServerHttpRequest)request;
    HttpSession session=servletRequest.getServletRequest().getSession(false);
    if (session != null) {
      Enumeration<String> names=session.getAttributeNames();
      while (names.hasMoreElements()) {
        String name=names.nextElement();
        if (CollectionUtils.isEmpty(this.attributeNames) || this.attributeNames.contains(name)) {
          if (logger.isTraceEnabled()) {
            logger.trace("Adding HTTP session attribute to handshake attributes: " + name);
          }
          attributes.put(name,session.getAttribute(name));
        }
 else {
          if (logger.isTraceEnabled()) {
            logger.trace("Skipped HTTP session attribute");
          }
        }
      }
    }
  }
  return true;
}
