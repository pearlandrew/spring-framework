{
  RequestContext rc=new RequestContext(request,getServletContext());
  Locale locale=rc.getLocale();
  if (!model.containsKey(JRParameter.REPORT_LOCALE)) {
    model.put(JRParameter.REPORT_LOCALE,locale);
  }
  TimeZone timeZone=rc.getTimeZone();
  if (timeZone != null && !model.containsKey(JRParameter.REPORT_TIME_ZONE)) {
    model.put(JRParameter.REPORT_TIME_ZONE,timeZone);
  }
  JasperReport report=getReport();
  if ((report == null || report.getResourceBundle() == null) && !model.containsKey(JRParameter.REPORT_RESOURCE_BUNDLE)) {
    model.put(JRParameter.REPORT_RESOURCE_BUNDLE,new MessageSourceResourceBundle(rc.getMessageSource(),locale));
  }
}
