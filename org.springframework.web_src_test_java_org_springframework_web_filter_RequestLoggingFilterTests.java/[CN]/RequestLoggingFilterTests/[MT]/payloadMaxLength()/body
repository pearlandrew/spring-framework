{
  filter.setIncludePayload(true);
  filter.setMaxPayloadLength(3);
  final MockHttpServletRequest request=new MockHttpServletRequest("POST","/hotels");
  MockHttpServletResponse response=new MockHttpServletResponse();
  final byte[] requestBody="Hello World".getBytes("UTF-8");
  request.setContent(requestBody);
  FilterChain filterChain=new FilterChain(){
    public void doFilter(    ServletRequest filterRequest,    ServletResponse filterResponse) throws IOException, ServletException {
      ((HttpServletResponse)filterResponse).setStatus(HttpServletResponse.SC_OK);
      byte[] buf=FileCopyUtils.copyToByteArray(filterRequest.getInputStream());
      assertArrayEquals(requestBody,buf);
    }
  }
;
  filter.doFilter(request,response,filterChain);
  assertNotNull(filter.afterRequestMessage);
  assertTrue(filter.afterRequestMessage.indexOf("Hel") != -1);
  assertFalse(filter.afterRequestMessage.indexOf("Hello World") != -1);
}
