{
  WebMvcStompEndpointRegistry registry=new WebMvcStompEndpointRegistry(subProtocolWebSocketHandler(),getTransportRegistration(),userSessionRegistry(),messageBrokerSockJsTaskScheduler());
  registry.setApplicationContext(getApplicationContext());
  registerStompEndpoints(registry);
  return registry.getHandlerMapping();
}
