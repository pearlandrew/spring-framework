{
  ScriptSource script=EasyMock.createMock(ScriptSource.class);
  final String badScript="class Foo { protected Foo() {}}";
  EasyMock.expect(script.getScriptAsString()).andReturn(badScript);
  EasyMock.expect(script.suggestedClassName()).andReturn("someName");
  EasyMock.replay(script);
  GroovyScriptFactory factory=new GroovyScriptFactory(ScriptFactoryPostProcessor.INLINE_SCRIPT_PREFIX + badScript);
  try {
    factory.getScriptedObject(script,new Class[]{});
    fail("Must have thrown a ScriptCompilationException (no oublic no-arg ctor in scripted class).");
  }
 catch (  ScriptCompilationException expected) {
    assertTrue(expected.contains(IllegalAccessException.class));
  }
  EasyMock.verify(script);
}
