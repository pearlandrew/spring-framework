{
  this.messagingTemplate.convertAndSendToUser("http://joe.openid.example.org/","/queue/foo","data");
  List<Message<byte[]>> messages=this.messageChannel.getMessages();
  assertEquals(1,messages.size());
  Message<byte[]> message=messages.get(0);
  SimpMessageHeaderAccessor headers=SimpMessageHeaderAccessor.wrap(message);
  assertEquals("/user/http:%2F%2Fjoe.openid.example.org%2F/queue/foo",headers.getDestination());
}
