{
  Map<String,Object> headers=new HashMap<>();
  headers.put("key","value");
  headers.put(NativeMessageHeaderAccessor.NATIVE_HEADERS,new LinkedMultiValueMap<String,String>());
  this.messagingTemplate.convertAndSend("/foo","data",headers);
  List<Message<byte[]>> messages=this.messageChannel.getMessages();
  Message<byte[]> message=messages.get(0);
  SimpMessageHeaderAccessor resultHeaders=SimpMessageHeaderAccessor.wrap(message);
  assertEquals("value",resultHeaders.toMap().get("key"));
  assertNull(resultHeaders.getNativeHeader("key"));
}
