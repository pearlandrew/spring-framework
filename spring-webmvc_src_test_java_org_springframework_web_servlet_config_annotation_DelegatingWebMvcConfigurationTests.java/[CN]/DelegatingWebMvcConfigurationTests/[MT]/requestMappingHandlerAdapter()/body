{
  Capture<List<HttpMessageConverter<?>>> converters=new Capture<List<HttpMessageConverter<?>>>();
  Capture<ContentNegotiationConfigurer> contentNegotiationConfigurer=new Capture<ContentNegotiationConfigurer>();
  Capture<FormattingConversionService> conversionService=new Capture<FormattingConversionService>();
  Capture<List<HandlerMethodArgumentResolver>> resolvers=new Capture<List<HandlerMethodArgumentResolver>>();
  Capture<List<HandlerMethodReturnValueHandler>> handlers=new Capture<List<HandlerMethodReturnValueHandler>>();
  configurer.configureMessageConverters(capture(converters));
  configurer.configureContentNegotiation(capture(contentNegotiationConfigurer));
  expect(configurer.getValidator()).andReturn(null);
  expect(configurer.getMessageCodesResolver()).andReturn(null);
  configurer.addFormatters(capture(conversionService));
  configurer.addArgumentResolvers(capture(resolvers));
  configurer.addReturnValueHandlers(capture(handlers));
  replay(configurer);
  mvcConfiguration.setConfigurers(Arrays.asList(configurer));
  RequestMappingHandlerAdapter adapter=mvcConfiguration.requestMappingHandlerAdapter();
  ConfigurableWebBindingInitializer initializer=(ConfigurableWebBindingInitializer)adapter.getWebBindingInitializer();
  assertSame(conversionService.getValue(),initializer.getConversionService());
  assertTrue(initializer.getValidator() instanceof LocalValidatorFactoryBean);
  assertEquals(0,resolvers.getValue().size());
  assertEquals(0,handlers.getValue().size());
  assertEquals(converters.getValue(),adapter.getMessageConverters());
  verify(configurer);
}
