{
  if (requestHeaders == null) {
    return null;
  }
  if (requestHeaders.isEmpty()) {
    return Collections.emptyList();
  }
  List<String> allowedHeaders=this.allowedHeaders == null ? new ArrayList<String>() : this.allowedHeaders;
  boolean allowAnyHeader=allowedHeaders.contains("*");
  List<String> result=new ArrayList<String>();
  for (  String requestHeader : requestHeaders) {
    requestHeader=requestHeader.trim();
    for (    String allowedHeader : allowedHeaders) {
      if (allowAnyHeader || requestHeader.equalsIgnoreCase(allowedHeader)) {
        result.add(requestHeader);
        break;
      }
    }
  }
  return result.isEmpty() ? null : result;
}
