{
  ShallowEtagResponseWrapper responseWrapper=new ShallowEtagResponseWrapper(response);
  AsyncExecutionChain chain=AsyncExecutionChain.getForCurrentRequest(request);
  chain.addDelegatingCallable(getAsyncCallable(request,response,responseWrapper));
  filterChain.doFilter(request,responseWrapper);
  if (chain.isAsyncStarted()) {
    return;
  }
  updateResponse(request,response,responseWrapper);
}
