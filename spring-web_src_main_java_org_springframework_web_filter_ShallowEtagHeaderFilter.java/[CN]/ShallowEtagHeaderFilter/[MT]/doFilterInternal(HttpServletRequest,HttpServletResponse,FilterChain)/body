{
  ShallowEtagResponseWrapper responseWrapper=new ShallowEtagResponseWrapper(response);
  AsyncExecutionChain chain=AsyncExecutionChain.getForCurrentRequest(request);
  chain.push(getAsyncCallable(request,response,responseWrapper));
  filterChain.doFilter(request,responseWrapper);
  if (!chain.pop()) {
    return;
  }
  updateResponse(request,response,responseWrapper);
}
