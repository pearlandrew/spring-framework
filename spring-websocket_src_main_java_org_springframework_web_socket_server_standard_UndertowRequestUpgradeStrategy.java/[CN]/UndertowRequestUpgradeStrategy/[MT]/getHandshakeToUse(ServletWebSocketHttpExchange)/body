{
  for (  Handshake handshake : this.handshakes) {
    if (handshake.matches(exchange)) {
      return handshake;
    }
  }
  throw new HandshakeFailureException("No matching Undertow Handshake found: " + exchange.getRequestHeaders());
}
