{
  VelocityConfig vc=new VelocityConfig(){
    public VelocityEngine getVelocityEngine(){
      TestVelocityEngine ve=new TestVelocityEngine();
      ve.addTemplate("prefix_test_suffix",new Template());
      ve.addTemplate(VelocityLayoutView.DEFAULT_LAYOUT_URL,new Template());
      return ve;
    }
  }
;
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  wac.getBeanFactory().registerSingleton("configurer",vc);
  String toolbox="org/springframework/web/servlet/view/velocity/toolbox.xml";
  VelocityViewResolver vr=new VelocityViewResolver();
  vr.setViewClass(VelocityLayoutView.class);
  vr.setPrefix("prefix_");
  vr.setSuffix("_suffix");
  vr.setToolboxConfigLocation(toolbox);
  vr.setApplicationContext(wac);
  View view=vr.resolveViewName("test",Locale.CANADA);
  assertEquals("Correct view class",VelocityLayoutView.class,view.getClass());
  assertEquals("Correct URL","prefix_test_suffix",((VelocityView)view).getUrl());
  assertEquals("Correct toolbox",toolbox,((VelocityToolboxView)view).getToolboxConfigLocation());
}
