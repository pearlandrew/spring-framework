{
  if (getFlushMode() == FLUSH_NEVER) {
    if (existingTransaction) {
      FlushMode previousFlushMode=session.getFlushMode();
      if (!previousFlushMode.lessThan(FlushMode.COMMIT)) {
        session.setFlushMode(FlushMode.NEVER);
        return previousFlushMode;
      }
    }
 else {
      session.setFlushMode(FlushMode.NEVER);
    }
  }
 else   if (getFlushMode() == FLUSH_EAGER) {
    if (existingTransaction) {
      FlushMode previousFlushMode=session.getFlushMode();
      if (!previousFlushMode.equals(FlushMode.AUTO)) {
        session.setFlushMode(FlushMode.AUTO);
        return previousFlushMode;
      }
    }
 else {
    }
  }
 else   if (getFlushMode() == FLUSH_COMMIT) {
    if (existingTransaction) {
      FlushMode previousFlushMode=session.getFlushMode();
      if (previousFlushMode.equals(FlushMode.AUTO) || previousFlushMode.equals(FlushMode.ALWAYS)) {
        session.setFlushMode(FlushMode.COMMIT);
        return previousFlushMode;
      }
    }
 else {
      session.setFlushMode(FlushMode.COMMIT);
    }
  }
 else   if (getFlushMode() == FLUSH_ALWAYS) {
    if (existingTransaction) {
      FlushMode previousFlushMode=session.getFlushMode();
      if (!previousFlushMode.equals(FlushMode.ALWAYS)) {
        session.setFlushMode(FlushMode.ALWAYS);
        return previousFlushMode;
      }
    }
 else {
      session.setFlushMode(FlushMode.ALWAYS);
    }
  }
  return null;
}
