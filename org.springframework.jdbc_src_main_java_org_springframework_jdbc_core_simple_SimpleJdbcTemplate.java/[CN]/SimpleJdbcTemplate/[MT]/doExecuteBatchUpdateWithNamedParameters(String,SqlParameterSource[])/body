{
  if (batchArgs.length <= 0) {
    return new int[]{0};
  }
  final ParsedSql parsedSql=NamedParameterUtils.parseSqlStatement(sql);
  String sqlToUse=NamedParameterUtils.substituteNamedParameters(parsedSql,batchArgs[0]);
  return getJdbcOperations().batchUpdate(sqlToUse,new BatchPreparedStatementSetter(){
    public void setValues(    PreparedStatement ps,    int i) throws SQLException {
      Object[] values=NamedParameterUtils.buildValueArray(parsedSql,batchArgs[i],null);
      int[] columnTypes=NamedParameterUtils.buildSqlTypeArray(parsedSql,batchArgs[i]);
      doSetStatementParameters(values,ps,columnTypes);
    }
    public int getBatchSize(){
      return batchArgs.length;
    }
  }
);
}
