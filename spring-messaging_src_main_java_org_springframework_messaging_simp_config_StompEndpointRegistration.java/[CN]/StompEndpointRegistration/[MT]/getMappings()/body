{
  MultiValueMap<HttpRequestHandler,String> mappings=new LinkedMultiValueMap<HttpRequestHandler,String>();
  if (this.sockJsServiceRegistration == null) {
    HandshakeHandler handshakeHandler=getOrCreateHandshakeHandler();
    for (    String path : this.paths) {
      WebSocketHttpRequestHandler handler=new WebSocketHttpRequestHandler(this.wsHandler,handshakeHandler);
      mappings.add(handler,path);
    }
  }
 else {
    SockJsService sockJsService=this.sockJsServiceRegistration.getSockJsService();
    for (    String path : this.paths) {
      SockJsHttpRequestHandler httpHandler=new SockJsHttpRequestHandler(sockJsService,this.wsHandler);
      mappings.add(httpHandler,path.endsWith("/") ? path + "**" : path + "/**");
    }
  }
  return mappings;
}
