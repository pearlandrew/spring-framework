{
  MultiValueMap<HttpRequestHandler,String> mappings=new LinkedMultiValueMap<HttpRequestHandler,String>();
  if (getSockJsServiceRegistration() == null) {
    HandshakeHandler handshakeHandler=createHandshakeHandler();
    for (    String path : getPaths()) {
      WebSocketHttpRequestHandler handler=new WebSocketHttpRequestHandler(this.wsHandler,handshakeHandler);
      mappings.add(handler,path);
    }
  }
 else {
    SockJsService sockJsService=getSockJsServiceRegistration().getSockJsService();
    for (    String path : this.paths) {
      SockJsHttpRequestHandler httpHandler=new SockJsHttpRequestHandler(sockJsService,this.wsHandler);
      mappings.add(httpHandler,path.endsWith("/") ? path + "**" : path + "/**");
    }
  }
  return mappings;
}
