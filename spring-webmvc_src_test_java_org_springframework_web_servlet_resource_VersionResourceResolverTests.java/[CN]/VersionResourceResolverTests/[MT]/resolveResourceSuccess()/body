{
  String versionFile="bar-version.css";
  String version="version";
  String file="bar.css";
  Resource expected=new ClassPathResource("test/" + file,getClass());
  when(this.chain.resolveResource(null,versionFile,this.locations)).thenReturn(null);
  when(this.chain.resolveResource(null,file,this.locations)).thenReturn(expected);
  when(this.versionStrategy.extractVersion(versionFile)).thenReturn(version);
  when(this.versionStrategy.removeVersion(versionFile,version)).thenReturn(file);
  when(this.versionStrategy.getResourceVersion(expected)).thenReturn(version);
  this.resolver.setStrategyMap(Collections.singletonMap("/**",this.versionStrategy));
  Resource actual=this.resolver.resolveResourceInternal(null,versionFile,this.locations,this.chain);
  assertEquals(expected,actual);
  verify(this.versionStrategy,times(1)).getResourceVersion(expected);
}
