{
  Session nativeSession=Mockito.mock(Session.class);
  when(nativeSession.getId()).thenReturn("1");
  when(nativeSession.getUserPrincipal()).thenReturn(new org.springframework.web.socket.handler.TestPrincipal("test"));
  when(nativeSession.getNegotiatedSubprotocol()).thenReturn("v12.sToMp");
  StandardWebSocketSession standardWebsocketSession=new StandardWebSocketSession(null,null,null,null);
  standardWebsocketSession.initializeNativeSession(nativeSession);
  this.protocolHandler.afterSessionStarted(standardWebsocketSession,this.channel);
  standardWebsocketSession.close(CloseStatus.NORMAL);
  this.protocolHandler.afterSessionEnded(standardWebsocketSession,CloseStatus.NORMAL,this.channel);
  assertEquals("v12.sToMp",standardWebsocketSession.getAcceptedProtocol());
  assertNotNull(standardWebsocketSession.getPrincipal());
}
