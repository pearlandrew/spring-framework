{
  WebApplicationContext wac=createMock(WebApplicationContext.class);
  wac.getServletContext();
  expectLastCall().andReturn(new MockServletContext());
  replay(wac);
  HttpServletRequest request=new MockHttpServletRequest();
  HttpServletResponse response=new MockHttpServletResponse();
  TestView tv=new TestView(wac);
  tv.setApplicationContext(wac);
  tv.setApplicationContext(wac);
  Map<String,Object> model=new HashMap<String,Object>();
  model.put("foo","bar");
  model.put("something",new Object());
  tv.render(model,request,response);
  checkContainsAll(model,tv.model);
  assertTrue(tv.inited);
  verify(wac);
}
