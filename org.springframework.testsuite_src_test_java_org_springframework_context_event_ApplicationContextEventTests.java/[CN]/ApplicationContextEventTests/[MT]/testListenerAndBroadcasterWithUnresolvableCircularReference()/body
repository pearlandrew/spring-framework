{
  StaticApplicationContext context=new StaticApplicationContext();
  context.setDisplayName("listener context");
  context.registerBeanDefinition("broadcaster",new RootBeanDefinition(BeanThatBroadcasts.class));
  RootBeanDefinition listenerDef=new RootBeanDefinition(BeanThatListens.class);
  listenerDef.getConstructorArgumentValues().addGenericArgumentValue(new RuntimeBeanReference("broadcaster"));
  context.registerBeanDefinition("listener",listenerDef);
  try {
    context.refresh();
    fail("Should have thrown BeanCreationException with nested BeanCurrentlyInCreationException");
  }
 catch (  BeanCreationException ex) {
    assertTrue(ex.contains(BeanCurrentlyInCreationException.class));
  }
}
