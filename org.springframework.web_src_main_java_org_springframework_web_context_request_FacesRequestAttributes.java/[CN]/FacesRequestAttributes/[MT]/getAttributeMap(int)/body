{
  if (scope == SCOPE_REQUEST) {
    return getExternalContext().getRequestMap();
  }
 else   if (scope == SCOPE_GLOBAL_SESSION && portletApiPresent) {
    return PortletSessionAccessor.getGlobalSessionMapIfPossible(getExternalContext());
  }
 else {
    return getExternalContext().getSessionMap();
  }
}
