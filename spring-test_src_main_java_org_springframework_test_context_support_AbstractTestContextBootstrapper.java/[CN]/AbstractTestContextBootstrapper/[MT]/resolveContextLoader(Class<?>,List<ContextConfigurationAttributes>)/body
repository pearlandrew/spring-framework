{
  Assert.notNull(testClass,"Class must not be null");
  Assert.notEmpty(configAttributesList,"ContextConfigurationAttributes list must not be empty");
  Class<? extends ContextLoader> contextLoaderClass=resolveExplicitContextLoaderClass(configAttributesList);
  if (contextLoaderClass == null) {
    contextLoaderClass=getDefaultContextLoaderClass(testClass);
    if (contextLoaderClass == null) {
      throw new IllegalStateException("getDefaultContextLoaderClass() must not return null");
    }
  }
  if (logger.isTraceEnabled()) {
    logger.trace(String.format("Using ContextLoader class [%s] for test class [%s]",contextLoaderClass.getName(),testClass.getName()));
  }
  return BeanUtils.instantiateClass(contextLoaderClass,ContextLoader.class);
}
