{
  Map<String,MediaType> fileExtensions=Collections.singletonMap("json",MediaType.APPLICATION_JSON);
  PathExtensionContentNegotiationStrategy strategy=new PathExtensionContentNegotiationStrategy(fileExtensions);
  ContentNegotiationManager manager=new ContentNegotiationManager(strategy);
  final Set<String> extensions=new HashSet<String>();
  RequestMappingHandlerMapping hm=new RequestMappingHandlerMapping(){
    @Override protected RequestMappingInfo getMappingForMethod(    Method method,    Class<?> handlerType){
      extensions.addAll(getFileExtensions());
      return super.getMappingForMethod(method,handlerType);
    }
  }
;
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  wac.registerSingleton("testController",MetaAnnotationController.class);
  wac.refresh();
  hm.setContentNegotiationManager(manager);
  hm.setUseRegisteredSuffixPatternMatch(true);
  hm.setApplicationContext(wac);
  hm.afterPropertiesSet();
  assertEquals(Collections.singleton("json"),extensions);
}
