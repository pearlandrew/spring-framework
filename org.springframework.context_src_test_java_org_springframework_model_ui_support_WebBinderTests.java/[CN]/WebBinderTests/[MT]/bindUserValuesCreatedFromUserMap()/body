{
  GenericFormatterRegistry registry=new GenericFormatterRegistry();
  registry.add(Date.class,new DateFormatter());
  registry.add(CurrencyFormat.class,new CurrencyFormatter());
  presentationModel.setFormatterRegistry(registry);
  Map<String,String> userMap=new LinkedHashMap<String,String>();
  userMap.put("string","test");
  userMap.put("_integer","doesn't matter");
  userMap.put("_bool","doesn't matter");
  userMap.put("!date","2009-06-10");
  userMap.put("!currency","$5.00");
  userMap.put("_currency","doesn't matter");
  userMap.put("_addresses","doesn't matter");
  BindingResults results=binder.bind(userMap);
  assertEquals(6,results.size());
  assertEquals("test",results.get(0).getSubmittedValue());
  assertEquals(null,results.get(1).getSubmittedValue());
  assertEquals(Boolean.FALSE,results.get(2).getSubmittedValue());
  assertEquals("2009-06-10",results.get(3).getSubmittedValue());
  assertEquals("$5.00",results.get(4).getSubmittedValue());
  assertEquals(null,results.get(5).getSubmittedValue());
  assertEquals("test",bean.getString());
  assertEquals(0,bean.getInteger());
  assertEquals(new DateFormatter().parse("2009-06-10",Locale.US),bean.getDate());
  assertEquals(false,bean.isBool());
  assertEquals(new BigDecimal("5.00"),bean.getCurrency());
  assertEquals(null,bean.getAddresses());
}
