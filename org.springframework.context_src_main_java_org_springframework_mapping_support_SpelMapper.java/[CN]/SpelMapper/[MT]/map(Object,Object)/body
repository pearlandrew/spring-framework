{
  Assert.notNull(source,"The source to map from cannot be null");
  Assert.notNull(target,"The target to map to cannot be null");
  try {
    MappingContextHolder.push(source);
    EvaluationContext sourceContext=getEvaluationContext(source);
    EvaluationContext targetContext=getEvaluationContext(target);
    SpelMappingContext context=new SpelMappingContext(sourceContext,targetContext);
    for (    SpelMapping mapping : this.mappings) {
      if (logger.isDebugEnabled()) {
        logger.debug(MappingContextHolder.getLevel() + mapping);
      }
      mapping.map(context);
    }
    Set<FieldToFieldMapping> autoMappings=getAutoMappings(sourceContext,targetContext);
    for (    SpelMapping mapping : autoMappings) {
      if (logger.isDebugEnabled()) {
        logger.debug(MappingContextHolder.getLevel() + mapping + " (auto)");
      }
      mapping.map(context);
    }
    context.handleFailures();
    return target;
  }
  finally {
    MappingContextHolder.pop();
  }
}
