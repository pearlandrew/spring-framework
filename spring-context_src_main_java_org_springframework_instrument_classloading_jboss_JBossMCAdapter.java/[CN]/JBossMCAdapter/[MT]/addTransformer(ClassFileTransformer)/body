{
  InvocationHandler adapter=new JBossMCTranslatorAdapter(transformer);
  Object adapterInstance=Proxy.newProxyInstance(this.translatorClass.getClassLoader(),new Class[]{this.translatorClass},adapter);
  try {
    addTranslator.invoke(target,adapterInstance);
  }
 catch (  Exception ex) {
    throw new IllegalStateException("Could not add transformer on JBoss 5/6 classloader " + classLoader,ex);
  }
}
