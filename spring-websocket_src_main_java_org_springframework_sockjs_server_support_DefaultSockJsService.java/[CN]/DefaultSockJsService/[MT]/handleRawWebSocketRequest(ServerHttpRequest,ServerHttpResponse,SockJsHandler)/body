{
  if (isWebSocketEnabled()) {
    TransportHandler transportHandler=this.transportHandlers.get(TransportType.WEBSOCKET);
    if (transportHandler != null) {
      if (transportHandler instanceof HandshakeHandler) {
        WebSocketHandler webSocketHandler=this.sockJsHandlers.get(sockJsHandler);
        if (webSocketHandler == null) {
          webSocketHandler=adaptSockJsHandler(sockJsHandler);
        }
        ((HandshakeHandler)transportHandler).doHandshake(request,response,webSocketHandler);
        return;
      }
    }
    logger.warn("No handler for raw WebSocket messages");
  }
  response.setStatusCode(HttpStatus.NOT_FOUND);
}
