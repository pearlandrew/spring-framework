{
  SpringTilesApplicationContextFactory factory=new SpringTilesApplicationContextFactory();
  factory.init(this.tilesPropertyMap);
  TilesApplicationContext preliminaryContext=factory.createApplicationContext(this.servletContext);
  if (this.tilesInitializer == null) {
    this.tilesInitializer=createTilesInitializer();
  }
  this.tilesInitializer.initialize(preliminaryContext);
  if (this.overrideLocaleResolver) {
    try {
      BasicTilesContainer container=(BasicTilesContainer)ServletUtil.getContainer(this.servletContext);
      DefinitionsFactory definitionsFactory=container.getDefinitionsFactory();
      Method setter=definitionsFactory.getClass().getMethod("setLocaleResolver",LocaleResolver.class);
      setter.invoke(definitionsFactory,new SpringLocaleResolver());
    }
 catch (    Exception ex) {
      throw new IllegalStateException("Cannot override LocaleResolver with SpringLocaleResolver",ex);
    }
  }
  if (tilesElPresent && this.tilesInitializer instanceof SpringTilesInitializer) {
    BasicTilesContainer container=(BasicTilesContainer)ServletUtil.getContainer(this.servletContext);
    TilesElActivator.registerEvaluator(container);
  }
}
