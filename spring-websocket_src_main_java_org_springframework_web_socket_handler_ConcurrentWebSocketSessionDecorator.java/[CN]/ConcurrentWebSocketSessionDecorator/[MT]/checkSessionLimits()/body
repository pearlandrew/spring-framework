{
  if (this.closeLock.tryLock() && !this.sessionLimitExceeded) {
    try {
      if (getTimeSinceSendStarted() > this.sendTimeLimit) {
        sessionLimitReached("Message send time " + getTimeSinceSendStarted() + " (ms) exceeded the allowed limit "+ this.sendTimeLimit);
      }
 else       if (this.bufferSize.get() > this.bufferSizeLimit) {
        sessionLimitReached("The send buffer size " + this.bufferSize.get() + " bytes for "+ "session '"+ getId()+ " exceeded the allowed limit "+ this.bufferSizeLimit);
      }
    }
  finally {
      this.closeLock.unlock();
    }
  }
}
