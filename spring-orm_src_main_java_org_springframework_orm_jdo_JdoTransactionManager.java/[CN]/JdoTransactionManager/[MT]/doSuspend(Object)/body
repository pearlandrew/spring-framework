{
  JdoTransactionObject txObject=(JdoTransactionObject)transaction;
  txObject.setPersistenceManagerHolder(null,false);
  PersistenceManagerHolder persistenceManagerHolder=(PersistenceManagerHolder)TransactionSynchronizationManager.unbindResource(getPersistenceManagerFactory());
  txObject.setConnectionHolder(null);
  ConnectionHolder connectionHolder=null;
  if (getDataSource() != null && TransactionSynchronizationManager.hasResource(getDataSource())) {
    connectionHolder=(ConnectionHolder)TransactionSynchronizationManager.unbindResource(getDataSource());
  }
  return new SuspendedResourcesHolder(persistenceManagerHolder,connectionHolder);
}
