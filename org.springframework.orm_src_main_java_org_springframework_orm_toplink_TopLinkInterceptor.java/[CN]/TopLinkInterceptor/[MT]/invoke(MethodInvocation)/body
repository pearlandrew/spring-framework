{
  boolean existingTransaction=false;
  Session session=SessionFactoryUtils.getSession(getSessionFactory(),true);
  if (TransactionSynchronizationManager.hasResource(getSessionFactory())) {
    logger.debug("Found thread-bound Session for TopLink interceptor");
    existingTransaction=true;
  }
 else {
    logger.debug("Using new Session for TopLink interceptor");
    TransactionSynchronizationManager.bindResource(getSessionFactory(),new SessionHolder(session));
  }
  try {
    return methodInvocation.proceed();
  }
 catch (  TopLinkException ex) {
    if (this.exceptionConversionEnabled) {
      throw convertTopLinkAccessException(ex);
    }
 else {
      throw ex;
    }
  }
 finally {
    if (existingTransaction) {
      logger.debug("Not closing pre-bound TopLink Session after interceptor");
    }
 else {
      TransactionSynchronizationManager.unbindResource(getSessionFactory());
      SessionFactoryUtils.releaseSession(session,getSessionFactory());
    }
  }
}
