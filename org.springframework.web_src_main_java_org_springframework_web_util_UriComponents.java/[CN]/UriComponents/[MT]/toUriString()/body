{
  StringBuilder uriBuilder=new StringBuilder();
  if (scheme != null) {
    uriBuilder.append(scheme);
    uriBuilder.append(':');
  }
  if (userInfo != null || host != null) {
    uriBuilder.append("//");
    if (userInfo != null) {
      uriBuilder.append(userInfo);
      uriBuilder.append('@');
    }
    if (host != null) {
      uriBuilder.append(host);
    }
    if (port != -1) {
      uriBuilder.append(':');
      uriBuilder.append(port);
    }
  }
  String path=getPath();
  if (StringUtils.hasLength(path)) {
    if (uriBuilder.length() != 0 && path.charAt(0) != PATH_DELIMITER) {
      uriBuilder.append(PATH_DELIMITER);
    }
    uriBuilder.append(path);
  }
  String query=getQuery();
  if (query != null) {
    uriBuilder.append('?');
    uriBuilder.append(query);
  }
  if (fragment != null) {
    uriBuilder.append('#');
    uriBuilder.append(fragment);
  }
  return uriBuilder.toString();
}
