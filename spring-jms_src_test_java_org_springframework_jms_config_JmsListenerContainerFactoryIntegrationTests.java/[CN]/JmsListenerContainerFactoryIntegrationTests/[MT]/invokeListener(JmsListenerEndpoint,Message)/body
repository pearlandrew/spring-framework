{
  DefaultMessageListenerContainer messageListenerContainer=containerFactory.createMessageListenerContainer(endpoint);
  Object listener=messageListenerContainer.getMessageListener();
  if (listener instanceof SessionAwareMessageListener) {
    ((SessionAwareMessageListener<Message>)listener).onMessage(message,mock(Session.class));
  }
 else {
    ((MessageListener)listener).onMessage(message);
  }
}
