{
  String accept="accept-version:1.1\n";
  String host="ho\\c\\ns\\rt:st\\nomp.gi\\cthu\\b.org\n";
  String test="\n\n\nCONNECT\r\n" + accept.replaceAll("\n","\r\n") + host.replaceAll("\n","\r\n")+ "\r\n";
  @SuppressWarnings("unchecked") Message<byte[]> message=(Message<byte[]>)this.converter.toMessage(test.getBytes("UTF-8"));
  assertEquals(0,message.getPayload().length);
  StompHeaderAccessor stompHeaders=StompHeaderAccessor.wrap(message);
  assertEquals(Collections.singleton("1.1"),stompHeaders.getAcceptVersion());
  assertEquals("st\nomp.gi:thu\\b.org",stompHeaders.toNativeHeaderMap().get("ho:\ns\rt").get(0));
  String convertedBack=new String(this.converter.fromMessage(message),"UTF-8");
  assertEquals("CONNECT\n",convertedBack.substring(0,8));
  assertTrue(convertedBack.contains(accept));
  assertTrue(convertedBack.contains(host));
}
