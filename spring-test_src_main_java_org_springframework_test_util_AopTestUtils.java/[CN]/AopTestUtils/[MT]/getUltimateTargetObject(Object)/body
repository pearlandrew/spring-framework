{
  try {
    if (AopUtils.isAopProxy(candidate) && (candidate instanceof Advised)) {
      return (T)getUltimateTargetObject(((Advised)candidate).getTargetSource().getTarget());
    }
  }
 catch (  Exception e) {
    throw new IllegalStateException("Failed to unwrap proxied object.",e);
  }
  return (T)candidate;
}
