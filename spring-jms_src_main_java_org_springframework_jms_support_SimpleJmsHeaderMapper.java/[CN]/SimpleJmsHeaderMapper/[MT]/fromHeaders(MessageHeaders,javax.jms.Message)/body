{
  try {
    Object jmsCorrelationId=headers.get(JmsHeaders.CORRELATION_ID);
    if (jmsCorrelationId instanceof Number) {
      jmsCorrelationId=jmsCorrelationId.toString();
    }
    if (jmsCorrelationId instanceof String) {
      try {
        jmsMessage.setJMSCorrelationID((String)jmsCorrelationId);
      }
 catch (      Exception e) {
        logger.info("failed to set JMSCorrelationID, skipping",e);
      }
    }
    Destination jmsReplyTo=getHeaderIfAvailable(headers,JmsHeaders.REPLY_TO,Destination.class);
    if (jmsReplyTo != null) {
      try {
        jmsMessage.setJMSReplyTo(jmsReplyTo);
      }
 catch (      Exception e) {
        logger.info("failed to set JMSReplyTo, skipping",e);
      }
    }
    String jmsType=getHeaderIfAvailable(headers,JmsHeaders.TYPE,String.class);
    if (jmsType != null) {
      try {
        jmsMessage.setJMSType(jmsType);
      }
 catch (      Exception e) {
        logger.info("failed to set JMSType, skipping",e);
      }
    }
    Set<String> headerNames=headers.keySet();
    for (    String headerName : headerNames) {
      if (StringUtils.hasText(headerName) && !headerName.startsWith(JmsHeaders.PREFIX)) {
        Object value=headers.get(headerName);
        if (value != null && SUPPORTED_PROPERTY_TYPES.contains(value.getClass())) {
          try {
            String propertyName=this.fromHeaderName(headerName);
            jmsMessage.setObjectProperty(propertyName,value);
          }
 catch (          Exception e) {
            if (headerName.startsWith("JMSX")) {
              if (logger.isTraceEnabled()) {
                logger.trace("skipping reserved header, it cannot be set by client: " + headerName);
              }
            }
 else             if (logger.isWarnEnabled()) {
              logger.warn("failed to map Message header '" + headerName + "' to JMS property",e);
            }
          }
        }
      }
    }
  }
 catch (  Exception ex) {
    if (logger.isWarnEnabled()) {
      logger.warn("error occurred while mapping from MessageHeaders to JMS properties",ex);
    }
  }
}
