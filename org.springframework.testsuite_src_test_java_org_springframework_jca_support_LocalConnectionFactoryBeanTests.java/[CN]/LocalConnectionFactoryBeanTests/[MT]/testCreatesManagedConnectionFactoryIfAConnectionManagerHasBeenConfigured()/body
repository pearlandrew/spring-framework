{
  MockControl mockManagedConnectionFactory=MockControl.createControl(ManagedConnectionFactory.class);
  ManagedConnectionFactory managedConnectionFactory=(ManagedConnectionFactory)mockManagedConnectionFactory.getMock();
  MockControl mockConnectionManager=MockControl.createControl(ConnectionManager.class);
  ConnectionManager connectionManager=(ConnectionManager)mockConnectionManager.getMock();
  managedConnectionFactory.createConnectionFactory(connectionManager);
  mockManagedConnectionFactory.setReturnValue(null);
  mockConnectionManager.replay();
  mockManagedConnectionFactory.replay();
  LocalConnectionFactoryBean factory=new LocalConnectionFactoryBean();
  factory.setManagedConnectionFactory(managedConnectionFactory);
  factory.setConnectionManager(connectionManager);
  factory.afterPropertiesSet();
  mockManagedConnectionFactory.verify();
  mockConnectionManager.verify();
}
