{
  List<String> allowedOrigins=new ArrayList<>();
  MockHttpServletRequest servletRequest=new MockHttpServletRequest();
  ServerHttpRequest request=new ServletServerHttpRequest(servletRequest);
  servletRequest.setServerName("mydomain1.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain1.com");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("mydomain1.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain1.com:80");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("mydomain1.com");
  servletRequest.setServerPort(443);
  request.getHeaders().set(HttpHeaders.ORIGIN,"https://mydomain1.com");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("mydomain1.com");
  servletRequest.setServerPort(443);
  request.getHeaders().set(HttpHeaders.ORIGIN,"https://mydomain1.com:443");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("mydomain1.com");
  servletRequest.setServerPort(123);
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain1.com:123");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("mydomain1.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain2.com");
  assertFalse(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("mydomain1.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"https://mydomain1.com");
  assertFalse(WebUtils.isValidOrigin(request,allowedOrigins));
  servletRequest.setServerName("invalid-origin");
  request.getHeaders().set(HttpHeaders.ORIGIN,"invalid-origin");
  assertFalse(WebUtils.isValidOrigin(request,allowedOrigins));
  allowedOrigins=Arrays.asList("*");
  servletRequest.setServerName("mydomain1.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain2.com");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  allowedOrigins=Arrays.asList("http://mydomain1.com");
  servletRequest.setServerName("mydomain2.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain1.com");
  assertTrue(WebUtils.isValidOrigin(request,allowedOrigins));
  allowedOrigins=Arrays.asList("http://mydomain1.com");
  servletRequest.setServerName("mydomain2.com");
  request.getHeaders().set(HttpHeaders.ORIGIN,"http://mydomain3.com");
  assertFalse(WebUtils.isValidOrigin(request,allowedOrigins));
}
