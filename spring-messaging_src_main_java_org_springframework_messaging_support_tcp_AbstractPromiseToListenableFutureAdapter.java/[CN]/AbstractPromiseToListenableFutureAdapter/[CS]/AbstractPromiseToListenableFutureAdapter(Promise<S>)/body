{
  Assert.notNull(promise,"Promise must not be null");
  this.promise=promise;
  this.promise.onSuccess(new Consumer<S>(){
    @Override public void accept(    S result){
      try {
        registry.success(adapt(result));
      }
 catch (      Throwable t) {
        registry.failure(t);
      }
    }
  }
);
  this.promise.onError(new Consumer<Throwable>(){
    @Override public void accept(    Throwable t){
      registry.failure(t);
    }
  }
);
}
