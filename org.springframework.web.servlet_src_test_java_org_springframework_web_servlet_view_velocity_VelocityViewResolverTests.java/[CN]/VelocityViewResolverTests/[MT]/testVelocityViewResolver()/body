{
  VelocityConfig vc=new VelocityConfig(){
    public VelocityEngine getVelocityEngine(){
      return new TestVelocityEngine("prefix_test_suffix",new Template());
    }
  }
;
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  wac.getBeanFactory().registerSingleton("configurer",vc);
  wac.refresh();
  VelocityViewResolver vr=new VelocityViewResolver();
  vr.setPrefix("prefix_");
  vr.setSuffix("_suffix");
  vr.setApplicationContext(wac);
  View view=vr.resolveViewName("test",Locale.CANADA);
  assertEquals("Correct view class",VelocityView.class,view.getClass());
  assertEquals("Correct URL","prefix_test_suffix",((VelocityView)view).getUrl());
  view=vr.resolveViewName("non-existing",Locale.CANADA);
  assertNull(view);
  view=vr.resolveViewName("redirect:myUrl",Locale.getDefault());
  assertEquals("Correct view class",RedirectView.class,view.getClass());
  assertEquals("Correct URL","myUrl",((RedirectView)view).getUrl());
  view=vr.resolveViewName("forward:myUrl",Locale.getDefault());
  assertEquals("Correct view class",InternalResourceView.class,view.getClass());
  assertEquals("Correct URL","myUrl",((InternalResourceView)view).getUrl());
}
