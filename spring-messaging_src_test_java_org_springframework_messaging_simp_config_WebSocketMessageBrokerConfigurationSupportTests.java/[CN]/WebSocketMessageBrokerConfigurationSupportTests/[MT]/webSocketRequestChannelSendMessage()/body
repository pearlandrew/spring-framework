{
  TestChannel channel=this.cxtSimpleBroker.getBean("webSocketRequestChannel",TestChannel.class);
  SubProtocolWebSocketHandler webSocketHandler=this.cxtSimpleBroker.getBean(SubProtocolWebSocketHandler.class);
  TextMessage textMessage=StompTextMessageBuilder.create(StompCommand.SEND).headers("destination:/foo").build();
  webSocketHandler.handleMessage(new TestWebSocketSession(),textMessage);
  Message<?> message=channel.messages.get(0);
  StompHeaderAccessor headers=StompHeaderAccessor.wrap(message);
  assertEquals(SimpMessageType.MESSAGE,headers.getMessageType());
  assertEquals("/foo",headers.getDestination());
}
