{
  StaticWebApplicationContext wac=new StaticWebApplicationContext();
  DefaultListableBeanFactory factory=wac.getDefaultListableBeanFactory();
  wac.registerSingleton("handlerMapping",RequestMappingHandlerMapping.class);
  wac.registerSingleton("handlerAdapter",RequestMappingHandlerAdapter.class);
  factory.registerSingleton("responseBodyResultHandler",new ResponseBodyResultHandler(Arrays.asList(new ByteBufferEncoder(),new StringEncoder(),new JacksonJsonEncoder()),Collections.singletonList(new JsonObjectEncoder())));
  wac.registerSingleton("simpleResultHandler",SimpleHandlerResultHandler.class);
  this.controller=new TestController();
  factory.registerSingleton("controller",this.controller);
  wac.refresh();
  DispatcherHandler dispatcherHandler=new DispatcherHandler();
  dispatcherHandler.setApplicationContext(wac);
  return dispatcherHandler;
}
