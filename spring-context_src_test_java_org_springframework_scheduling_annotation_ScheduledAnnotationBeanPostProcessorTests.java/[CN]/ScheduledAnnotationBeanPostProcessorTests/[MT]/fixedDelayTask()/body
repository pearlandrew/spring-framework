{
  StaticApplicationContext context=new StaticApplicationContext();
  BeanDefinition processorDefinition=new RootBeanDefinition(ScheduledAnnotationBeanPostProcessor.class);
  BeanDefinition targetDefinition=new RootBeanDefinition(ScheduledAnnotationBeanPostProcessorTests.FixedDelayTestBean.class);
  context.registerBeanDefinition("postProcessor",processorDefinition);
  context.registerBeanDefinition("target",targetDefinition);
  context.refresh();
  Object postProcessor=context.getBean("postProcessor");
  Object target=context.getBean("target");
  ScheduledTaskRegistrar registrar=(ScheduledTaskRegistrar)new DirectFieldAccessor(postProcessor).getPropertyValue("registrar");
  Map<Runnable,Long> fixedDelayTasks=(Map<Runnable,Long>)new DirectFieldAccessor(registrar).getPropertyValue("fixedDelayTasks");
  assertEquals(1,fixedDelayTasks.size());
  ScheduledMethodRunnable runnable=(ScheduledMethodRunnable)fixedDelayTasks.keySet().iterator().next();
  Object targetObject=runnable.getTarget();
  Method targetMethod=runnable.getMethod();
  assertEquals(target,targetObject);
  assertEquals("fixedDelay",targetMethod.getName());
  assertEquals(new Long(5000),fixedDelayTasks.values().iterator().next());
}
