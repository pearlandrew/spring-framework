{
  conversation.setId(createNextConversationId());
  RequestAttributes attributes=RequestContextHolder.currentRequestAttributes();
  String conversationSessionAttributeName=getSessionAttributeNameForConversationId(conversation.getId());
  attributes.setAttribute(conversationSessionAttributeName,conversation,RequestAttributes.SCOPE_GLOBAL_SESSION);
  attributes.registerDestructionCallback(conversationSessionAttributeName,new ConversationDestructionCallback(conversation),RequestAttributes.SCOPE_GLOBAL_SESSION);
}
