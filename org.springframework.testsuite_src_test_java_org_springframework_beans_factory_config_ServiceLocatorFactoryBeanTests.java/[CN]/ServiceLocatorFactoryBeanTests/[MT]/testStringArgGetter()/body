{
  StaticApplicationContext ctx=new StaticApplicationContext();
  ctx.registerSingleton("testService",TestService.class,new MutablePropertyValues());
  MutablePropertyValues mpv=new MutablePropertyValues();
  mpv.addPropertyValue(new PropertyValue("serviceLocatorInterface",TestServiceLocator2.class));
  ctx.registerSingleton("factory",ServiceLocatorFactoryBean.class,mpv);
  ctx.refresh();
  final TestServiceLocator2 factory=(TestServiceLocator2)ctx.getBean("factory");
  TestService testBean=factory.getTestService(null);
  testBean=factory.getTestService("testService");
  new AssertThrows(NoSuchBeanDefinitionException.class,"Illegal operation allowed"){
    public void test() throws Exception {
      factory.getTestService("bogusTestService");
    }
  }
.runTest();
}
