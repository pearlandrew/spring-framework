{
  HttpHeaders headers=request.getHeaders();
  InetSocketAddress localAddr=request.getLocalAddress();
  InetSocketAddress remoteAddr=request.getRemoteAddress();
  StandardWebSocketSession wsSession=new StandardWebSocketSession(headers,attributes,localAddr,remoteAddr);
  StandardWebSocketHandlerAdapter endpoint=new StandardWebSocketHandlerAdapter(wsHandler,wsSession);
  upgradeInternal(request,response,acceptedProtocol,endpoint);
}
