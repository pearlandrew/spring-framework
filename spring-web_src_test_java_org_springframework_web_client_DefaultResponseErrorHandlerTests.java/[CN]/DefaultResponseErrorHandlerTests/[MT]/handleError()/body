{
  HttpHeaders headers=new HttpHeaders();
  headers.setContentType(MediaType.TEXT_PLAIN);
  expect(response.getStatusCode()).andReturn(HttpStatus.NOT_FOUND);
  expect(response.getStatusText()).andReturn("Not Found");
  expect(response.getHeaders()).andReturn(headers).atLeastOnce();
  expect(response.getBody()).andReturn(new ByteArrayInputStream("Hello World".getBytes("UTF-8")));
  replay(response);
  try {
    handler.handleError(response);
    fail("expected HttpClientErrorException");
  }
 catch (  HttpClientErrorException e) {
    assertSame(headers,e.getResponseHeaders());
  }
  verify(response);
}
