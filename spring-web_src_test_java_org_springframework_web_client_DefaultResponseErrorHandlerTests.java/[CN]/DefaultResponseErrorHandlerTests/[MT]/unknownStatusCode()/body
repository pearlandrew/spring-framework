{
  HttpHeaders headers=new HttpHeaders();
  headers.setContentType(MediaType.TEXT_PLAIN);
  expect(response.getStatusCode()).andThrow(new IllegalArgumentException("No matching constant for 999"));
  expect(response.getRawStatusCode()).andReturn(999);
  expect(response.getStatusText()).andReturn("Custom status code");
  expect(response.getHeaders()).andReturn(headers).atLeastOnce();
  expect(response.getBody()).andReturn(null);
  replay(response);
  handler.handleError(response);
}
