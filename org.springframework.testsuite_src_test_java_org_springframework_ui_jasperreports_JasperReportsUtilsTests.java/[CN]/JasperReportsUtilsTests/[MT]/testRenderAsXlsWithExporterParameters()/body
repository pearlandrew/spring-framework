{
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  Map exporterParameters=new HashMap();
  SimpleProgressMonitor monitor=new SimpleProgressMonitor();
  exporterParameters.put(JRXlsExporterParameter.PROGRESS_MONITOR,monitor);
  JasperReportsUtils.renderAsXls(getReport(),getParameters(),getData(),os,exporterParameters);
  byte[] output=os.toByteArray();
  assertXlsOutputCorrect(output);
  assertTrue(monitor.isInvoked());
}
