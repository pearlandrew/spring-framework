{
  DefaultListableBeanFactory beanFactory=new DefaultListableBeanFactory();
  beanFactory.registerBeanDefinition("config",new RootBeanDefinition(SingletonBeanConfig.class));
  ConfigurationClassPostProcessor pp=new ConfigurationClassPostProcessor();
  pp.postProcessBeanFactory(beanFactory);
  Foo foo=(Foo)beanFactory.getBean("foo");
  Bar bar=(Bar)beanFactory.getBean("bar");
  assertSame(foo,bar.foo);
}
