{
  String body="Foo";
  servletRequest.addHeader("Accept","text/*");
  servletRequest.setAttribute(HandlerMapping.PRODUCIBLE_MEDIA_TYPES_ATTRIBUTE,Collections.singleton(MediaType.TEXT_HTML));
  expect(messageConverter.canWrite(String.class,MediaType.TEXT_HTML)).andReturn(true);
  messageConverter.write(eq(body),eq(MediaType.TEXT_HTML),isA(HttpOutputMessage.class));
  replay(messageConverter);
  processor.handleReturnValue(body,returnTypeStringProduces,mavContainer,webRequest);
  assertTrue(mavContainer.isRequestHandled());
  verify(messageConverter);
}
