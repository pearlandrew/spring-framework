{
  if (this.modelKey != null) {
    Object o=model.get(this.modelKey);
    if (o == null) {
      throw new ServletException("Model contains no object with key [" + modelKey + "]");
    }
    if (!this.marshaller.supports(o.getClass())) {
      throw new ServletException("Model object [" + o + "] retrieved via key ["+ modelKey+ "] is not supported by the Marshaller");
    }
    return o;
  }
  for (  Object o : model.values()) {
    if (o != null && this.marshaller.supports(o.getClass())) {
      return o;
    }
  }
  return null;
}
