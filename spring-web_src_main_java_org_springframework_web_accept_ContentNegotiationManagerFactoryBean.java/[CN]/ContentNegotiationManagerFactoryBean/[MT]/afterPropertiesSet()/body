{
  List<ContentNegotiationStrategy> strategies=new ArrayList<ContentNegotiationStrategy>();
  Map<String,MediaType> mediaTypesMap=new HashMap<String,MediaType>();
  CollectionUtils.mergePropertiesIntoMap(this.mediaTypes,mediaTypesMap);
  if (this.favorPathExtension) {
    PathExtensionContentNegotiationStrategy strategy;
    if (this.servletContext != null) {
      strategy=new ServletPathExtensionContentNegotiationStrategy(this.servletContext,mediaTypesMap);
    }
 else {
      strategy=new PathExtensionContentNegotiationStrategy(mediaTypesMap);
    }
    if (this.useJaf != null) {
      strategy.setUseJaf(this.useJaf);
    }
    strategies.add(strategy);
  }
  if (this.favorParameter) {
    ParameterContentNegotiationStrategy strategy=new ParameterContentNegotiationStrategy(mediaTypesMap);
    strategy.setParameterName(this.parameterName);
    strategies.add(strategy);
  }
  if (!this.ignoreAcceptHeader) {
    strategies.add(new HeaderContentNegotiationStrategy());
  }
  if (this.defaultContentType != null) {
    strategies.add(new FixedContentNegotiationStrategy(this.defaultContentType));
  }
  ContentNegotiationStrategy[] array=strategies.toArray(new ContentNegotiationStrategy[strategies.size()]);
  this.contentNegotiationManager=new ContentNegotiationManager(array);
}
