{
  bf.registerBeanDefinition("testBean",BeanDefinitionBuilder.rootBeanDefinition(TestBean.class).addPropertyValue("name","testBeanName").getBeanDefinition());
  EarlyBeanReferenceProxyCreator pc=new EarlyBeanReferenceProxyCreator(bf);
  TestBean proxy=(TestBean)pc.createProxyIfPossible(descriptorFor(TestBean.class));
  assertThat(bf.containsBeanDefinition("testBean"),is(true));
  assertThat(bf.containsSingleton("testBean"),is(false));
  assertThat(proxy.getName(),equalTo("testBeanName"));
  assertThat(bf.containsSingleton("testBean"),is(true));
}
