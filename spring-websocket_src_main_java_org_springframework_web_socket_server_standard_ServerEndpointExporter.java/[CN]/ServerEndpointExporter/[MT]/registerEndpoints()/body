{
  Set<Class<?>> endpointClasses=new LinkedHashSet<Class<?>>();
  if (this.annotatedEndpointClasses != null) {
    endpointClasses.addAll(this.annotatedEndpointClasses);
  }
  ApplicationContext context=getApplicationContext();
  if (context != null) {
    String[] endpointNames=context.getBeanNamesForAnnotation(ServerEndpoint.class);
    for (    String beanName : endpointNames) {
      Class<?> beanType=context.getType(beanName);
      endpointClasses.add(beanType);
    }
  }
  for (  Class<?> endpointClass : endpointClasses) {
    registerEndpoint(endpointClass);
  }
  if (context != null) {
    Map<String,ServerEndpointConfig> endpointConfigMap=context.getBeansOfType(ServerEndpointConfig.class);
    for (    Map.Entry<String,ServerEndpointConfig> configEntry : endpointConfigMap.entrySet()) {
      String beanName=configEntry.getKey();
      ServerEndpointConfig endpointConfig=configEntry.getValue();
      registerEndpoint(endpointConfig);
    }
  }
}
