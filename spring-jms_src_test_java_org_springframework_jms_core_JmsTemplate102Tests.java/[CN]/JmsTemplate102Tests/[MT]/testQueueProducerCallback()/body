{
  JmsTemplate102 template=createTemplate();
  template.setConnectionFactory(queueConnectionFactory);
  template.afterPropertiesSet();
  QueueSender queueSender=mock(QueueSender.class);
  given(queueSession.createSender(null)).willReturn(queueSender);
  given(queueSender.getPriority()).willReturn(4);
  template.execute(new ProducerCallback(){
    @Override public Object doInJms(    Session session,    MessageProducer producer) throws JMSException {
      boolean b=session.getTransacted();
      int i=producer.getPriority();
      return null;
    }
  }
);
  verify(queueSender).close();
  verify(queueSession).close();
  verify(queueConnection).close();
}
