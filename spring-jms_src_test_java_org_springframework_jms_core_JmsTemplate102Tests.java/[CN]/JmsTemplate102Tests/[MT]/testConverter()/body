{
  JmsTemplate102 template=createTemplate();
  template.setConnectionFactory(queueConnectionFactory);
  template.setMessageConverter(new SimpleMessageConverter());
  String s="Hello world";
  QueueSender queueSender=mock(QueueSender.class);
  TextMessage message=mock(TextMessage.class);
  given(queueSession.createSender(this.queue)).willReturn(queueSender);
  given(queueSession.createTextMessage("Hello world")).willReturn(message);
  template.convertAndSend(queue,s);
  if (useTransactedTemplate()) {
    verify(queueSession).commit();
  }
  verify(queueSender).send(message);
  verify(queueSender).close();
  verify(queueSession).close();
  verify(queueConnection).close();
}
