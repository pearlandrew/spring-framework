{
  BufferedReader in=new BufferedReader(reader);
  while (true) {
    String line=in.readLine();
    if (line == null) {
      return;
    }
    line=StringUtils.trimLeadingWhitespace(line);
    if (line.length() > 0) {
      char firstChar=line.charAt(0);
      if (firstChar != '#' && firstChar != '!') {
        while (endsWithContinuationMarker(line)) {
          String nextLine=in.readLine();
          line=line.substring(0,line.length() - 1);
          if (nextLine != null) {
            line+=StringUtils.trimLeadingWhitespace(nextLine);
          }
        }
        int separatorIndex=line.indexOf("=");
        if (separatorIndex == -1) {
          separatorIndex=line.indexOf(":");
        }
        String key=(separatorIndex != -1 ? line.substring(0,separatorIndex) : line);
        String value=(separatorIndex != -1) ? line.substring(separatorIndex + 1) : "";
        key=StringUtils.trimTrailingWhitespace(key);
        value=StringUtils.trimLeadingWhitespace(value);
        props.put(unescape(key),unescape(value));
      }
    }
  }
}
