{
  ScopeMetadata metadata=new ScopeMetadata();
  if (definition instanceof AnnotatedBeanDefinition) {
    AnnotatedBeanDefinition annDef=(AnnotatedBeanDefinition)definition;
    AnnotationAttributes attributes=attributesFor(annDef.getMetadata(),this.scopeAnnotationType);
    if (attributes != null) {
      metadata.setScopeName(attributes.getString("value"));
      ScopedProxyMode proxyMode=attributes.getEnum("proxyMode",ScopedProxyMode.class);
      if (proxyMode == null || proxyMode == ScopedProxyMode.DEFAULT) {
        proxyMode=this.defaultProxyMode;
      }
      metadata.setScopedProxyMode(proxyMode);
    }
  }
  return metadata;
}
