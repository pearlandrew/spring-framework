{
  ScopeMetadata metadata=new ScopeMetadata();
  if (definition instanceof AnnotatedBeanDefinition) {
    AnnotatedBeanDefinition annDef=(AnnotatedBeanDefinition)definition;
    Map<String,Object> attributes=annDef.getMetadata().getAnnotationAttributes(this.scopeAnnotationType.getName());
    if (attributes != null) {
      metadata.setScopeName((String)attributes.get("value"));
    }
    if (!metadata.getScopeName().equals(BeanDefinition.SCOPE_SINGLETON)) {
      metadata.setScopedProxyMode(this.scopedProxyMode);
    }
  }
  return metadata;
}
