{
  assertEditable();
  assertEnabled();
  if (submittedValue instanceof String) {
    try {
      Object parsed=context.getFormatter().parse((String)submittedValue,getLocale());
      buffer.setValue(coerseToValueType(parsed));
      submittedValue=null;
      bindingStatus=BindingStatus.DIRTY;
    }
 catch (    ParseException e) {
      this.submittedValue=submittedValue;
      invalidSubmittedValueCause=e;
      bindingStatus=BindingStatus.INVALID_SUBMITTED_VALUE;
    }
catch (    ConversionFailedException e) {
      this.submittedValue=submittedValue;
      invalidSubmittedValueCause=e;
      bindingStatus=BindingStatus.INVALID_SUBMITTED_VALUE;
    }
  }
 else   if (submittedValue instanceof String[]) {
    Object parsed;
    if (isMap()) {
      String[] sourceValues=(String[])submittedValue;
      Formatter keyFormatter=context.getKeyFormatter();
      Formatter valueFormatter=context.getElementFormatter();
      Map map=new LinkedHashMap(sourceValues.length);
      for (int i=0; i < sourceValues.length; i++) {
        String entryString=sourceValues[i];
        try {
          String[] keyValue=entryString.split("=");
          Object parsedMapKey=keyFormatter.parse(keyValue[0],getLocale());
          Object parsedMapValue=valueFormatter.parse(keyValue[1],getLocale());
          map.put(parsedMapKey,parsedMapValue);
        }
 catch (        ParseException e) {
          this.submittedValue=submittedValue;
          invalidSubmittedValueCause=e;
          bindingStatus=BindingStatus.INVALID_SUBMITTED_VALUE;
          break;
        }
      }
      parsed=map;
    }
 else {
      String[] sourceValues=(String[])submittedValue;
      List list=new ArrayList(sourceValues.length);
      for (int i=0; i < sourceValues.length; i++) {
        Object parsedValue;
        try {
          parsedValue=context.getElementFormatter().parse(sourceValues[i],getLocale());
          list.add(parsedValue);
        }
 catch (        ParseException e) {
          this.submittedValue=submittedValue;
          invalidSubmittedValueCause=e;
          bindingStatus=BindingStatus.INVALID_SUBMITTED_VALUE;
          break;
        }
      }
      parsed=list;
    }
    if (bindingStatus != BindingStatus.INVALID_SUBMITTED_VALUE) {
      try {
        buffer.setValue(coerseToValueType(parsed));
        submittedValue=null;
        bindingStatus=BindingStatus.DIRTY;
      }
 catch (      ConversionFailedException e) {
        this.submittedValue=submittedValue;
        invalidSubmittedValueCause=e;
        bindingStatus=BindingStatus.INVALID_SUBMITTED_VALUE;
      }
    }
  }
 else {
    try {
      buffer.setValue(coerseToValueType(submittedValue));
      submittedValue=null;
      bindingStatus=BindingStatus.DIRTY;
    }
 catch (    ConversionFailedException e) {
      this.submittedValue=submittedValue;
      invalidSubmittedValueCause=e;
      bindingStatus=BindingStatus.INVALID_SUBMITTED_VALUE;
    }
  }
}
