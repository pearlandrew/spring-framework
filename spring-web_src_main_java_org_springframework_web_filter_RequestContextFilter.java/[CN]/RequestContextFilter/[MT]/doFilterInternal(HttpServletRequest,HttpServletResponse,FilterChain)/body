{
  ServletRequestAttributes attributes=new ServletRequestAttributes(request);
  initContextHolders(request,attributes);
  AsyncExecutionChain chain=AsyncExecutionChain.getForCurrentRequest(request);
  chain.addDelegatingCallable(getChainedCallable(request,attributes));
  try {
    filterChain.doFilter(request,response);
  }
  finally {
    resetContextHolders();
    if (chain.isAsyncStarted()) {
      return;
    }
    attributes.requestCompleted();
    if (logger.isDebugEnabled()) {
      logger.debug("Cleared thread-bound request context: " + request);
    }
  }
}
