{
  if ((this.userSessionRegistry != null) && (session.getPrincipal() != null)) {
    this.userSessionRegistry.unregisterSessionId(session.getPrincipal().getName(),session.getId());
  }
  StompHeaderAccessor headers=StompHeaderAccessor.create(StompCommand.DISCONNECT);
  headers.setSessionId(session.getId());
  Message<?> message=MessageBuilder.withPayload(new byte[0]).setHeaders(headers).build();
  outputChannel.send(message);
}
