{
  Resource resolved=chain.resolveResource(request,requestPath,locations);
  if (resolved != null) {
    return resolved;
  }
  String hash=extractHash(requestPath);
  if (StringUtils.isEmpty(hash)) {
    if (logger.isTraceEnabled()) {
      logger.trace("No hash found");
    }
    return null;
  }
  String simplePath=StringUtils.delete(requestPath,"-" + hash);
  if (logger.isTraceEnabled()) {
    logger.trace("Extracted hash from path, re-resolving without hash, path=\"" + simplePath + "\"");
  }
  Resource baseResource=chain.resolveResource(request,simplePath,locations);
  if (baseResource == null) {
    return null;
  }
  String candidateHash=calculateHash(baseResource);
  if (candidateHash.equals(hash)) {
    if (logger.isTraceEnabled()) {
      logger.trace("Calculated hash matches extracted hash");
    }
    return baseResource;
  }
 else {
    logger.trace("Potential resource found for [" + requestPath + "], but fingerprint doesn't match.");
    return null;
  }
}
