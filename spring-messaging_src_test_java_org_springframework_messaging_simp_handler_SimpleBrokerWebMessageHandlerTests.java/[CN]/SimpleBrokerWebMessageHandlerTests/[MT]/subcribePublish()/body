{
  this.messageHandler.handleSubscribe(createSubscriptionMessage("sess1","sub1","/foo"));
  this.messageHandler.handleSubscribe(createSubscriptionMessage("sess1","sub2","/foo"));
  this.messageHandler.handleSubscribe(createSubscriptionMessage("sess1","sub3","/bar"));
  this.messageHandler.handleSubscribe(createSubscriptionMessage("sess2","sub1","/foo"));
  this.messageHandler.handleSubscribe(createSubscriptionMessage("sess2","sub2","/foo"));
  this.messageHandler.handleSubscribe(createSubscriptionMessage("sess2","sub3","/bar"));
  this.messageHandler.handlePublish(createMessage("/foo","message1"));
  this.messageHandler.handlePublish(createMessage("/bar","message2"));
  verify(this.clientChannel,times(6)).send(this.messageCaptor.capture());
  assertCapturedMessage("sess1","sub1","/foo");
  assertCapturedMessage("sess1","sub2","/foo");
  assertCapturedMessage("sess2","sub1","/foo");
  assertCapturedMessage("sess2","sub2","/foo");
  assertCapturedMessage("sess1","sub3","/bar");
  assertCapturedMessage("sess2","sub3","/bar");
}
