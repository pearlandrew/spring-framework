{
  handler=WebSocketHandlerDecorator.unwrap(handler);
  List<String> subProtocols=null;
  if (handler instanceof SubProtocolCapable) {
    subProtocols=((SubProtocolCapable)handler).getSubProtocols();
  }
  return (subProtocols != null) ? subProtocols : Collections.<String>emptyList();
}
