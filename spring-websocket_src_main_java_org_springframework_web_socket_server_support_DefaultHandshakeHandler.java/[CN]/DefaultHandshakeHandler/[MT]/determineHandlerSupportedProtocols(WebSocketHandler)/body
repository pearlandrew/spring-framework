{
  List<String> subProtocols=null;
  if (handler instanceof SubProtocolCapable) {
    subProtocols=((SubProtocolCapable)handler).getSubProtocols();
  }
 else   if (handler instanceof WebSocketHandlerDecorator) {
    WebSocketHandler lastHandler=((WebSocketHandlerDecorator)handler).getLastHandler();
    if (lastHandler instanceof SubProtocolCapable) {
      subProtocols=((SubProtocolCapable)lastHandler).getSubProtocols();
      ;
    }
  }
  return (subProtocols != null) ? subProtocols : Collections.<String>emptyList();
}
