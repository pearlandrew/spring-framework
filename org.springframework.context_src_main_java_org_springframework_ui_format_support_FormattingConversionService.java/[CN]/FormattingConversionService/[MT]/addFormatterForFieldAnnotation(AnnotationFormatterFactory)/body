{
  final Class<? extends Annotation> annotationType=resolveAnnotationType(annotationFormatterFactory);
  if (annotationType == null) {
    throw new IllegalArgumentException("Unable to extract parameterized Annotation type argument from AnnotationFormatterFactory [" + annotationFormatterFactory.getClass().getName() + "]; does the factory parameterize the <A extends Annotation> generic type?");
  }
  Set<Class<?>> fieldTypes=annotationFormatterFactory.getFieldTypes();
  for (  final Class<?> fieldType : fieldTypes) {
    this.conversionService.addGenericConverter(fieldType,String.class,new ConditionalGenericConverter(){
      public boolean matches(      TypeDescriptor sourceFieldType,      TypeDescriptor targetFieldType){
        return sourceFieldType.getAnnotation(annotationType) != null;
      }
      public Object convert(      Object source,      TypeDescriptor sourceType,      TypeDescriptor targetType){
        Printer<?> printer=annotationFormatterFactory.getPrinter(sourceType.getAnnotation(annotationType),targetType.getType());
        return new PrinterConverter(printer,conversionService).convert(source,sourceType,targetType);
      }
      public String toString(){
        return "@" + annotationType.getName() + " "+ fieldType.getName()+ " -> "+ String.class.getName();
      }
    }
);
    this.conversionService.addGenericConverter(String.class,fieldType,new ConditionalGenericConverter(){
      public boolean matches(      TypeDescriptor sourceFieldType,      TypeDescriptor targetFieldType){
        return targetFieldType.getAnnotation(annotationType) != null;
      }
      public Object convert(      Object source,      TypeDescriptor sourceType,      TypeDescriptor targetType){
        Parser<?> parser=annotationFormatterFactory.getParser(targetType.getAnnotation(annotationType),targetType.getType());
        return new ParserConverter(parser,conversionService).convert(source,sourceType,targetType);
      }
      public String toString(){
        return String.class.getName() + " -> @" + annotationType.getName()+ " "+ fieldType.getName();
      }
    }
);
  }
}
