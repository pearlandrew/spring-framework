{
  if (this.propertySources != null) {
    for (    PropertySource<?> propertySource : this.propertySources) {
      if (logger.isTraceEnabled()) {
        logger.trace(String.format("Searching for key '%s' in [%s]",key,propertySource.getName()));
      }
      Object value=propertySource.getProperty(key);
      if (value != null) {
        if (logger.isDebugEnabled()) {
          logger.debug(String.format("Found key '%s' in [%s] with value '%s'",key,propertySource.getName(),value));
        }
        Class<?> clazz;
        if (value instanceof String) {
          try {
            clazz=ClassUtils.forName((String)value,null);
          }
 catch (          Exception ex) {
            throw new ClassConversionException((String)value,targetValueType,ex);
          }
        }
 else         if (value instanceof Class) {
          clazz=(Class<?>)value;
        }
 else {
          clazz=value.getClass();
        }
        if (!targetValueType.isAssignableFrom(clazz)) {
          throw new ClassConversionException(clazz,targetValueType);
        }
        @SuppressWarnings("unchecked") Class<T> targetClass=(Class<T>)clazz;
        return targetClass;
      }
    }
  }
  if (logger.isDebugEnabled()) {
    logger.debug(String.format("Could not find key '%s' in any property source",key));
  }
  return null;
}
