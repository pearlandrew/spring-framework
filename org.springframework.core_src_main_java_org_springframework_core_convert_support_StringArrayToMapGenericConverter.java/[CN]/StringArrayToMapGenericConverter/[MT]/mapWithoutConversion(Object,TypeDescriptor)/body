{
  int length=Array.getLength(source);
  Map target=CollectionFactory.createMap(targetType.getType(),length);
  for (int i=0; i < length; i++) {
    String property=(String)Array.get(source,i);
    String[] fields=property.split("=");
    if (fields.length < 2) {
      throw new IllegalArgumentException("Invalid String property '" + property + "'; properties should be in the format name=value");
    }
    String key=fields[0];
    String value=fields[1];
    target.put(key,value);
  }
  return target;
}
