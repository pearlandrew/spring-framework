{
synchronized (this.lock) {
    boolean wasExpired=getAndSetExpired();
    if (wasExpired) {
      return false;
    }
    if (!awaitResultHandler()) {
      throw new IllegalStateException("DeferredResultHandler not set");
    }
    try {
      this.resultHandler.handleResult(result);
    }
 catch (    Throwable t) {
      logger.trace("DeferredResult not handled",t);
      return false;
    }
    return true;
  }
}
