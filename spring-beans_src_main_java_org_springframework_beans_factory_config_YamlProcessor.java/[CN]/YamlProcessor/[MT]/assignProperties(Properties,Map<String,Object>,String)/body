{
  for (  Entry<String,Object> entry : input.entrySet()) {
    String key=entry.getKey();
    if (StringUtils.hasText(path)) {
      if (key.startsWith("[")) {
        key=path + key;
      }
 else {
        key=path + "." + key;
      }
    }
    Object value=entry.getValue();
    if (value instanceof String) {
      properties.put(key,value);
    }
 else     if (value instanceof Map) {
      @SuppressWarnings("unchecked") Map<String,Object> map=(Map<String,Object>)value;
      assignProperties(properties,map,key);
    }
 else     if (value instanceof Collection) {
      @SuppressWarnings("unchecked") Collection<Object> collection=(Collection<Object>)value;
      int count=0;
      for (      Object object : collection) {
        assignProperties(properties,Collections.singletonMap("[" + (count++) + "]",object),key);
      }
    }
 else {
      properties.put(key,value == null ? "" : value);
    }
  }
}
