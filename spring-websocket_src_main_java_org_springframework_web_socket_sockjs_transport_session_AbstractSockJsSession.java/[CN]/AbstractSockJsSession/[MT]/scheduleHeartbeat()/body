{
  if (this.heartbeatDisabled) {
    return;
  }
  Assert.state(this.config.getTaskScheduler() != null,"No TaskScheduler configured for heartbeat");
  cancelHeartbeat();
  if (!isActive()) {
    return;
  }
  Date time=new Date(System.currentTimeMillis() + this.config.getHeartbeatTime());
  this.heartbeatTask=this.config.getTaskScheduler().schedule(new Runnable(){
    public void run(){
      try {
        sendHeartbeat();
      }
 catch (      Throwable ex) {
      }
    }
  }
,time);
  if (logger.isTraceEnabled()) {
    logger.trace("Scheduled heartbeat after " + this.config.getHeartbeatTime() / 1000 + " seconds");
  }
}
