{
  Assert.notNull(headers,"'headers' must not be null");
  if (readOnly) {
    Map<String,List<String>> map=new LinkedCaseInsensitiveMap<List<String>>(headers.size(),Locale.ENGLISH);
    for (    Entry<String,List<String>> entry : headers.entrySet()) {
      List<String> values=Collections.unmodifiableList(entry.getValue());
      map.put(entry.getKey(),values);
    }
    this.headers=Collections.unmodifiableMap(map);
    this.cookies=(cookies != null ? Collections.unmodifiableMap(cookies) : Collections.emptyMap());
  }
 else {
    this.headers=headers;
    this.cookies=(cookies != null ? cookies : new LinkedHashMap<>());
  }
}
