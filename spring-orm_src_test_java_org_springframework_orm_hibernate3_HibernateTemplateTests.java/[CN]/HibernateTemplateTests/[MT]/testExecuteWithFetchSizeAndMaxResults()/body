{
  Query query1=mock(Query.class);
  Query query2=mock(Query.class);
  Criteria criteria=mock(Criteria.class);
  given(session.createQuery("some query")).willReturn(query1);
  given(query1.setFetchSize(10)).willReturn(query1);
  given(query1.setMaxResults(20)).willReturn(query1);
  given(session.getNamedQuery("some query name")).willReturn(query2);
  given(query2.setFetchSize(10)).willReturn(query2);
  given(query2.setMaxResults(20)).willReturn(query2);
  given(session.createCriteria(TestBean.class)).willReturn(criteria);
  given(criteria.setFetchSize(10)).willReturn(criteria);
  given(criteria.setMaxResults(20)).willReturn(criteria);
  hibernateTemplate.setFetchSize(10);
  hibernateTemplate.setMaxResults(20);
  hibernateTemplate.execute(new HibernateCallback<Object>(){
    @Override public Object doInHibernate(    org.hibernate.Session sess) throws HibernateException {
      sess.createQuery("some query");
      sess.getNamedQuery("some query name");
      sess.createCriteria(TestBean.class);
      return null;
    }
  }
);
  verify(session).flush();
  verify(session).close();
}
