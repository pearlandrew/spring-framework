{
synchronized (this.singletonObjects) {
    if (this.singletonObjects.containsKey(name)) {
      Object jndiObject=this.singletonObjects.get(name);
      if (requiredType != null && !requiredType.isInstance(jndiObject)) {
        throw new TypeMismatchNamingException(convertJndiName(name),requiredType,(jndiObject != null ? jndiObject.getClass() : null));
      }
      return jndiObject;
    }
    Object jndiObject=lookup(name,requiredType);
    this.singletonObjects.put(name,jndiObject);
    return jndiObject;
  }
}
