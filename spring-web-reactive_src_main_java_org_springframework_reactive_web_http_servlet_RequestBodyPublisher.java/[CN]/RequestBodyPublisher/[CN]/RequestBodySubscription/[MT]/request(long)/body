{
  logger.debug("Updating demand " + demand + " by "+ n);
  demand.increase(n);
  logger.debug("Stalled: " + stalled);
  if (stalled) {
    stalled=false;
    try {
      onDataAvailable();
    }
 catch (    IOException ex) {
      onError(ex);
    }
  }
}
