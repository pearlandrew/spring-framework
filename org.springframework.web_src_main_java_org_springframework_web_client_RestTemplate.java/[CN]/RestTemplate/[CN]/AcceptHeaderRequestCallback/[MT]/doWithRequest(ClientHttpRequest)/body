{
  List<MediaType> allSupportedMediaTypes=new ArrayList<MediaType>();
  for (  HttpMessageConverter<?> entityConverter : messageConverters) {
    List<MediaType> supportedMediaTypes=entityConverter.getSupportedMediaTypes();
    for (    MediaType supportedMediaType : supportedMediaTypes) {
      if (supportedMediaType.getCharSet() != null) {
        supportedMediaType=new MediaType(supportedMediaType.getType(),supportedMediaType.getSubtype());
      }
      allSupportedMediaTypes.add(supportedMediaType);
    }
  }
  if (!allSupportedMediaTypes.isEmpty()) {
    Collections.sort(allSupportedMediaTypes);
    request.getHeaders().setAccept(allSupportedMediaTypes);
  }
}
