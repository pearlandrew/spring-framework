{
  if (logger.isDebugEnabled()) {
    logger.debug("Processing " + request.getMethod() + " request for ["+ request.getURI()+ "]");
  }
  Object handler=getHandler(request);
  if (handler == null) {
    response.setStatusCode(HttpStatus.NOT_FOUND);
    return Streams.empty();
  }
  HandlerAdapter handlerAdapter=getHandlerAdapter(handler);
  try {
    HandlerResult result=handlerAdapter.handle(request,response,handler);
    for (    HandlerResultHandler resultHandler : resultHandlers) {
      if (resultHandler.supports(result)) {
        return resultHandler.handleResult(request,response,result);
      }
    }
    return Streams.fail(new IllegalStateException("No HandlerResultHandler for " + result.getValue()));
  }
 catch (  Exception ex) {
    return Streams.fail(ex);
  }
}
