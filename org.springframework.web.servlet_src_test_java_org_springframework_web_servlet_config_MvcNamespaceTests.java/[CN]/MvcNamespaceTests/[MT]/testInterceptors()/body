{
  loadBeanDefinitions("mvc-config-interceptors.xml",14);
  RequestMappingHandlerMapping mapping=appContext.getBean(RequestMappingHandlerMapping.class);
  assertNotNull(mapping);
  mapping.setDefaultHandler(handlerMethod);
  MockHttpServletRequest request=new MockHttpServletRequest("GET","/");
  request.setRequestURI("/accounts/12345");
  request.addParameter("locale","en");
  request.addParameter("theme","green");
  HandlerExecutionChain chain=mapping.getHandler(request);
  assertEquals(3,chain.getInterceptors().length);
  assertTrue(chain.getInterceptors()[0] instanceof ConversionServiceExposingInterceptor);
  assertTrue(chain.getInterceptors()[1] instanceof LocaleChangeInterceptor);
  assertTrue(chain.getInterceptors()[2] instanceof ThemeChangeInterceptor);
  request.setRequestURI("/logged/accounts/12345");
  chain=mapping.getHandler(request);
  assertEquals(4,chain.getInterceptors().length);
  assertTrue(chain.getInterceptors()[3] instanceof WebRequestHandlerInterceptorAdapter);
  request.setRequestURI("/foo/logged");
  chain=mapping.getHandler(request);
  assertEquals(4,chain.getInterceptors().length);
  assertTrue(chain.getInterceptors()[3] instanceof WebRequestHandlerInterceptorAdapter);
}
