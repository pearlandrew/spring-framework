{
  ConfigurableApplicationContext ctx=load("autodetectNoAutoStartup.xml");
  try {
    MBeanExporter exporter=ctx.getBean("exporter",MBeanExporter.class);
    MBeanServer server=ctx.getBean("server",MBeanServer.class);
    ObjectName on=ObjectNameManager.getInstance("spring:mbean=true");
    try {
      server.getObjectInstance(on);
      fail("MBeans should not have been exported with autoStartup set to false");
    }
 catch (    InstanceNotFoundException e) {
    }
    exporter.start();
    assertNotNull(server.getObjectInstance(on));
  }
  finally {
    ctx.close();
  }
}
