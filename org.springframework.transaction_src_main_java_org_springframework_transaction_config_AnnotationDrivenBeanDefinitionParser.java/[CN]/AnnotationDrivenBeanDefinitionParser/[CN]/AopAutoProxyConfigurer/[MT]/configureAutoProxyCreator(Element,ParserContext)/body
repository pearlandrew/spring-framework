{
  AopNamespaceUtils.registerAutoProxyCreatorIfNecessary(parserContext,element);
  if (!parserContext.getRegistry().containsBeanDefinition(TRANSACTION_ADVISOR_BEAN_NAME)) {
    Object eleSource=parserContext.extractSource(element);
    RootBeanDefinition sourceDef=new RootBeanDefinition(AnnotationTransactionAttributeSource.class);
    sourceDef.setSource(eleSource);
    sourceDef.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);
    String sourceName=parserContext.getReaderContext().registerWithGeneratedName(sourceDef);
    RootBeanDefinition interceptorDef=new RootBeanDefinition(TransactionInterceptor.class);
    interceptorDef.setSource(eleSource);
    interceptorDef.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);
    registerTransactionManager(element,interceptorDef);
    interceptorDef.getPropertyValues().addPropertyValue("transactionAttributeSource",new RuntimeBeanReference(sourceName));
    String interceptorName=parserContext.getReaderContext().registerWithGeneratedName(interceptorDef);
    RootBeanDefinition advisorDef=new RootBeanDefinition(BeanFactoryTransactionAttributeSourceAdvisor.class);
    advisorDef.setSource(eleSource);
    advisorDef.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);
    advisorDef.getPropertyValues().addPropertyValue("transactionAttributeSource",new RuntimeBeanReference(sourceName));
    advisorDef.getPropertyValues().addPropertyValue("adviceBeanName",interceptorName);
    if (element.hasAttribute("order")) {
      advisorDef.getPropertyValues().addPropertyValue("order",element.getAttribute("order"));
    }
    parserContext.getRegistry().registerBeanDefinition(TRANSACTION_ADVISOR_BEAN_NAME,advisorDef);
    CompositeComponentDefinition compositeDef=new CompositeComponentDefinition(element.getTagName(),eleSource);
    compositeDef.addNestedComponent(new BeanComponentDefinition(sourceDef,sourceName));
    compositeDef.addNestedComponent(new BeanComponentDefinition(interceptorDef,interceptorName));
    compositeDef.addNestedComponent(new BeanComponentDefinition(advisorDef,TRANSACTION_ADVISOR_BEAN_NAME));
    parserContext.registerComponent(compositeDef);
  }
}
