{
  Properties mergedProps=new Properties();
  for (int i=propertySources.size() - 1; i >= 0; i--) {
    PropertySource<?> propertySource=propertySources.get(i);
    Object object=propertySource.getSource();
    if (object instanceof Map) {
      for (      Entry<?,?> entry : ((Map<?,?>)object).entrySet()) {
        mergedProps.put(entry.getKey(),entry.getValue());
      }
    }
 else {
      throw new IllegalArgumentException("unknown PropertySource source type: " + object.getClass().getName());
    }
  }
  return mergedProps;
}
