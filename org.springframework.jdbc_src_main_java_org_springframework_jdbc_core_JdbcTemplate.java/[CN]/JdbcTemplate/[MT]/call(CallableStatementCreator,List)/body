{
  final List updateCountParameters=new ArrayList();
  final List resultSetParameters=new ArrayList();
  final List callParameters=new ArrayList();
  for (int i=0; i < declaredParameters.size(); i++) {
    SqlParameter parameter=(SqlParameter)declaredParameters.get(i);
    if (parameter.isResultsParameter()) {
      if (parameter instanceof SqlReturnResultSet) {
        resultSetParameters.add(parameter);
      }
 else {
        updateCountParameters.add(parameter);
      }
    }
 else {
      callParameters.add(parameter);
    }
  }
  return (Map)execute(csc,new CallableStatementCallback(){
    public Object doInCallableStatement(    CallableStatement cs) throws SQLException {
      boolean retVal=cs.execute();
      int updateCount=cs.getUpdateCount();
      if (logger.isDebugEnabled()) {
        logger.debug("CallableStatement.execute() returned '" + retVal + "'");
        logger.debug("CallableStatement.getUpdateCount() returned " + updateCount);
      }
      Map returnedResults=createResultsMap();
      if (retVal || updateCount != -1) {
        returnedResults.putAll(extractReturnedResults(cs,updateCountParameters,resultSetParameters,updateCount));
      }
      returnedResults.putAll(extractOutputParameters(cs,callParameters));
      return returnedResults;
    }
  }
);
}
