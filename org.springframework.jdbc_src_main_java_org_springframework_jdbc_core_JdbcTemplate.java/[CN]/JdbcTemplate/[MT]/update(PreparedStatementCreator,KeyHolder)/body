{
  Assert.notNull(generatedKeyHolder,"KeyHolder must not be null");
  logger.debug("Executing SQL update and returning generated keys");
  Integer result=(Integer)execute(psc,new PreparedStatementCallback(){
    public Object doInPreparedStatement(    PreparedStatement ps) throws SQLException {
      int rows=ps.executeUpdate();
      List generatedKeys=generatedKeyHolder.getKeyList();
      generatedKeys.clear();
      ResultSet keys=ps.getGeneratedKeys();
      if (keys != null) {
        try {
          RowMapper rowMapper=getColumnMapRowMapper();
          RowMapperResultSetExtractor rse=new RowMapperResultSetExtractor(rowMapper,1);
          generatedKeys.addAll((List)rse.extractData(keys));
        }
  finally {
          JdbcUtils.closeResultSet(keys);
        }
      }
      if (logger.isDebugEnabled()) {
        logger.debug("SQL update affected " + rows + " rows and returned "+ generatedKeys.size()+ " keys");
      }
      return new Integer(rows);
    }
  }
);
  return result.intValue();
}
