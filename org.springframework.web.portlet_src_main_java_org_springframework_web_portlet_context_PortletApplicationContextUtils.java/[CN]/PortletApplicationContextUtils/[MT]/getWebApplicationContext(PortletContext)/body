{
  Assert.notNull(pc,"PortletContext must not be null");
  Object attr=pc.getAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE);
  if (attr == null) {
    return null;
  }
  if (attr instanceof RuntimeException) {
    throw (RuntimeException)attr;
  }
  if (attr instanceof Error) {
    throw (Error)attr;
  }
  if (!(attr instanceof ApplicationContext)) {
    throw new IllegalStateException("Root context attribute is not of type WebApplicationContext: " + attr);
  }
  return (ApplicationContext)attr;
}
