{
  try {
    int c;
    do {
      ByteBuffer buffer=this.buffers.peek().getBuffer();
      do {
        c=channel.write(buffer);
      }
 while (buffer.hasRemaining() && c > 0);
      if (!buffer.hasRemaining()) {
        safeClose(this.buffers.remove());
      }
    }
 while (!this.buffers.isEmpty() && c > 0);
    if (!this.buffers.isEmpty()) {
      channel.resumeWrites();
    }
 else {
      this.writing.decrementAndGet();
      if (this.closing.get()) {
        closeIfDone();
      }
 else {
        this.subscription.request(1);
      }
    }
  }
 catch (  IOException ex) {
    onError(ex);
  }
}
