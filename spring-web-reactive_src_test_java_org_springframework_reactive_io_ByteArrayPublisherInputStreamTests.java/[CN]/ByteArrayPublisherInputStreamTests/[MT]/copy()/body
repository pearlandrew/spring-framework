{
  ByteArrayPublisherOutputStream os=new ByteArrayPublisherOutputStream();
  FileCopyUtils.copy(is,os);
  Publisher<byte[]> publisher=os.toByteArrayPublisher();
  List<byte[]> result=new ArrayList<>();
  AtomicBoolean complete=new AtomicBoolean();
  publisher.subscribe(new Subscriber<byte[]>(){
    @Override public void onSubscribe(    Subscription s){
      s.request(Long.MAX_VALUE);
    }
    @Override public void onNext(    byte[] bytes){
      result.add(bytes);
    }
    @Override public void onError(    Throwable t){
      fail(t.getMessage());
    }
    @Override public void onComplete(){
      complete.set(true);
    }
  }
);
  while (!complete.get()) {
  }
  assertArrayEquals(result.get(0),new byte[]{'a','b','c'});
  assertArrayEquals(result.get(1),new byte[]{'d','e'});
}
