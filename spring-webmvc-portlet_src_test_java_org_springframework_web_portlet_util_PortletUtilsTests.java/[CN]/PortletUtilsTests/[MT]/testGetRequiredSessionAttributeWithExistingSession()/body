{
  MockPortletSession session=new MockPortletSession();
  session.setAttribute("foo","foo");
  PortletRequest request=createMock(PortletRequest.class);
  expect(request.getPortletSession(false)).andReturn(session);
  replay(request);
  Object sessionAttribute=PortletUtils.getRequiredSessionAttribute(request,"foo");
  assertNotNull("Must not return null if session attribute exists (and Session exists)",sessionAttribute);
  assertEquals("foo",sessionAttribute);
  verify(request);
}
