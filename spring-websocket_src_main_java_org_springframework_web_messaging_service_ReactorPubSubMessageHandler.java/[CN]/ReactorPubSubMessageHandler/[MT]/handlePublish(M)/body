{
  if (logger.isDebugEnabled()) {
    logger.debug("Message received: " + message);
  }
  try {
    PubSubHeaders headers=PubSubHeaders.fromMessageHeaders(message.getHeaders());
    byte[] payload=payloadConverter.convertToPayload(message.getPayload(),headers.getContentType());
    @SuppressWarnings("unchecked") M m=(M)MessageBuilder.fromPayloadAndHeaders(payload,message.getHeaders()).build();
    this.reactor.notify(getPublishKey(headers.getDestination()),Event.wrap(m));
  }
 catch (  Exception ex) {
    logger.error("Failed to publish " + message,ex);
  }
}
