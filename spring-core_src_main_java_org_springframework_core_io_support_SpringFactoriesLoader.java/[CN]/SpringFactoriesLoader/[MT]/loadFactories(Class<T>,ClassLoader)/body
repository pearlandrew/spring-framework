{
  Assert.notNull(factoryClass,"'factoryClass' must not be null");
  ClassLoader classLoaderToUse=classLoader;
  if (classLoaderToUse == null) {
    classLoaderToUse=SpringFactoriesLoader.class.getClassLoader();
  }
  List<String> factoryNames=loadFactoryNames(factoryClass,classLoaderToUse);
  if (logger.isTraceEnabled()) {
    logger.trace("Loaded [" + factoryClass.getName() + "] names: "+ factoryNames);
  }
  List<T> result=new ArrayList<T>(factoryNames.size());
  for (  String factoryName : factoryNames) {
    result.add(instantiateFactory(factoryName,factoryClass,classLoaderToUse));
  }
  OrderComparator.sort(result);
  return result;
}
