{
  UserRoleAuthorizationInterceptor interceptor=new UserRoleAuthorizationInterceptor();
  String validRole="allowed";
  interceptor.setAuthorizedRoles(new String[]{validRole});
  MockRenderRequest request=new MockRenderRequest();
  MockRenderResponse response=new MockRenderResponse();
  Object handler=new Object();
  request.addUserRole("someOtherRole");
  assertFalse(request.isUserInRole(validRole));
  try {
    interceptor.preHandle(request,response,handler);
    fail("should have thrown PortletSecurityException");
  }
 catch (  PortletSecurityException ex) {
  }
}
