{
  CloseableHttpClient client=HttpClientBuilder.create().setDefaultRequestConfig(RequestConfig.custom().setConnectTimeout(1234).build()).build();
  HttpComponentsClientHttpRequestFactory hrf=new HttpComponentsClientHttpRequestFactory(client);
  URI uri=new URI(baseUrl + "/status/ok");
  HttpComponentsClientHttpRequest request=(HttpComponentsClientHttpRequest)hrf.createRequest(uri,HttpMethod.GET);
  assertNull("No custom config should be set with a custom HttpClient",request.getHttpContext().getAttribute(HttpClientContext.REQUEST_CONFIG));
  hrf.setConnectionRequestTimeout(4567);
  HttpComponentsClientHttpRequest request2=(HttpComponentsClientHttpRequest)hrf.createRequest(uri,HttpMethod.GET);
  Object requestConfigAttribute=request2.getHttpContext().getAttribute(HttpClientContext.REQUEST_CONFIG);
  assertNotNull(requestConfigAttribute);
  RequestConfig requestConfig=(RequestConfig)requestConfigAttribute;
  assertEquals(4567,requestConfig.getConnectionRequestTimeout());
  assertEquals(-1,requestConfig.getConnectTimeout());
}
