{
  int last=endElements.size() - 1;
  EndElement oldEndElement=endElements.get(last);
  Iterator oldNamespaces=oldEndElement.getNamespaces();
  List<Namespace> newNamespaces=new ArrayList<Namespace>();
  while (oldNamespaces.hasNext()) {
    Namespace oldNamespace=(Namespace)oldNamespaces.next();
    newNamespaces.add(oldNamespace);
  }
  newNamespaces.add(namespace);
  EndElement newEndElement=eventFactory.createEndElement(oldEndElement.getName(),newNamespaces.iterator());
  eventWriter.add(namespace);
  endElements.set(last,newEndElement);
}
