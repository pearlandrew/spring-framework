{
  long length=resource.contentLength();
  if (length > Integer.MAX_VALUE) {
    throw new IOException("Resource content too long (beyond Integer.MAX_VALUE): " + resource);
  }
  response.setContentLength((int)length);
  response.setContentType(mediaType.toString());
}
