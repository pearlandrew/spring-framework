{
  if (logger.isTraceEnabled()) {
    logger.trace("Received message for WebSocket session id=" + this.session.getId() + ": "+ message);
  }
  WebSocketSession wsSession=getWebSocketSession(this.session);
  Assert.notNull(wsSession,"WebSocketSession not found");
  try {
    WebSocketHandlerEndpoint.this.webSocketHandler.handleTextMessage(message,wsSession);
  }
 catch (  Throwable ex) {
    logger.error("Error while processing message",ex);
  }
}
