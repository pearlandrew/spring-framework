{
  if (logger.isDebugEnabled()) {
    logger.debug("Client connected, WebSocket session id=" + session.getId() + ", uri="+ session.getRequestURI());
  }
  try {
    WebSocketSession webSocketSession=new StandardWebSocketSession(session);
    this.sessions.put(session.getId(),webSocketSession);
    session.addMessageHandler(new StandardMessageHandler(session));
    this.webSocketHandler.afterConnectionEstablished(webSocketSession);
  }
 catch (  Throwable ex) {
    logger.error("Error while processing new session",ex);
  }
}
