{
  if (logger.isDebugEnabled()) {
    logger.debug("Connection closed, WebSocket session id=" + session.getId() + ", "+ reason);
  }
  try {
    CloseStatus closeStatus=new CloseStatus(reason.getCloseCode().getCode(),reason.getReasonPhrase());
    this.handler.afterConnectionClosed(closeStatus,this.webSocketSession);
  }
 catch (  Throwable ex) {
    logger.error("Unhandled error for " + this.webSocketSession,ex);
  }
 finally {
    this.handlerProvider.destroy(this.handler);
  }
}
