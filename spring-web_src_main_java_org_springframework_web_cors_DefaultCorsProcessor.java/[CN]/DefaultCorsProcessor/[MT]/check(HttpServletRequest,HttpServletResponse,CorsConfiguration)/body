{
  if (CorsUtils.isCorsResponse(response)) {
    logger.debug("Skip adding CORS headers, response already contains \"Access-Control-Allow-Origin\"");
    return false;
  }
  if (!(checkOrigin(request,config.getAllowedOrigins()) && checkRequestMethod(request,config.getAllowedMethods()) && checkRequestHeaders(request,config.getAllowedHeaders()))) {
    rejectCorsRequest(response);
    return false;
  }
  return true;
}
