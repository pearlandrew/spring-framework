{
  if (!checkOrigin(request,config.getAllowedOrigins()) || !checkMethod(request,config.getAllowedMethods(),isPreFlight) || !checkHeaders(request,config.getAllowedHeaders(),isPreFlight)) {
    response.setStatusCode(HttpStatus.FORBIDDEN);
    response.getBody().write("Invalid CORS request".getBytes(UTF8_CHARSET));
    return false;
  }
  return true;
}
