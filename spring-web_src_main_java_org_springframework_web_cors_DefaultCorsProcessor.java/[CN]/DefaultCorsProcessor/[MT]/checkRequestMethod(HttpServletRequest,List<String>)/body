{
  String requestMethod=CorsUtils.isPreFlightRequest(request) ? request.getHeader(CorsUtils.ACCESS_CONTROL_REQUEST_METHOD) : request.getMethod();
  if (requestMethod == null) {
    return false;
  }
  if (allowedMethods == null) {
    allowedMethods=Arrays.asList(HttpMethod.GET.name());
  }
  if (allowedMethods.contains("*")) {
    return true;
  }
  for (  String allowedMethod : allowedMethods) {
    if (requestMethod.equalsIgnoreCase(allowedMethod)) {
      return true;
    }
  }
  return false;
}
