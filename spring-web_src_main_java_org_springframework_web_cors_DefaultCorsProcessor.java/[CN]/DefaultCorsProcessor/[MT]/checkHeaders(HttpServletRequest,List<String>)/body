{
  String headerValue=request.getHeader(CorsUtils.ACCESS_CONTROL_REQUEST_HEADERS);
  String[] requestHeaders=CorsUtils.isPreFlightRequest(request) ? StringUtils.commaDelimitedListToStringArray(headerValue) : Collections.list(request.getHeaderNames()).toArray(new String[0]);
  if ((allowedHeaders != null) && allowedHeaders.contains("*")) {
    return true;
  }
  for (  String requestHeader : requestHeaders) {
    if (!HttpHeaders.ORIGIN.equals(requestHeader)) {
      requestHeader=requestHeader.trim();
      boolean found=false;
      if (allowedHeaders != null) {
        for (        String header : allowedHeaders) {
          if (requestHeader.equalsIgnoreCase(header)) {
            found=true;
            break;
          }
        }
      }
      if (!found) {
        return false;
      }
    }
  }
  return true;
}
