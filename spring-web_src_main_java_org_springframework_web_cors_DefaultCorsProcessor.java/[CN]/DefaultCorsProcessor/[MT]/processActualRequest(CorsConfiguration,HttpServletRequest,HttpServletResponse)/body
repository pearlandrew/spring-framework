{
  if (CorsUtils.isPreFlightRequest(request) || !CorsUtils.isCorsRequest(request)) {
    rejectCorsRequest(response);
    return false;
  }
  if (check(request,response,config)) {
    setOriginHeader(request,response,config.getAllowedOrigins(),config.isAllowCredentials());
    setAllowCredentialsHeader(response,config.isAllowCredentials());
    setExposeHeadersHeader(response,config.getExposedHeaders());
  }
  return true;
}
