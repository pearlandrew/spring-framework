{
  if (!CorsUtils.isPreFlightRequest(request)) {
    rejectCorsRequest(response);
    return false;
  }
  if (check(request,response,config)) {
    setOriginHeader(request,response,config.getAllowedOrigins(),config.isAllowCredentials());
    setAllowCredentialsHeader(response,config.isAllowCredentials());
    setAllowMethodsHeader(request,response,config.getAllowedMethods());
    setAllowHeadersHeader(request,response,config.getAllowedHeaders());
    setMaxAgeHeader(response,config.getMaxAge());
  }
  return true;
}
