{
  HttpMethod requestMethod=isPreFlight ? request.getHeaders().getAccessControlRequestMethod() : request.getMethod();
  if (allowedMethods == null) {
    allowedMethods=Arrays.asList(HttpMethod.GET.name());
  }
  if (allowedMethods.contains("*")) {
    return true;
  }
  for (  String allowedMethod : allowedMethods) {
    if (allowedMethod.equalsIgnoreCase(requestMethod.name())) {
      return true;
    }
  }
  return false;
}
