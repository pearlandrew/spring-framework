{
  this.messageHeaders=readOnly ? messageHeaders : new HashMap<String,Object>(messageHeaders);
  this.rawHeaders=this.messageHeaders.containsKey(RAW_HEADERS) ? (Map<String,String>)messageHeaders.get(RAW_HEADERS) : Collections.<String,String>emptyMap();
  if (this.messageHeaders.get(MESSAGE_TYPE) == null) {
    this.messageHeaders.put(MESSAGE_TYPE,MessageType.MESSAGE);
  }
}
