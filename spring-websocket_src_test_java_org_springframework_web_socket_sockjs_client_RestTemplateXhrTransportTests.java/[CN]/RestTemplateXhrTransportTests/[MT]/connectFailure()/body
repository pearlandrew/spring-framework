{
  final HttpServerErrorException expected=new HttpServerErrorException(HttpStatus.INTERNAL_SERVER_ERROR);
  RestOperations restTemplate=mock(RestOperations.class);
  when(restTemplate.execute(any(),eq(HttpMethod.POST),any(),any())).thenThrow(expected);
  final CountDownLatch latch=new CountDownLatch(1);
  connect(restTemplate).addCallback(new ListenableFutureCallback<WebSocketSession>(){
    @Override public void onSuccess(    WebSocketSession result){
    }
    @Override public void onFailure(    Throwable actual){
      if (actual == expected) {
        latch.countDown();
      }
    }
  }
);
  verifyNoMoreInteractions(this.webSocketHandler);
}
